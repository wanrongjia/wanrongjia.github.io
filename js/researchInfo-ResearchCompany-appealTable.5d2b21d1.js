"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[3295],{2913:function(e,t,l){l.r(t),l.d(t,{default:function(){return Z}});var a=l(6252),i=l(3577);const s=e=>((0,a.dD)("data-v-3f661c4e"),e=e(),(0,a.Cn)(),e),o={class:"left-panel"},c={class:"title"},n={class:"right-panel"},d={class:"longText"},r={class:"label"},u={class:"sheetBox"},m={class:"appraiseSheetName"},p={class:"colorPanel"},f=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#ffc327"}}),(0,a.Uk)(" 该项申诉调研公司未处理 ")],-1))),h=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#ff2727"}}),(0,a.Uk)(" 该项申诉调研公司已驳回 ")],-1))),w=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#2780ff"}}),(0,a.Uk)(" 该项申诉区局（市场部、营销部）超时未处理 ")],-1))),b=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#23994a"}}),(0,a.Uk)(" 该项申诉调研公司已通过 ")],-1))),_=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#7b18ff"}}),(0,a.Uk)(" 该项申诉被调研公司修改 ")],-1))),k=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#d9d9d9"}}),(0,a.Uk)(" 该项申诉已被区局（市场部、营销部）驳回 ")],-1))),g={key:0},S={key:1},v={key:0};function W(e,t,l,s,W,y){const C=(0,a.up)("el-icon-list"),L=(0,a.up)("el-icon"),x=(0,a.up)("el-button"),N=(0,a.up)("el-header"),D=(0,a.up)("el-form-item"),A=(0,a.up)("el-col"),Z=(0,a.up)("el-row"),z=(0,a.up)("el-table-column"),U=(0,a.up)("el-button-group"),P=(0,a.up)("scTable"),I=(0,a.up)("el-main"),T=(0,a.up)("el-container"),$=(0,a.up)("save-dialog"),O=(0,a.up)("simplePhoto"),B=(0,a.up)("openAppeal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(T,null,{default:(0,a.w5)((()=>[(0,a.Wm)(N,{class:"info"},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)(L,{size:20,color:"var(--el-color-primary)"},{default:(0,a.w5)((()=>[(0,a.Wm)(C)])),_:1}),(0,a._)("div",c,(0,i.zw)(W.detail.businessShopName),1)]),(0,a._)("div",n,[(0,a.Wm)(x,{size:"default",onClick:y.back},{default:(0,a.w5)((()=>[(0,a.Uk)("返回")])),_:1},8,["onClick"]),(0,a.Wm)(x,{type:"primary",size:"default",onClick:y.showPhoto},{default:(0,a.w5)((()=>[(0,a.Uk)("基础照片")])),_:1},8,["onClick"])])])),_:1}),(0,a.Wm)(I,{style:{background:"#fff"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:"infoHead"},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{span:16},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(A,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{label:"客户经理:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(W.detail.accountManagerName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(A,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{label:"区营销部:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(W.detail.marketingDepartmentName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(A,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{label:"区市场部:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(W.detail.organizationName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(A,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{label:"客户名称:"},{default:(0,a.w5)((()=>[(0,a._)("div",d,(0,i.zw)(W.detail.customerName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(A,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{label:"专卖证号:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(W.detail.retailLicenseNumber||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(A,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{label:"客户电话:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(W.detail.customerPhone||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(A,{xs:24,sm:24,md:16,lg:16,xl:16},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{label:"调研时间:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(W.detail.completionTime||"-"),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(A,{span:8,class:"successBox"},{default:(0,a.w5)((()=>[(0,a._)("div",r,"总分："+(0,i.zw)(W.detail.totalScore||0),1)])),_:1})])),_:1}),(0,a._)("div",u,[(0,a._)("div",m,[(0,a.Uk)((0,i.zw)(W.detail.sheetName||"-")+" ",1),(0,a._)("div",p,[(0,a.Wm)(Z,{style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(A,{span:8},{default:(0,a.w5)((()=>[f])),_:1}),(0,a.Wm)(A,{span:8},{default:(0,a.w5)((()=>[h])),_:1}),(0,a.Wm)(A,{span:8},{default:(0,a.w5)((()=>[w])),_:1}),(0,a.Wm)(A,{span:8},{default:(0,a.w5)((()=>[b])),_:1}),(0,a.Wm)(A,{span:8},{default:(0,a.w5)((()=>[_])),_:1}),(0,a.Wm)(A,{span:8},{default:(0,a.w5)((()=>[k])),_:1})])),_:1})])]),(0,a.Wm)(P,{ref:"table",data:W.detail.topicListList,"span-method":y.objectSpanMethod,"table-layout":"auto",border:"",hiddenMin:"","highlight-current-row":!1,"row-key":"id",hideRefresh:"",hidePagination:"",hideDo:"","cell-style":y.changeCellStyle},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{label:"检查项目",prop:"className","min-width":"150",align:"center"}),(0,a.Wm)(z,{label:"基本分",prop:"classBaseScore","min-width":"150",align:"center"}),(0,a.Wm)(z,{label:"检查要点",prop:"name","min-width":"500",align:"center"}),(0,a.Wm)(z,{label:"分值",prop:"score","min-width":"100",align:"center"},{default:(0,a.w5)((e=>[W.strShow.includes(e.row.no)?((0,a.wg)(),(0,a.iD)("div",g,"否决项")):((0,a.wg)(),(0,a.iD)("div",S,(0,i.zw)(1===e.row.combineStatus?e.row.combineScore:e.row.score),1))])),_:1}),(0,a.Wm)(z,{label:"得分",prop:"hitScore","min-width":"150",align:"center"},{default:(0,a.w5)((e=>[W.strShow.includes(e.row.no)?((0,a.wg)(),(0,a.iD)("div",v,"-")):((0,a.wg)(),(0,a.iD)("div",{key:1,style:(0,i.j5)(y.filterColor(e.row))},(0,i.zw)(1===e.row.combineStatus?e.row.combineHitScore:e.row.hitScore),5))])),_:1}),(0,a.Wm)(z,{label:"操作","min-width":"100",fixed:"right",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Wm)(x,{text:"",type:"primary",size:"small",onClick:t=>y.getData(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("查看")])),_:2},1032,["onClick"]),"audit"===y.filteShow(e.row)?((0,a.wg)(),(0,a.j4)(x,{key:0,text:"",type:"primary",size:"small",onClick:t=>y.getAppeal(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("审核")])),_:2},1032,["onClick"])):(0,a.kq)("",!0),"editAudit"===y.filteShow(e.row)?((0,a.wg)(),(0,a.j4)(x,{key:1,text:"",type:"primary",size:"small",onClick:t=>y.getAppeal(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("修改审核")])),_:2},1032,["onClick"])):(0,a.kq)("",!0)])),_:2},1024)])),_:1})])),_:1},8,["data","span-method","cell-style"])])])),_:1})])),_:1}),W.dialog.save?((0,a.wg)(),(0,a.j4)($,{key:0,ref:"saveDialog",onSuccess:y.handleSaveSuccess,onClosed:t[0]||(t[0]=e=>W.dialog.save=!1)},null,8,["onSuccess"])):(0,a.kq)("",!0),W.dialog.photo?((0,a.wg)(),(0,a.j4)(O,{key:1,detail:W.detail,ref:"simplePhoto",onClosed:t[1]||(t[1]=e=>W.dialog.photo=!1)},null,8,["detail"])):(0,a.kq)("",!0),W.dialog.appeal?((0,a.wg)(),(0,a.j4)(B,{key:2,ref:"openAppeal",onSuccess:y.handleSaveSuccess,onClose:t[2]||(t[2]=e=>W.dialog.appeal=!1)},null,8,["onSuccess"])):(0,a.kq)("",!0)],64)}l(7658);var y=l(6769),C=l(9420),L=l(2433),x=l(8201),N={name:"plan-detail",components:{saveDialog:y["default"],simplePhoto:C["default"],openAppeal:L["default"]},data(){return{id:this.$route.query.id,input:"",dialog:{save:!1,photo:!1,appeal:!1},strShow:["BZXZZD_CLASS_01_TOPIC_01","BZXZZD_CLASS_02_TOPIC_01"],detail:{business:{},images:[],result:{},topicClass:[],topicListList:[]},spanArr:[]}},created(){},mounted(){this.getDetail(this.$route.query.id)},methods:{changeCellStyle({row:e,column:t,columnIndex:l}){return 4===l&&0===e.status?{background:"#ffc327"}:4===l&&1===e.status?{background:"#b6f3ca"}:4===l&&2===e.status?{background:"#fbcbcb"}:4===l&&3===e.status?{background:"#b98bf5"}:4===l&&4===e.status?{background:"#91d5ff"}:4===l&&5===e.status?{background:"#d7d7d7"}:"操作"===t.label?{background:"#fff"}:{background:"revert"}},filteShow(e){if("BZXZZD_CLASS_02_TOPIC_01"===e.no&&0===e.status&&"否"===e.selectOption)return!0;let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&0===e.status?t="audit":[1,2].includes(e.status)&&(t="editAudit"):e.hitScore<e.score&&0===e.status?t="audit":[1,2].includes(e.status)&&(t="editAudit"),t},filterColor(e){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),t},getSpanArr(e){let t=[];for(var l=0;l<e.length;l++)0===l?(t.push(1),this.pos=0):e[l].classNo===e[l-1].classNo?(t[this.pos]+=1,t.push(0)):(t.push(1),this.pos=l);return t},objectSpanMethod({rowIndex:e,columnIndex:t}){if(0===t||1===t){const t=this.spanArr[e],l=t>0?1:0;return{rowspan:t,colspan:l}}if([3,4].includes(t)){const t=this.detail.topicListList[e-1],l=this.detail.topicListList[e],a=this.detail.topicListList[e+1];if(!a||l.classNo!==a.classNo)return[1,1];if(1===l.combineStatus&&l.combineNo===t.combineNo)return[0,1];if(1===l.combineStatus&&l.combineNo===a.combineNo)return[2,1]}else if([5].includes(t)){const l=this.detail.topicListList[e-2]||{},a=this.detail.topicListList[e-1]||{},i=this.detail.topicListList[e]||{},s=this.detail.topicListList[e+1];if(0===t&&0===e)return[1,1];if("BZXZZD_CLASS_02_TOPIC_01"===i.no&&"否"===i.selectOption)return[3,1];if("BZXZZD_CLASS_02_TOPIC_01"===l.no&&"否"===l.selectOption||"BZXZZD_CLASS_02_TOPIC_01"===a.no&&"否"===a.selectOption)return[0,1];if(!s||i.classNo!==s.classNo)return[1,1];if(1===i.combineStatus&&i.combineNo===a.combineNo)return[0,1];if(1===i.combineStatus&&i.combineNo===s.combineNo)return[2,1]}},getData(e){let t=[];const{combineStatus:l,combineNo:a}=e;switch(l){case 1:t=this.detail.topicListList.filter((e=>e.combineNo===a));break;case 2:t.push(e);break}this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("add",this.detail.resultId).setData(t)}))},getAppeal(e){let t=[];const{combineStatus:l,combineNo:a}=e;switch(l){case 1:t=this.detail.topicListList.filter((e=>e.combineNo===a));break;case 2:t.push(e);break}this.dialog.appeal=!0,this.$nextTick((()=>{this.$refs.openAppeal.open("add",this.detail.resultId).setData(t)}))},filterType(e,t=[]){return t.find((t=>t.value===e))?.label||"-"},async getDetail(e){let t=await this.$API.researchInfo.ResearchCompany.GetAuditSheetDetail.get(e);200===t.code?(this.detail=t.data||{},this.spanArr=this.getSpanArr(t.data.topicListList)):x.Z.closeNext((()=>{this.$router.back()}))},back(){x.Z.closeNext((()=>{this.$router.back()}))},showPhoto(){this.dialog.photo=!0,this.$nextTick((()=>{this.$refs.simplePhoto.open()}))},handleSaveSuccess(){this.getDetail(this.id)}}},D=l(3744);const A=(0,D.Z)(N,[["render",W],["__scopeId","data-v-3f661c4e"]]);var Z=A}}]);