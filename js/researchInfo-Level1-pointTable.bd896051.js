"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[7194,2795,2256,4389],{2104:function(e,t,l){l.r(t),l.d(t,{default:function(){return k}});var s=l(6252),i=l(3577);const a={class:"left-panel"},o={class:"title"},n={class:"right-panel"},r={class:"sheetBox"},u={class:"appraiseSheetName"},d={key:0},c={key:1},m={key:0};function b(e,t,l,b,p,w){const f=(0,s.up)("el-icon-list"),h=(0,s.up)("el-icon"),_=(0,s.up)("el-button"),g=(0,s.up)("el-header"),k=(0,s.up)("el-form-item"),S=(0,s.up)("el-col"),W=(0,s.up)("el-row"),v=(0,s.up)("el-table-column"),x=(0,s.up)("el-button-group"),L=(0,s.up)("scTable"),y=(0,s.up)("el-main"),N=(0,s.up)("el-container"),D=(0,s.up)("save-dialog"),C=(0,s.up)("simplePhoto");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(N,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"info"},{default:(0,s.w5)((()=>[(0,s._)("div",a,[(0,s.Wm)(h,{size:20,color:"var(--el-color-primary)"},{default:(0,s.w5)((()=>[(0,s.Wm)(f)])),_:1}),(0,s._)("div",o,(0,i.zw)(p.detail.business.businessShopName),1)]),(0,s._)("div",n,[(0,s.Wm)(_,{size:"default",onClick:w.back},{default:(0,s.w5)((()=>[(0,s.Uk)("返回")])),_:1},8,["onClick"]),(0,s.Wm)(_,{type:"primary",size:"default",onClick:w.showPhoto},{default:(0,s.w5)((()=>[(0,s.Uk)("基础照片")])),_:1},8,["onClick"])])])),_:1}),(0,s.Wm)(y,{style:{background:"#fff"}},{default:(0,s.w5)((()=>[(0,s.Wm)(W,{class:"infoHead"},{default:(0,s.w5)((()=>[(0,s.Wm)(S,{xs:12,sm:12,md:4,lg:4,xl:4},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"客户经理:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.marketingDepartmentName||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:12,sm:12,md:4,lg:4,xl:4},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"区营销部:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.marketingDepartmentName||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:12,sm:12,md:16,lg:16,xl:16},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"区市场部:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.organizationName||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:12,sm:12,md:4,lg:4,xl:4},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"客户名称:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.customerName||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:12,sm:12,md:4,lg:4,xl:4},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"零售许可证号:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.retailLicenseNumber||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:12,sm:12,md:16,lg:16,xl:16},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"客户电话:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.customerPhone||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:24,sm:24,md:4,lg:4,xl:4},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"市场类型:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(w.filterType(p.detail.business.marketType,p.marketList)),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:24,sm:24,md:4,lg:4,xl:4},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"业态:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(w.filterType(p.detail.business.businessType,p.businessList)),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:12,sm:12,md:16,lg:16,xl:16},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"线路:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.deliveryRoute||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:24,sm:24,md:4,lg:4,xl:4},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"档位:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.gear||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:24,sm:24,md:20,lg:20,xl:20},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"店面经营地址:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.businessAddress||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:24,sm:24,md:4,lg:4,xl:4},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"调查人:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.surveyUserName||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{xs:24,sm:24,md:20,lg:20,xl:20},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"调查时间:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.completionTime||"-"),1)])),_:1})])),_:1}),(0,s.Wm)(S,{span:24},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{label:"备注:"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,i.zw)(p.detail.business.remark||"-"),1)])),_:1})])),_:1})])),_:1}),(0,s._)("div",r,[(0,s._)("div",u,(0,i.zw)(p.detail.result.appraiseSheetName||"-"),1),(0,s.Wm)(L,{ref:"table",data:p.detail.topicListList,"span-method":w.objectSpanMethod,"table-layout":"auto",border:"",hiddenMin:"","highlight-current-row":!1,"row-key":"id",hideRefresh:"",hidePagination:"",hideDo:"","cell-style":w.changeCellStyle},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{label:"检查项目",prop:"className","min-width":"150",align:"center"}),(0,s.Wm)(v,{label:"基本分",prop:"classBaseScore","min-width":"150",align:"center"}),(0,s.Wm)(v,{label:"检查要点",prop:"name","min-width":"500",align:"center"}),(0,s.Wm)(v,{label:"分值",prop:"score","min-width":"100",align:"center"},{default:(0,s.w5)((e=>[p.strShow.includes(e.row.no)?((0,s.wg)(),(0,s.iD)("div",d,"否决项")):((0,s.wg)(),(0,s.iD)("div",c,(0,i.zw)(1===e.row.combineStatus?e.row.combineScore:e.row.score),1))])),_:1}),(0,s.Wm)(v,{label:"得分",prop:"hitScore","min-width":"150",align:"center"},{default:(0,s.w5)((e=>[p.strShow.includes(e.row.no)?((0,s.wg)(),(0,s.iD)("div",m,"-")):((0,s.wg)(),(0,s.iD)("div",{key:1,style:(0,i.j5)(w.filterColor(e.row))},(0,i.zw)(1===e.row.combineStatus?e.row.combineHitScore:e.row.hitScore),5))])),_:1}),(0,s.Wm)(v,{label:"操作","min-width":"100",fixed:"right",align:"center"},{default:(0,s.w5)((e=>[(0,s.Wm)(x,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,{text:"",type:"primary",size:"small",onClick:t=>w.getData(e.row)},{default:(0,s.w5)((()=>[(0,s.Uk)("查看")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","span-method","cell-style"])])])),_:1})])),_:1}),p.dialog.save?((0,s.wg)(),(0,s.j4)(D,{key:0,ref:"saveDialog",onSuccess:w.handleSaveSuccess,onClosed:t[0]||(t[0]=e=>p.dialog.save=!1)},null,8,["onSuccess"])):(0,s.kq)("",!0),p.dialog.photo?((0,s.wg)(),(0,s.j4)(C,{key:1,detail:p.detail,ref:"simplePhoto",onClosed:t[1]||(t[1]=e=>p.dialog.photo=!1)},null,8,["detail"])):(0,s.kq)("",!0)],64)}l(7658);var p=l(4434),w=l(7197),f=l(907),h={name:"plan-detail",components:{saveDialog:p["default"],simplePhoto:w["default"]},data(){return{id:this.$route.query.id,input:"",dialog:{save:!1,photo:!1},strShow:["BZXZZD_CLASS_01_TOPIC_01","BZXZZD_CLASS_02_TOPIC_01"],detail:{business:{},images:[],result:{},topicClass:[],topicListList:[]},marketList:[{value:1,label:"城市"},{value:2,label:"乡村"},{value:3,label:"乡镇"}],businessList:[{value:1,label:"便利店"},{value:2,label:"超市"},{value:3,label:"商场"},{value:4,label:"烟酒店"},{value:5,label:"食杂店"},{value:6,label:"娱乐服务"},{value:7,label:"其他"}],spanArr:[]}},created(){},mounted(){this.getDetail(this.$route.query.id)},methods:{changeCellStyle(e){return"操作"===e.column.label?{background:"#fff"}:{background:"revert"}},filterColor(e){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),t},getSpanArr(e){let t=[];for(var l=0;l<e.length;l++)0===l?(t.push(1),this.pos=0):e[l].classNo===e[l-1].classNo?(t[this.pos]+=1,t.push(0)):(t.push(1),this.pos=l);return t},objectSpanMethod({rowIndex:e,columnIndex:t}){if(0===t||1===t){const t=this.spanArr[e],l=t>0?1:0;return{rowspan:t,colspan:l}}if([3,4].includes(t)){const t=this.detail.topicListList[e-1],l=this.detail.topicListList[e],s=this.detail.topicListList[e+1];if(!s||l.classNo!==s.classNo)return[1,1];if(1===l.combineStatus&&l.combineNo===t.combineNo)return[0,1];if(1===l.combineStatus&&l.combineNo===s.combineNo)return[2,1]}else if([5].includes(t)){const l=this.detail.topicListList[e-2]||{},s=this.detail.topicListList[e-1]||{},i=this.detail.topicListList[e]||{},a=this.detail.topicListList[e+1];if(0===t&&0===e)return[1,1];if("BZXZZD_CLASS_02_TOPIC_01"===i.no&&"否"===i.selectOption)return[3,1];if("BZXZZD_CLASS_02_TOPIC_01"===l.no&&"否"===l.selectOption||"BZXZZD_CLASS_02_TOPIC_01"===s.no&&"否"===s.selectOption)return[0,1];if(!a||i.classNo!==a.classNo)return[1,1];if(1===i.combineStatus&&i.combineNo===s.combineNo)return[0,1];if(1===i.combineStatus&&i.combineNo===a.combineNo)return[2,1]}},getData(e){let t=[];const{combineStatus:l,combineNo:s}=e;switch(l){case 1:t=this.detail.topicListList.filter((e=>e.combineNo===s));break;case 2:t.push(e);break}this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open().setData(t)}))},filterType(e,t=[]){return t.find((t=>t.value===e))?.label||"-"},async getDetail(e){let t=await this.$API.researchInfo.GetPlanSheetDetail.get(e);200===t.code?(this.detail=t.data||{},this.spanArr=this.getSpanArr(t.data.topicListList)):f.Z.closeNext((()=>{this.$router.back()}))},back(){f.Z.closeNext((()=>{this.$router.back()}))},showPhoto(){this.dialog.photo=!0,this.$nextTick((()=>{this.$refs.simplePhoto.open()}))},handleClick(e){switch(e.props.name){case"1":this.$refs.RecycleDetail.initData();break;case"2":this.$refs.PlanUserList.initData();break;case"3":this.$refs.StoreList.initData();break}},handleSaveSuccess(e,t){"edit"==t&&this.getDetail(e.id)}}},_=l(3744);const g=(0,_.Z)(h,[["render",b],["__scopeId","data-v-1a290fcc"]]);var k=g}}]);