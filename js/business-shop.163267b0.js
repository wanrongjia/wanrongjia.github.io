"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[6597],{5574:function(e,a,l){l.r(a),l.d(a,{default:function(){return F}});var t=l(6252),s=l(3577);const i=e=>((0,t.dD)("data-v-02ea0556"),e=e(),(0,t.Cn)(),e),n={class:"left-panel"},u={class:"query"},o={class:"query_item"},r=i((()=>(0,t._)("div",{class:"query_label"},"店铺名称：",-1))),d={class:"query_item"},m=i((()=>(0,t._)("div",{class:"query_label"},"专卖许可证号：",-1))),c={class:"query_item"},p=i((()=>(0,t._)("div",{class:"query_label"},"客户名称：",-1))),h={class:"query_item"},y=i((()=>(0,t._)("div",{class:"query_label"},"客户电话：",-1))),g={class:"query_item"},b=i((()=>(0,t._)("div",{class:"query_label"},"地址：",-1))),f={class:"query_item"},_=i((()=>(0,t._)("div",{class:"query_label"},"所属营销部：",-1))),w={key:0,class:"query_item"},v=i((()=>(0,t._)("div",{class:"query_label"},"所属市场部：",-1))),q={key:1,class:"query_item"},k=i((()=>(0,t._)("div",{class:"query_label"},"客户经理：",-1))),D={key:2,class:"query_item"},W=i((()=>(0,t._)("div",{class:"query_label"},"市场类型：",-1))),V={key:3,class:"query_item"},I=i((()=>(0,t._)("div",{class:"query_label"},"业态类型：",-1))),$={key:4,class:"query_item"},C=i((()=>(0,t._)("div",{class:"query_label"},"所属线路：",-1))),L={key:5,class:"query_item"},U=i((()=>(0,t._)("div",{class:"query_label"},"档位：",-1))),S={key:6,class:"query_item"},N=i((()=>(0,t._)("div",{class:"query_label"},"账号状态：",-1))),T={class:"right-panel"},z={class:"right-panel-search",style:{margin:"5px 0"}},x={class:"left-panel"},P=i((()=>(0,t._)("div",{class:"right-panel"},null,-1)));function A(e,a,l,i,A,E){const j=(0,t.up)("el-input"),R=(0,t.up)("el-option"),M=(0,t.up)("el-select"),H=(0,t.up)("el-radio-button"),Y=(0,t.up)("el-radio-group"),B=(0,t.up)("el-button"),F=(0,t.up)("el-header"),K=(0,t.up)("el-table-column"),Z=(0,t.up)("el-switch"),G=(0,t.up)("el-button-group"),O=(0,t.up)("scTable"),Q=(0,t.up)("el-main"),J=(0,t.up)("el-container"),X=(0,t.up)("save-dialog"),ee=(0,t.up)("upload-dialog"),ae=(0,t.up)("edit-dialog"),le=(0,t.Q2)("role");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(J,null,{default:(0,t.w5)((()=>[(0,t.Wm)(J,null,{default:(0,t.w5)((()=>[(0,t.Wm)(F,{class:"searchSpan"},{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",u,[(0,t._)("div",o,[r,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入店铺名称",modelValue:A.queryInfo.paramData.name,"onUpdate:modelValue":a[0]||(a[0]=e=>A.queryInfo.paramData.name=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",d,[m,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入许可证号",modelValue:A.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>A.queryInfo.paramData.retailLicenseNumber=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",c,[p,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入客户姓名",modelValue:A.queryInfo.paramData.customerName,"onUpdate:modelValue":a[2]||(a[2]=e=>A.queryInfo.paramData.customerName=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",h,[y,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入客户电话",modelValue:A.queryInfo.paramData.customerPhone,"onUpdate:modelValue":a[3]||(a[3]=e=>A.queryInfo.paramData.customerPhone=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",g,[b,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入地址",modelValue:A.queryInfo.paramData.businessAddress,"onUpdate:modelValue":a[4]||(a[4]=e=>A.queryInfo.paramData.businessAddress=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",f,[_,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入所属营销部",modelValue:A.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[5]||(a[5]=e=>A.queryInfo.paramData.marketingDepartmentName=e),clearable:""},null,8,["modelValue"])]),A.open?((0,t.wg)(),(0,t.iD)("div",w,[v,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入所属市场部",modelValue:A.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[6]||(a[6]=e=>A.queryInfo.paramData.organizationName=e),clearable:""},null,8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",q,[k,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入客户经理名称",modelValue:A.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[7]||(a[7]=e=>A.queryInfo.paramData.accountManagerName=e),clearable:""},null,8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",D,[W,(0,t.Wm)(M,{class:"query_input",modelValue:A.queryInfo.paramData.marketType,"onUpdate:modelValue":a[8]||(a[8]=e=>A.queryInfo.paramData.marketType=e),filterable:"",placeholder:"请选择市场类型",clearable:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(A.marketList,(e=>((0,t.wg)(),(0,t.j4)(R,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",V,[I,(0,t.Wm)(M,{class:"query_input",modelValue:A.queryInfo.paramData.businessType,"onUpdate:modelValue":a[9]||(a[9]=e=>A.queryInfo.paramData.businessType=e),filterable:"",placeholder:"请选择业态类型",clearable:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(A.businessList,(e=>((0,t.wg)(),(0,t.j4)(R,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",$,[C,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入所属路线",modelValue:A.queryInfo.paramData.deliveryRoute,"onUpdate:modelValue":a[10]||(a[10]=e=>A.queryInfo.paramData.deliveryRoute=e),clearable:""},null,8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",L,[U,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入所属档位",modelValue:A.queryInfo.paramData.gear,"onUpdate:modelValue":a[11]||(a[11]=e=>A.queryInfo.paramData.gear=e),clearable:""},null,8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",S,[N,(0,t.Wm)(Y,{modelValue:A.queryInfo.paramData.status,"onUpdate:modelValue":a[12]||(a[12]=e=>A.queryInfo.paramData.status=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{label:""},{default:(0,t.w5)((()=>[(0,t.Uk)("全部")])),_:1}),(0,t.Wm)(H,{label:1},{default:(0,t.w5)((()=>[(0,t.Uk)("启用")])),_:1}),(0,t.Wm)(H,{label:0},{default:(0,t.w5)((()=>[(0,t.Uk)("禁用")])),_:1})])),_:1},8,["modelValue"])])):(0,t.kq)("",!0)])]),(0,t._)("div",T,[(0,t._)("div",z,[(0,t.Wm)(B,{type:"default",onClick:a[13]||(a[13]=e=>E.upsearch(!0))},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1}),(0,t.Wm)(B,{type:"primary",onClick:a[14]||(a[14]=e=>E.upsearch(!1))},{default:(0,t.w5)((()=>[(0,t.Uk)("查询")])),_:1}),(0,t._)("div",{class:"openBtn",onClick:a[15]||(a[15]=e=>A.open=!A.open)},(0,s.zw)(A.open?"收起":"展开"),1)])])])),_:1}),(0,t.wy)(((0,t.wg)(),(0,t.j4)(F,{style:{height:"auto"}},{default:(0,t.w5)((()=>[(0,t._)("div",x,[(0,t.Wm)(B,{type:"primary",size:"default",onClick:E.add},{default:(0,t.w5)((()=>[(0,t.Uk)("新建店铺")])),_:1},8,["onClick"]),(0,t.Wm)(B,{type:"primary",size:"default",onClick:E.uploadImport},{default:(0,t.w5)((()=>[(0,t.Uk)("批量导入")])),_:1},8,["onClick"]),(0,t.Wm)(B,{type:"primary",size:"default",onClick:E.manyEdit},{default:(0,t.w5)((()=>[(0,t.Uk)("批量修改")])),_:1},8,["onClick"]),(0,t.Wm)(B,{type:"primary",size:"default",onClick:E.batch_del,disabled:!A.selection.length},{default:(0,t.w5)((()=>[(0,t.Uk)("批量删除")])),_:1},8,["onClick","disabled"])]),P])),_:1})),[[le,["1","2"]]]),(0,t.Wm)(Q,{class:"nopadding"},{default:(0,t.w5)((()=>[(0,t.Wm)(O,{ref:"table",data:A.tableData,staticTotal:A.total,"row-key":"id",hideRefresh:"",onSelectionChange:E.selectionChange,onPaginationChange:E.paginationChange,onPageSizeChange:E.pageSizeChange},{default:(0,t.w5)((()=>[(0,t.Wm)(K,{type:"selection","min-width":"50"}),(0,t.Wm)(K,{label:"店铺名称",prop:"name","min-width":"200"}),(0,t.Wm)(K,{label:"零售许可证号",prop:"retailLicenseNumber","min-width":"120"}),(0,t.Wm)(K,{label:"客户姓名",prop:"customerName","min-width":"100"}),(0,t.Wm)(K,{label:"客户电话",prop:"customerPhone","min-width":"120"}),(0,t.Wm)(K,{label:"地址",prop:"businessAddress","min-width":"300"}),(0,t.Wm)(K,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"180"}),(0,t.Wm)(K,{label:"所属市场部",prop:"organizationName","min-width":"180"}),(0,t.Wm)(K,{label:"客户经理",prop:"accountManagerName","min-width":"100"}),(0,t.Wm)(K,{label:"市场类型",prop:"marketType","min-width":"100"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,s.zw)(E.filterType(e.row.marketType,A.marketList)),1)])),_:1}),(0,t.Wm)(K,{label:"业态",prop:"businessType","min-width":"100"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,s.zw)(E.filterType(e.row.businessType,A.businessList)),1)])),_:1}),(0,t.Wm)(K,{label:"线路",prop:"deliveryRoute","min-width":"180"}),(0,t.Wm)(K,{label:"档位",prop:"gear",width:"150"}),(0,t.Wm)(K,{label:"状态",prop:"status",width:"100"},{default:(0,t.w5)((e=>[(0,t.Wm)(Z,{"inline-prompt":"",modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用",onChange:a=>E.disableShop(a,e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,t.wy)(((0,t.wg)(),(0,t.j4)(K,{label:"操作",fixed:"right",align:"right","min-width":"240"},{default:(0,t.w5)((e=>[(0,t.Wm)(G,null,{default:(0,t.w5)((()=>[(0,t.Wm)(B,{text:"",type:"primary",size:"small",onClick:a=>E.clearLngLat(e.row,e.$index)},{default:(0,t.w5)((()=>[(0,t.Uk)("清除移动端经纬度")])),_:2},1032,["onClick"]),(0,t.Wm)(B,{text:"",type:"primary",size:"small",onClick:a=>E.table_edit(e.row,e.$index)},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"]),(0,t.Wm)(B,{text:"",type:"primary",size:"small",onClick:a=>E.table_del(e.row,e.$index)},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})),[[le,["1","2"]]])])),_:1},8,["data","staticTotal","onSelectionChange","onPaginationChange","onPageSizeChange"])])),_:1})])),_:1})])),_:1}),A.dialog.save?((0,t.wg)(),(0,t.j4)(X,{key:0,ref:"saveDialog",onSuccess:E.handleSaveSuccess,marketList:A.marketList,businessList:A.businessList,onClosed:a[16]||(a[16]=e=>A.dialog.save=!1)},null,8,["onSuccess","marketList","businessList"])):(0,t.kq)("",!0),A.dialog.upload?((0,t.wg)(),(0,t.j4)(ee,{key:1,ref:"uploadDialog",onSuccess:E.handleSaveSuccess,onClosed:a[17]||(a[17]=e=>A.dialog.upload=!1)},null,8,["onSuccess"])):(0,t.kq)("",!0),A.dialog.manyEdit?((0,t.wg)(),(0,t.j4)(ae,{key:2,ref:"editDialog",onSuccess:E.handleSaveSuccess,onClosed:a[18]||(a[18]=e=>A.dialog.manyEdit=!1)},null,8,["onSuccess"])):(0,t.kq)("",!0)],64)}var E=l(412),j=l(8790),R=l(3012),M=l(9123),H={name:"shop",components:{saveDialog:E["default"],uploadDialog:j["default"],editDialog:R["default"]},computed:{user:()=>M.Z.state.user.USER_INFO},data(){return{open:!1,dialog:{save:!1,upload:!1,manyEdit:!1},tableData:[],total:0,selection:[],search:{keyword:null},queryInfo:{current:1,paramData:{accountManagerName:"",businessAddress:"",businessType:"",customerName:"",customerPhone:"",deliveryRoute:"",gear:"",marketType:"",marketingDepartmentName:"",name:"",organizationName:"",retailLicenseNumber:""},size:10},breadcrumb:[],marketList:[{value:1,label:"城市"},{value:2,label:"乡村"},{value:3,label:"乡镇"}],businessList:[{value:1,label:"便利店"},{value:2,label:"超市"},{value:3,label:"商场"},{value:4,label:"烟酒店"},{value:5,label:"食杂店"},{value:6,label:"娱乐服务"},{value:7,label:"其他"}]}},watch:{groupFilterText(e){this.$refs.group.filter(e)}},mounted(){this.getDataList(!0)},methods:{paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},manyEdit(){this.dialog.manyEdit=!0,this.$nextTick((()=>{this.$refs.editDialog.open()}))},filterType(e,a){return a.find((a=>a.value===e))?.label||"-"},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.business.GetShopList.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},uploadImport(){this.dialog.upload=!0,this.$nextTick((()=>{this.$refs.uploadDialog.open()}))},uploadSuccess(){},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open()}))},table_edit(e){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(e)}))},clearLngLat(e){this.$confirm("是否清除小程序端上传的经纬度信息；","提示",{type:"warning"}).then((async()=>{let a=await this.$API.business.ClearLngLat.put(e.id);200==a.code?(this.getDataList(),this.$message.success("清除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},table_del(e){this.$confirm("是否删除当前店铺，删除后相关未归档的问卷、终端打分也会删除；","删除提示",{type:"warning"}).then((async()=>{let a=await this.$API.business.DeleteShop.delete(e.id);200==a.code?(this.getDataList(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},async disableShop(e,a){this.$confirm(`确定${e?"启用":"禁用"}${a.name}吗？`,"提示",{type:"warning"}).then((async()=>{const l=this.$loading();let t=await this.$API.business.DisableShop.put(a.id,{status:e?1:0});200===t.code?(this.$message.success("操作成功"),this.getDataList()):this.$message.error(t.message),l.close()})).catch((()=>{this.$message.info("用户取消禁用"),a.status=0===a.status?1:0}))},selectionChange(e){this.selection=e},async batch_del(){this.$confirm(`确定删除选中的 ${this.selection.length} 项吗？删除后${this.selection.length} 家店铺相关未归档的问卷、终端打分也会删除；`,"提示",{type:"warning"}).then((async()=>{const e=this.$loading();let a=await this.$API.business.BatchDeleteShop.delete(this.selection.map((e=>e.id)));200===a.code?(this.getDataList(),e.close(),this.$message.success("操作成功")):e.close()})).catch((e=>{console.log(e)}))},upsearch(e){e&&(this.queryInfo.paramData={accountManagerName:"",businessAddress:"",businessType:"",customerName:"",customerPhone:"",deliveryRoute:"",gear:"",marketType:"",marketingDepartmentName:"",name:"",organizationName:"",retailLicenseNumber:""}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},filterTree(e){var a=null;function l(t){t.forEach((t=>{t.id==e&&(a=t),t.children&&l(t.children)}))}return l(this.$refs.table.tableData),a},handleSaveSuccess(e,a){("add"==a||"edit"==a||"import"==a)&&this.getDataList()}}},Y=l(3744);const B=(0,Y.Z)(H,[["render",A],["__scopeId","data-v-02ea0556"]]);var F=B}}]);