"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[4365],{5051:function(e,t,l){l.r(t),l.d(t,{default:function(){return y}});var a=l(6252),i=l(3577);const s=e=>((0,a.dD)("data-v-c94cffa8"),e=e(),(0,a.Cn)(),e),o={class:"left-panel"},n={class:"title"},r={class:"right-panel"},c={class:"longText"},d={class:"longText"},u={class:"label"},m={class:"sheetBox"},p={class:"appraiseSheetName",style:{width:"60%"}},w=s((()=>(0,a._)("div",{class:"atatusGrievances",style:{width:"40%"}},[(0,a._)("p",{class:"complaint-top"},[(0,a._)("span",{class:"orange"}),(0,a.Uk)("该项申诉调研公司未处理 "),(0,a._)("span",{class:"red"}),(0,a.Uk)("该项申诉调研公司已驳回 "),(0,a._)("span",{class:"deepSkyBlue"}),(0,a.Uk)("代表-该项申诉区局（市场部、营销部）超时未处理")]),(0,a._)("p",{class:"complaint-bottom"},[(0,a._)("span",{class:"green"}),(0,a.Uk)("该项申诉调研公司已通过 "),(0,a._)("span",{class:"blue"}),(0,a.Uk)("该项申诉被调研公司修改 "),(0,a._)("span",{class:"gainsboro"}),(0,a.Uk)("代表-该项申诉已被区局（市场部、营销部）驳回")])],-1))),f={key:0},h={key:1},b={key:0};function _(e,t,l,s,_,g){const k=(0,a.up)("el-icon-list"),S=(0,a.up)("el-icon"),W=(0,a.up)("el-button"),v=(0,a.up)("el-header"),x=(0,a.up)("el-form-item"),y=(0,a.up)("el-col"),L=(0,a.up)("el-row"),C=(0,a.up)("el-table-column"),D=(0,a.up)("el-button-group"),N=(0,a.up)("scTable"),z=(0,a.up)("el-main"),U=(0,a.up)("el-container"),T=(0,a.up)("save-dialog"),Z=(0,a.up)("simplePhoto");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,{class:"info"},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)(S,{size:20,color:"var(--el-color-primary)"},{default:(0,a.w5)((()=>[(0,a.Wm)(k)])),_:1}),(0,a._)("div",n,(0,i.zw)(_.detail.businessShopName),1)]),(0,a._)("div",r,[(0,a.Wm)(W,{size:"default",onClick:g.back},{default:(0,a.w5)((()=>[(0,a.Uk)("返回")])),_:1},8,["onClick"]),(0,a.Wm)(W,{type:"primary",size:"default",onClick:g.showPhoto},{default:(0,a.w5)((()=>[(0,a.Uk)("基础照片")])),_:1},8,["onClick"])])])),_:1}),(0,a.Wm)(z,{style:{background:"#fff"}},{default:(0,a.w5)((()=>[(0,a.Wm)(L,{class:"infoHead"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{span:16},{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"客户经理:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.accountManagerName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"区营销部:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.marketingDepartmentName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"区市场部:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.organizationName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"客户名称:"},{default:(0,a.w5)((()=>[(0,a._)("div",c,(0,i.zw)(_.detail.customerName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"零售许可证号:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.retailLicenseNumber||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"客户电话:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.customerPhone||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"市场类型:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(g.filterType(_.detail.marketType,_.marketList)),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"业态:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(g.filterType(_.detail.businessType,_.businessList)),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"线路:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.deliveryRoute||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"档位:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.gear||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:24,sm:24,md:16,lg:16,xl:16},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"店面经营地址:"},{default:(0,a.w5)((()=>[(0,a._)("div",d,(0,i.zw)(_.detail.businessAddress||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"调查人:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.surveyUserName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{xs:24,sm:24,md:16,lg:16,xl:16},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"调查时间:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.completionTime||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(y,{span:24},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"备注:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(_.detail.remarks||"-"),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(y,{span:8,class:"successBox"},{default:(0,a.w5)((()=>[(0,a._)("div",u,"总分："+(0,i.zw)(_.detail.totalScore||0),1)])),_:1})])),_:1}),(0,a._)("div",m,[(0,a._)("div",p,(0,i.zw)(_.detail.sheetName||"-"),1),w,(0,a.Wm)(N,{ref:"table",data:_.detail.topicListList,"span-method":g.objectSpanMethod,"table-layout":"auto",border:"",hiddenMin:"","highlight-current-row":!1,"row-key":"id",hideRefresh:"",hidePagination:"",hideDo:"","cell-style":g.changeCellStyle},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{label:"检查项目",prop:"className","min-width":"150",align:"center"}),(0,a.Wm)(C,{label:"基本分",prop:"classBaseScore","min-width":"150",align:"center"}),(0,a.Wm)(C,{label:"检查要点",prop:"name","min-width":"500",align:"center"}),(0,a.Wm)(C,{label:"分值",prop:"score","min-width":"100",align:"center"},{default:(0,a.w5)((e=>[_.strShow.includes(e.row.no)?((0,a.wg)(),(0,a.iD)("div",f,"否决项")):((0,a.wg)(),(0,a.iD)("div",h,(0,i.zw)(1===e.row.combineStatus?e.row.combineScore:e.row.score),1))])),_:1}),(0,a.Wm)(C,{label:"得分",prop:"hitScore","min-width":"150",align:"center"},{default:(0,a.w5)((e=>[_.strShow.includes(e.row.no)?((0,a.wg)(),(0,a.iD)("div",b,"-")):((0,a.wg)(),(0,a.iD)("div",{key:1,style:(0,i.j5)(g.filterColor(e.row))},(0,i.zw)(1===e.row.combineStatus?e.row.combineHitScore:e.row.hitScore),5))])),_:1}),(0,a.Wm)(C,{label:"操作","min-width":"100",fixed:"right",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(D,null,{default:(0,a.w5)((()=>[(0,a.Wm)(W,{text:"",type:"primary",size:"small",onClick:t=>g.getData(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("查看")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","span-method","cell-style"])])])),_:1})])),_:1}),_.dialog.save?((0,a.wg)(),(0,a.j4)(T,{key:0,ref:"saveDialog",onSuccess:g.handleSaveSuccess,onClosed:t[0]||(t[0]=e=>_.dialog.save=!1)},null,8,["onSuccess"])):(0,a.kq)("",!0),_.dialog.photo?((0,a.wg)(),(0,a.j4)(Z,{key:1,detail:_.detail,ref:"simplePhoto",onClosed:t[1]||(t[1]=e=>_.dialog.photo=!1)},null,8,["detail"])):(0,a.kq)("",!0)],64)}l(7658);var g=l(5152),k=l(3611),S=l(8201),W={name:"plan-detail",components:{saveDialog:g["default"],simplePhoto:k["default"]},data(){return{auditId:this.$route.query.auditId,input:"",dialog:{save:!1,photo:!1},strShow:["BZXZZD_CLASS_01_TOPIC_01","BZXZZD_CLASS_02_TOPIC_01"],detail:{business:{},images:[],result:{},topicClass:[],topicListList:[]},marketList:[{value:1,label:"城市"},{value:2,label:"乡村"},{value:3,label:"乡镇"}],businessList:[{value:1,label:"便利店"},{value:2,label:"超市"},{value:3,label:"商场"},{value:4,label:"烟酒店"},{value:5,label:"食杂店"},{value:6,label:"娱乐服务"},{value:7,label:"其他"}],spanArr:[]}},created(){},mounted(){this.$store.commit("updateViewTagsTitle",`打分计划详情 ID:${this.id}`),this.getDetail(this.$route.query.auditId)},methods:{changeCellStyle(e){return"操作"===e.column.label?{background:"#fff"}:{background:"revert"}},filterColor(e){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),t},getSpanArr(e){let t=[];for(var l=0;l<e.length;l++)0===l?(t.push(1),this.pos=0):e[l].classNo===e[l-1].classNo?(t[this.pos]+=1,t.push(0)):(t.push(1),this.pos=l);return t},objectSpanMethod({rowIndex:e,columnIndex:t}){if(0===t||1===t){const t=this.spanArr[e],l=t>0?1:0;return{rowspan:t,colspan:l}}if([3,4].includes(t)){const t=this.detail.topicListList[e-1],l=this.detail.topicListList[e],a=this.detail.topicListList[e+1];if(!a||l.classNo!==a.classNo)return[1,1];if(1===l.combineStatus&&l.combineNo===t.combineNo)return[0,1];if(1===l.combineStatus&&l.combineNo===a.combineNo)return[2,1]}else if([5].includes(t)){const l=this.detail.topicListList[e-2]||{},a=this.detail.topicListList[e-1]||{},i=this.detail.topicListList[e]||{},s=this.detail.topicListList[e+1];if(0===t&&0===e)return[1,1];if("BZXZZD_CLASS_02_TOPIC_01"===i.no&&"否"===i.selectOption)return[3,1];if("BZXZZD_CLASS_02_TOPIC_01"===l.no&&"否"===l.selectOption||"BZXZZD_CLASS_02_TOPIC_01"===a.no&&"否"===a.selectOption)return[0,1];if(!s||i.classNo!==s.classNo)return[1,1];if(1===i.combineStatus&&i.combineNo===a.combineNo)return[0,1];if(1===i.combineStatus&&i.combineNo===s.combineNo)return[2,1]}},async getData(e){let t=this.detail.resultId,l=[];const{combineStatus:a,combineNo:i}=e;switch(a){case 1:l=this.detail.topicListList.filter((e=>e.combineNo===i));break;case 2:l.push(e);break}let s={topic:l.map((e=>e.no)).join("-")};this.dialog.save=!0,await this.$API.researchInfo.CityMarketOffice.GetDetailSubjectAppeal.get(t,s),this.$nextTick((()=>{this.$refs.saveDialog.open().setData(l)}))},filterType(e,t=[]){return t.find((t=>t.value===e))?.label||"-"},async getDetail(e){let t=await this.$API.researchInfo.CityMarketOffice.GetScoringTableList.get(e);200===t.code?(this.detail=t.data||{},this.spanArr=this.getSpanArr(t.data.topicListList)):S.Z.closeNext((()=>{this.$router.back()}))},back(){S.Z.closeNext((()=>{this.$router.back()}))},showPhoto(){this.dialog.photo=!0,this.$nextTick((()=>{this.$refs.simplePhoto.open()}))},handleClick(e){switch(e.props.name){case"1":this.$refs.RecycleDetail.initData();break;case"2":this.$refs.PlanUserList.initData();break;case"3":this.$refs.StoreList.initData();break}},handleSaveSuccess(e,t){"edit"==t&&this.getDetail(e.id)}}},v=l(3744);const x=(0,v.Z)(W,[["render",_],["__scopeId","data-v-c94cffa8"]]);var y=x}}]);