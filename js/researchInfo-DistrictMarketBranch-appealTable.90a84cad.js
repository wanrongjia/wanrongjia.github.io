"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[3680],{7080:function(e,t,l){l.r(t),l.d(t,{default:function(){return D}});var a=l(6252),i=l(3577);const s=e=>((0,a.dD)("data-v-4287e61a"),e=e(),(0,a.Cn)(),e),o={class:"left-panel"},c={class:"title"},n={class:"right-panel"},r={class:"longText"},d={class:"label"},u={class:"sheetBox"},m={class:"appraiseSheetName"},p={class:"colorPanel"},h=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#ffc327"}}),(0,a.Uk)(" 代表-该项申诉未处理 ")],-1))),f=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#ff2727"}}),(0,a.Uk)(" 代表-该项申诉已驳回 ")],-1))),w=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#23994a"}}),(0,a.Uk)(" 代表-该项申诉已通过 ")],-1))),b=s((()=>(0,a._)("div",{class:"color-item"},[(0,a._)("div",{class:"block",style:{"--background":"#2780ff"}}),(0,a.Uk)(" 代表-该项申诉超时未处理 ")],-1))),_={key:0},g={key:1},k={key:0};function S(e,t,l,s,S,v){const W=(0,a.up)("el-icon-list"),y=(0,a.up)("el-icon"),C=(0,a.up)("el-button"),L=(0,a.up)("el-header"),N=(0,a.up)("el-form-item"),x=(0,a.up)("el-col"),D=(0,a.up)("el-row"),Z=(0,a.up)("el-table-column"),A=(0,a.up)("el-button-group"),z=(0,a.up)("scTable"),P=(0,a.up)("el-main"),U=(0,a.up)("el-container"),I=(0,a.up)("save-dialog"),T=(0,a.up)("simplePhoto"),$=(0,a.up)("openAppeal");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L,{class:"info"},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)(y,{size:20,color:"var(--el-color-primary)"},{default:(0,a.w5)((()=>[(0,a.Wm)(W)])),_:1}),(0,a._)("div",c,(0,i.zw)(S.detail.businessShopName),1)]),(0,a._)("div",n,[(0,a.Wm)(C,{size:"default",onClick:v.back},{default:(0,a.w5)((()=>[(0,a.Uk)("返回")])),_:1},8,["onClick"]),(0,a.Wm)(C,{type:"primary",size:"default",onClick:v.showPhoto},{default:(0,a.w5)((()=>[(0,a.Uk)("基础照片")])),_:1},8,["onClick"])])])),_:1}),(0,a.Wm)(P,{style:{background:"#fff"}},{default:(0,a.w5)((()=>[(0,a.Wm)(D,{class:"infoHead"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{span:16},{default:(0,a.w5)((()=>[(0,a.Wm)(D,null,{default:(0,a.w5)((()=>[(0,a.Wm)(x,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{label:"客户经理:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(S.detail.accountManagerName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(x,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{label:"区营销部:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(S.detail.marketingDepartmentName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(x,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{label:"区市场部:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(S.detail.organizationName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(x,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{label:"客户名称:"},{default:(0,a.w5)((()=>[(0,a._)("div",r,(0,i.zw)(S.detail.customerName||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(x,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{label:"专卖证号:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(S.detail.retailLicenseNumber||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(x,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{label:"客户电话:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(S.detail.customerPhone||"-"),1)])),_:1})])),_:1}),(0,a.Wm)(x,{xs:24,sm:24,md:16,lg:16,xl:16},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{label:"调研时间:"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(S.detail.completionTime||"-"),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(x,{span:8,class:"successBox"},{default:(0,a.w5)((()=>[(0,a._)("div",d,"总分："+(0,i.zw)(S.detail.totalScore||0),1)])),_:1})])),_:1}),(0,a._)("div",u,[(0,a._)("div",m,[(0,a.Uk)((0,i.zw)(S.detail.sheetName||"-")+" ",1),(0,a._)("div",p,[(0,a.Wm)(D,{style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{span:12},{default:(0,a.w5)((()=>[h])),_:1}),(0,a.Wm)(x,{span:12},{default:(0,a.w5)((()=>[f])),_:1}),(0,a.Wm)(x,{span:12},{default:(0,a.w5)((()=>[w])),_:1}),(0,a.Wm)(x,{span:12},{default:(0,a.w5)((()=>[b])),_:1})])),_:1})])]),(0,a.Wm)(z,{ref:"table",data:S.detail.topicListList,"span-method":v.objectSpanMethod,"table-layout":"auto",border:"",hiddenMin:"","highlight-current-row":!1,"row-key":"id",hideRefresh:"",hidePagination:"",hideDo:"","cell-style":v.changeCellStyle},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{label:"检查项目",prop:"className","min-width":"150",align:"center"}),(0,a.Wm)(Z,{label:"基本分",prop:"classBaseScore","min-width":"150",align:"center"}),(0,a.Wm)(Z,{label:"检查要点",prop:"name","min-width":"500",align:"center"}),(0,a.Wm)(Z,{label:"分值",prop:"score","min-width":"100",align:"center"},{default:(0,a.w5)((e=>[S.strShow.includes(e.row.no)?((0,a.wg)(),(0,a.iD)("div",_,"否决项")):((0,a.wg)(),(0,a.iD)("div",g,(0,i.zw)(1===e.row.combineStatus?e.row.combineScore:e.row.score),1))])),_:1}),(0,a.Wm)(Z,{label:"得分",prop:"hitScore","min-width":"150",align:"center"},{default:(0,a.w5)((e=>[S.strShow.includes(e.row.no)?((0,a.wg)(),(0,a.iD)("div",k,"-")):((0,a.wg)(),(0,a.iD)("div",{key:1,style:(0,i.j5)(v.filterColor(e.row))},(0,i.zw)(1===e.row.combineStatus?e.row.combineHitScore:e.row.hitScore),5))])),_:1}),(0,a.Wm)(Z,{label:"操作","min-width":"100",fixed:"right",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(A,null,{default:(0,a.w5)((()=>[(0,a.Wm)(C,{text:"",type:"primary",size:"small",onClick:t=>v.getData(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("查看")])),_:2},1032,["onClick"]),v.filteShow(e.row)?((0,a.wg)(),(0,a.j4)(C,{key:0,text:"",type:"primary",size:"small",onClick:t=>v.getAppeal(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("审核")])),_:2},1032,["onClick"])):(0,a.kq)("",!0)])),_:2},1024)])),_:1})])),_:1},8,["data","span-method","cell-style"])])])),_:1})])),_:1}),S.dialog.save?((0,a.wg)(),(0,a.j4)(I,{key:0,ref:"saveDialog",onSuccess:v.handleSaveSuccess,onClosed:t[0]||(t[0]=e=>S.dialog.save=!1)},null,8,["onSuccess"])):(0,a.kq)("",!0),S.dialog.photo?((0,a.wg)(),(0,a.j4)(T,{key:1,detail:S.detail,ref:"simplePhoto",onClosed:t[1]||(t[1]=e=>S.dialog.photo=!1)},null,8,["detail"])):(0,a.kq)("",!0),S.dialog.appeal?((0,a.wg)(),(0,a.j4)($,{key:2,ref:"openAppeal",onSuccess:v.handleSaveSuccess,onClose:t[2]||(t[2]=e=>S.dialog.appeal=!1)},null,8,["onSuccess"])):(0,a.kq)("",!0)],64)}l(7658);var v=l(1724),W=l(3227),y=l(9924),C=l(8201),L={name:"plan-detail",components:{saveDialog:v["default"],simplePhoto:W["default"],openAppeal:y["default"]},data(){return{id:this.$route.query.id,input:"",dialog:{save:!1,photo:!1,appeal:!1},strShow:["BZXZZD_CLASS_01_TOPIC_01","BZXZZD_CLASS_02_TOPIC_01"],detail:{business:{},images:[],result:{},topicClass:[],topicListList:[]},spanArr:[]}},created(){},mounted(){this.getDetail(this.$route.query.id)},methods:{changeCellStyle({row:e,column:t,columnIndex:l}){return 4===l&&0===e.status?{background:"#ffc327"}:4===l&&1===e.status?{background:"#b6f3ca"}:4===l&&2===e.status?{background:"#fbcbcb"}:4===l&&3===e.status?{background:"#91d5ff"}:"操作"===t.label?{background:"#fff"}:{background:"revert"}},filteShow(e){if("BZXZZD_CLASS_02_TOPIC_01"===e.no&&0===e.status&&"否"===e.selectOption)return!0;let t=!1;return 1===e.combineStatus?e.combineHitScore<e.combineScore&&0===e.status&&(t=!0):e.hitScore<e.score&&0===e.status&&(t=!0),t},filterColor(e){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),t},getSpanArr(e){let t=[];for(var l=0;l<e.length;l++)0===l?(t.push(1),this.pos=0):e[l].classNo===e[l-1].classNo?(t[this.pos]+=1,t.push(0)):(t.push(1),this.pos=l);return t},objectSpanMethod({rowIndex:e,columnIndex:t}){if(0===t||1===t){const t=this.spanArr[e],l=t>0?1:0;return{rowspan:t,colspan:l}}if([3,4].includes(t)){const t=this.detail.topicListList[e-1],l=this.detail.topicListList[e],a=this.detail.topicListList[e+1];if(!a||l.classNo!==a.classNo)return[1,1];if(1===l.combineStatus&&l.combineNo===t.combineNo)return[0,1];if(1===l.combineStatus&&l.combineNo===a.combineNo)return[2,1]}else if([5].includes(t)){const l=this.detail.topicListList[e-2]||{},a=this.detail.topicListList[e-1]||{},i=this.detail.topicListList[e]||{},s=this.detail.topicListList[e+1];if(0===t&&0===e)return[1,1];if("BZXZZD_CLASS_02_TOPIC_01"===i.no&&"否"===i.selectOption)return[3,1];if("BZXZZD_CLASS_02_TOPIC_01"===l.no&&"否"===l.selectOption||"BZXZZD_CLASS_02_TOPIC_01"===a.no&&"否"===a.selectOption)return[0,1];if(!s||i.classNo!==s.classNo)return[1,1];if(1===i.combineStatus&&i.combineNo===a.combineNo)return[0,1];if(1===i.combineStatus&&i.combineNo===s.combineNo)return[2,1]}},getData(e){let t=[];const{combineStatus:l,combineNo:a}=e;switch(l){case 1:t=this.detail.topicListList.filter((e=>e.combineNo===a));break;case 2:t.push(e);break}this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("add",this.detail.resultId).setData(t)}))},getAppeal(e){let t=[];const{combineStatus:l,combineNo:a}=e;switch(l){case 1:t=this.detail.topicListList.filter((e=>e.combineNo===a));break;case 2:t.push(e);break}this.dialog.appeal=!0,this.$nextTick((()=>{this.$refs.openAppeal.open("add",this.detail.resultId).setData(t)}))},filterType(e,t=[]){return t.find((t=>t.value===e))?.label||"-"},async getDetail(e){let t=await this.$API.researchInfo.ResearchCompany.GetAuditSheetDetail.get(e);200===t.code?(this.detail=t.data||{},this.spanArr=this.getSpanArr(t.data.topicListList)):C.Z.closeNext((()=>{this.$router.back()}))},back(){C.Z.closeNext((()=>{this.$router.back()}))},showPhoto(){this.dialog.photo=!0,this.$nextTick((()=>{this.$refs.simplePhoto.open()}))},handleSaveSuccess(){this.getDetail(this.id)}}},N=l(3744);const x=(0,N.Z)(L,[["render",S],["__scopeId","data-v-4287e61a"]]);var D=x}}]);