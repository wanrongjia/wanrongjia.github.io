(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[6325],{8201:function(e,a,t){"use strict";t(7658);var l=t(6252),i=t(4865),s=t.n(i),o=t(4799),n=t(9123);a["Z"]={refresh(){s().start();const e=o.Z.currentRoute.value;n.Z.commit("removeKeepLive",e.name),n.Z.commit("setRouteShow",!1),(0,l.Y3)((()=>{n.Z.commit("pushKeepLive",e.name),n.Z.commit("setRouteShow",!0),s().done()}))},close(e){const a=e||o.Z.currentRoute.value;n.Z.commit("removeViewTags",a),n.Z.commit("removeIframeList",a),n.Z.commit("removeKeepLive",a.name);const t=n.Z.state.viewTags.viewTags,l=t.slice(-1)[0];l?o.Z.push(l):o.Z.push("/")},closeNext(e){const a=o.Z.currentRoute.value;if(n.Z.commit("removeViewTags",a),n.Z.commit("removeIframeList",a),n.Z.commit("removeKeepLive",a.name),e){const a=n.Z.state.viewTags.viewTags;e(a)}},closeOther(){const e=o.Z.currentRoute.value,a=[...n.Z.state.viewTags.viewTags];a.forEach((a=>{if(a.meta&&a.meta.affix||e.fullPath==a.fullPath)return!0;this.close(a)}))},setTitle(e){n.Z.commit("updateViewTagsTitle",e)}}},2787:function(e,a,t){"use strict";function l(e,a,t){let l=/^[\-\+]?(0?\d{1,2}(\.\d{1,})*|1[0-7]?\d{1}(\.\d{1,})*|180(\.0{1,})*)$/;if(!l.test(a))return t(new Error("请输入正确的经度坐标"));t()}function i(e,a,t){let l=/^[\-\+]?([0-8]?\d{1}(\.\d{1,})*|90(\.0{1,})*)$/;if(!l.test(a))return t(new Error("请输入正确的纬度坐标"));t()}function s(e,a,t){let l=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{6,20}$/,i=/^(?=.*[~!@#$%&*])(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z~!@#$%&*\d]{6,20}$/;return i.test(a)||l.test(a)?t():void t(new Error("请输入6-20位字母、数字或标点符号组合的密码"))}function o(e,a,t){a||t();let l=/^[+]{0,1}(\d+)$/;l.test(a)||t(new Error("请输入整形数字")),t()}t.d(a,{C$:function(){return o},Gv:function(){return s},Ze:function(){return i},vD:function(){return l}})},2850:function(e,a,t){"use strict";t.r(a);var l=t(2262);const i={};let s=t(1783);s.keys().forEach((e=>{let a=s(e);i[e.replace(/^\.\/(.*)\.\w+$/,"$1")]=a.default})),a["default"]=(0,l.Xl)(i)},1158:function(e,a,t){"use strict";t.d(a,{Z:function(){return u}});var l=t(6252),i=t(3577);const s={class:"sc-password-strength"};function o(e,a,t,o,n,r){return(0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",{class:(0,i.C_)(["sc-password-strength-bar",`sc-password-strength-level-${n.level}`])},null,2)])}var n={props:{modelValue:{type:String,default:""}},data(){return{level:0}},watch:{modelValue(){this.strength(this.modelValue)}},mounted(){this.strength(this.modelValue)},methods:{strength(e){var a=0,t=e.length>=6,l=/\d/.test(e),i=/[a-z]/.test(e),s=/[A-Z]/.test(e),o=!/(\w)\1{2}/.test(e),n=/[~!@#$%&*]/.test(e);return e.length<=0?(a=0,this.level=a,!1):t?(l&&(a+=1),i&&(a+=1),s&&(a+=1),o&&(a+=1),n&&(a+=1),void(this.level=a)):(a=1,this.level=a,!1)}}},r=t(3744);const d=(0,r.Z)(n,[["render",o],["__scopeId","data-v-b93ff246"]]);var u=d},3012:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-e4667fd0"),e=e(),(0,l.Cn)(),e),o=s((()=>(0,l._)("div",{class:"ball"},"1",-1))),n=s((()=>(0,l._)("div",{class:"text"},"上传文件",-1))),r=s((()=>(0,l._)("div",{class:"ball"},"2",-1))),d=s((()=>(0,l._)("div",{class:"text"},"确认结果",-1))),u={key:0,class:"center"},m=s((()=>(0,l._)("div",{class:"el-upload__text"}," 点击或将文件拖拽到这里上传 ",-1))),c={key:1,class:"center"},p={class:"successText"},h={class:"errText"},f={key:0},g={key:1};function w(e,a,t,s,w,b){const y=(0,l.up)("el-col"),_=(0,l.up)("el-row"),v=(0,l.up)("el-icon-message-box"),k=(0,l.up)("el-icon"),W=(0,l.up)("sc-upload-file"),I=(0,l.up)("el-form-item"),S=(0,l.up)("el-form"),D=(0,l.up)("el-button"),C=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(C,{title:w.titleMap[w.mode],modelValue:w.visible,"onUpdate:modelValue":a[7]||(a[7]=e=>w.visible=e),width:700,"destroy-on-close":"",onClosed:a[8]||(a[8]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[1===w.active?((0,l.wg)(),(0,l.iD)("div",f,[(0,l.Wm)(D,{onClick:a[3]||(a[3]=e=>w.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(D,{type:"primary",disabled:!b.uploadStatus,onClick:a[4]||(a[4]=e=>b.changePage(2))},{default:(0,l.w5)((()=>[(0,l.Uk)("下一步")])),_:1},8,["disabled"])])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",g,[(0,l.Wm)(D,{onClick:a[5]||(a[5]=e=>b.changePage(1))},{default:(0,l.w5)((()=>[(0,l.Uk)("上一步")])),_:1}),(0,l.Wm)(D,{type:"primary",loading:w.isSaveing,onClick:a[6]||(a[6]=e=>b.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交结果")])),_:1},8,["loading"])])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:18,offset:3},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{style:{"margin-bottom":"24px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>0?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[o,n])),_:1},8,["style"]),(0,l.Wm)(y,{span:12,class:"line"}),(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>1?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[r,d])),_:1},8,["style"])])),_:1}),1===w.active?((0,l.wg)(),(0,l.iD)("div",u,[(0,l.Wm)(S,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"上传文件：",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:(0,i.C_)({disUoloadSty:b.uploadStatus}),tip:"支持拓展名: .xls .xlsx",accept:".xls,.xlsx",modelValue:w.file,"onUpdate:modelValue":a[0]||(a[0]=e=>w.file=e),apiObj:w.apiObj,limit:1,drag:"",onRemove:b.onRemove,onSuccess:b.uploadSuccess},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{class:"el-icon--upload",style:{color:"rgb(24, 144, 255)"}},{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}),m])),_:1},8,["class","modelValue","apiObj","onRemove","onSuccess"])])),_:1})])),_:1}),(0,l.Wm)(S,{"label-position":"right"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"模板文件："},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量上传模版.xls "),(0,l._)("div",{class:"downLoad",onClick:a[1]||(a[1]=(...e)=>b.downLoadTemplate&&b.downLoadTemplate(...e))},"下载")])),_:1})])),_:1})])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(S,{"label-width":"150px"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:14,offset:5},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"可导入店铺数:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(w.uploadInfo.importQuantity),1)])),_:1}),(0,l.Wm)(I,{label:"无法导入数:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,[(0,l.Uk)((0,i.zw)(w.uploadInfo.unImportQuantity)+" ",1),(0,l._)("div",{class:"downLoad",onClick:a[2]||(a[2]=(...e)=>b.downLoadErr&&b.downLoadErr(...e))},"下载失败信息")])])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["title","modelValue"])}var b={emits:["success","closed"],props:{marketList:{type:Array,default:()=>[]},businessList:{type:Array,default:()=>[]}},data(){return{apiObj:this.$API.business.UploadManyEdit,active:1,mode:"manyEdit",titleMap:{manyEdit:"批量修改店铺"},visible:!1,isSaveing:!1,file:[],uploadInfo:{fileName:"",importId:"",importQuantity:0,unImportQuantity:0}}},mounted(){},computed:{uploadStatus({file:e}){return e.length>0}},methods:{open(e="manyEdit"){return this.mode=e,this.visible=!0,this},changePage(e){this.active=e},onRemove(){return this.uploadInfo={fileName:"",importId:"",importQuantity:0,unImportQuantity:0},this.file=[],!0},uploadSuccess(e){const{fileName:a,importId:t}=e.data;return this.uploadInfo=e.data,this.file=[{name:a,url:t}],!1},async submit(){let e=await this.$API.business.ImportShop.post(this.uploadInfo.importId);200==e.code?(this.$emit("success",{},"import"),this.visible=!1,this.$message.success("导入成功")):this.$alert(e.message,"提示",{type:"error"})},async setData(e){if(Object.assign(this.form,e),!e.organizationId)return this.userList=[];let a=await this.$API.business.GetShopUserList.get(e.organizationId);200==a.code?(this.form.accountManagerId="",this.userList=a.data,this.disable=!1):this.$alert(a.message,"提示",{type:"error"})},async downLoadTemplate(){let e=await this.$API.business.DownloadImportTemplate.get();const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","批量上传模版.xls"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},async downLoadErr(){let e=await this.$API.business.DownloadImportRES.get(this.uploadInfo.importId);const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","失败信息.xls"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}},y=t(3744);const _=(0,y.Z)(b,[["render",w],["__scopeId","data-v-e4667fd0"]]);var v=_},412:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-cascader"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-option"),u=(0,l.up)("el-select"),m=(0,l.up)("el-input"),c=(0,l.up)("el-col"),p=(0,l.up)("el-form"),h=(0,l.up)("el-button"),f=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(f,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[16]||(a[16]=e=>s.visible=e),width:700,"destroy-on-close":"",onClosed:a[17]||(a[17]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(h,{onClick:a[13]||(a[13]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),["add"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(h,{key:0,type:"primary",loading:s.isSaveing,onClick:a[14]||(a[14]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0),["edit"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(h,{key:1,type:"primary",loading:s.isSaveing,onClick:a[15]||(a[15]=e=>o.editData())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(p,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"150px"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{span:20,offset:2},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"所属市场部",prop:"organizationId"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{ref:"orgRef",modelValue:s.form.organizationId,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.organizationId=e),options:s.groups,onChange:o.changeNode,props:s.groupsProps,"show-all-levels":!1,clearable:"",style:{width:"100%"}},null,8,["modelValue","options","onChange","props"])])),_:1}),(0,l.Wm)(r,{label:"客户经理",prop:"accountManagerId"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},modelValue:s.form.accountManagerId,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.accountManagerId=e),disabled:s.disable,filterable:"",placeholder:"请选择客户经理"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.userList,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),(0,l.Wm)(r,{label:"零售许可证号",prop:"retailLicenseNumber"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:s.form.retailLicenseNumber,"onUpdate:modelValue":a[2]||(a[2]=e=>s.form.retailLicenseNumber=e),placeholder:"请输入许可证号",disabled:"edit"===s.mode,clearable:""},null,8,["modelValue","disabled"])])),_:1}),(0,l.Wm)(r,{label:"店铺名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:s.form.name,"onUpdate:modelValue":a[3]||(a[3]=e=>s.form.name=e),placeholder:"请输入店铺名称",maxlength:"50",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"客户名称",prop:"customerName"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:s.form.customerName,"onUpdate:modelValue":a[4]||(a[4]=e=>s.form.customerName=e),placeholder:"请输入客户名称",maxlength:"50","show-word-limit":"",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"客户电话",prop:"customerPhone"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:s.form.customerPhone,"onUpdate:modelValue":a[5]||(a[5]=e=>s.form.customerPhone=e),placeholder:"请输入客户电话",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"店面经营地址",prop:"businessAddress"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:s.form.businessAddress,"onUpdate:modelValue":a[6]||(a[6]=e=>s.form.businessAddress=e),maxlength:"50","show-word-limit":"",placeholder:"请输入门店地址",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"GIS坐标",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"longitude"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{type:"number",min:-180,max:180,modelValue:s.form.longitude,"onUpdate:modelValue":a[7]||(a[7]=e=>s.form.longitude=e),placeholder:"请输入经度坐标",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{class:"line",span:2},{default:(0,l.w5)((()=>[(0,l.Uk)(":")])),_:1}),(0,l.Wm)(c,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"latitude"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{type:"number",min:-90,max:90,modelValue:s.form.latitude,"onUpdate:modelValue":a[8]||(a[8]=e=>s.form.latitude=e),placeholder:"请输入纬度坐标",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,{label:"市场类型",prop:"marketType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},modelValue:s.form.marketType,"onUpdate:modelValue":a[9]||(a[9]=e=>s.form.marketType=e),filterable:"",placeholder:"请选择市场类型"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.marketList,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"业态",prop:"businessType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},modelValue:s.form.businessType,"onUpdate:modelValue":a[10]||(a[10]=e=>s.form.businessType=e),filterable:"",placeholder:"请选择业态"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.businessList,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"送货线路组-线路",prop:"deliveryRoute"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:s.form.deliveryRoute,"onUpdate:modelValue":a[11]||(a[11]=e=>s.form.deliveryRoute=e),placeholder:"请输入线路名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"档位",prop:"gear"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:s.form.gear,"onUpdate:modelValue":a[12]||(a[12]=e=>s.form.gear=e),maxlength:"50",min:"0","show-word-limit":"",placeholder:"请输入档位信息",clearable:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s=t(2787),o={emits:["success","closed"],props:{marketList:{type:Array,default:()=>[]},businessList:{type:Array,default:()=>[]}},data(){const e=(e,a,t)=>{this.form.level<4?t(new Error("请选择4级部门")):t()};return{mode:"add",titleMap:{add:"新建店铺",edit:"编辑店铺"},visible:!1,isSaveing:!1,form:{accountManagerId:"",businessAddress:"",businessType:"",customerName:"",customerPhone:"",deliveryRoute:"",gear:"",latitude:"",longitude:"",marketType:"",name:"",organizationId:"",retailLicenseNumber:""},rules:{accountManagerId:[{required:!0,message:"请选择客户经理",trigger:"change"}],organizationId:[{required:!0,message:"请选择所属市场部",trigger:"change"},{validator:e,trigger:"change"}],retailLicenseNumber:[{required:!0,message:"请输入许可证号"}],name:[{required:!0,message:"请输入店铺名称"}],customerName:[{required:!0,message:"请输入客户名称"}],customerPhone:[{required:!0,message:"请输入客户电话"},{validator:s.C$,trigger:["blur","change"]}],businessAddress:[{required:!0,message:"请输入门店地址"}],longitude:[{required:!0,message:"请输入经度坐标"},{validator:s.vD,trigger:["blur","change"]}],latitude:[{required:!0,message:"请输入纬度坐标"},{validator:s.Ze,trigger:["blur","change"]}],marketType:[{required:!0,message:"请选择市场类型"}],businessType:[{required:!0,message:"请选择业态"}],deliveryRoute:[{required:!0,message:"请输入线路信息"}],gear:[{required:!0,message:"请输入档位信息"},{validator:s.C$,trigger:["change","blur"]}]},groups:[],groupsProps:{label:"name",value:"id",children:"subset",emitPath:!1},disable:!0,userList:[]}},mounted(){this.getGroup()},methods:{async getGroup(){let e=await this.$API.user.GetOrgList.get();this.groups=[e.data]},open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;var a=await this.$API.business.CreateShop.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}}))},editData(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.business.UpdateShop.put(this.form.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},async changeNode(){if(this.$refs.orgRef.getCheckedNodes().length){this.form.accountManagerId="";const{level:e,data:a}=this.$refs.orgRef.getCheckedNodes()[0];if(this.form.level=e,e<4)return;let t=await this.$API.business.GetShopUserList.get(a.id);200==t.code?(this.userList=t.data,this.disable=!1):this.$alert(t.message,"提示",{type:"error"})}},async setData(e){if(!e.organizationId)return this.userList=[];let a=await this.$API.business.GetShopUserList.get(e.organizationId);200==a.code?(this.form.accountManagerId="",this.userList=a.data,this.disable=!1):this.$alert(a.message,"提示",{type:"error"}),Object.assign(this.form,e)}}},n=t(3744);const r=(0,n.Z)(o,[["render",i],["__scopeId","data-v-38cb21af"]]);var d=r},8790:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-1ed25555"),e=e(),(0,l.Cn)(),e),o=s((()=>(0,l._)("div",{class:"ball"},"1",-1))),n=s((()=>(0,l._)("div",{class:"text"},"上传文件",-1))),r=s((()=>(0,l._)("div",{class:"ball"},"2",-1))),d=s((()=>(0,l._)("div",{class:"text"},"确认结果",-1))),u={key:0,class:"center"},m=s((()=>(0,l._)("div",{class:"el-upload__text"}," 点击或将文件拖拽到这里上传 ",-1))),c={key:1,class:"center"},p={class:"successText"},h={class:"errText"},f={key:0},g={key:1};function w(e,a,t,s,w,b){const y=(0,l.up)("el-col"),_=(0,l.up)("el-row"),v=(0,l.up)("el-icon-message-box"),k=(0,l.up)("el-icon"),W=(0,l.up)("sc-upload-file"),I=(0,l.up)("el-form-item"),S=(0,l.up)("el-form"),D=(0,l.up)("el-button"),C=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(C,{title:w.titleMap[w.mode],modelValue:w.visible,"onUpdate:modelValue":a[7]||(a[7]=e=>w.visible=e),width:700,"destroy-on-close":"",onClosed:a[8]||(a[8]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[1===w.active?((0,l.wg)(),(0,l.iD)("div",f,[(0,l.Wm)(D,{onClick:a[3]||(a[3]=e=>w.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(D,{type:"primary",disabled:!b.uploadStatus,onClick:a[4]||(a[4]=e=>b.changePage(2))},{default:(0,l.w5)((()=>[(0,l.Uk)("下一步")])),_:1},8,["disabled"])])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",g,[(0,l.Wm)(D,{onClick:a[5]||(a[5]=e=>b.changePage(1))},{default:(0,l.w5)((()=>[(0,l.Uk)("上一步")])),_:1}),(0,l.Wm)(D,{type:"primary",loading:w.isSaveing,onClick:a[6]||(a[6]=e=>b.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交结果")])),_:1},8,["loading"])])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:18,offset:3},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{style:{"margin-bottom":"24px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>0?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[o,n])),_:1},8,["style"]),(0,l.Wm)(y,{span:12,class:"line"}),(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>1?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[r,d])),_:1},8,["style"])])),_:1}),1===w.active?((0,l.wg)(),(0,l.iD)("div",u,[(0,l.Wm)(S,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"上传文件：",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:(0,i.C_)({disUoloadSty:b.uploadStatus}),tip:"支持拓展名: .xls .xlsx",accept:".xls,.xlsx",modelValue:w.file,"onUpdate:modelValue":a[0]||(a[0]=e=>w.file=e),apiObj:w.apiObj,limit:1,drag:"",onRemove:b.onRemove,onSuccess:b.uploadSuccess},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{class:"el-icon--upload",style:{color:"rgb(24, 144, 255)"}},{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}),m])),_:1},8,["class","modelValue","apiObj","onRemove","onSuccess"])])),_:1})])),_:1}),(0,l.Wm)(S,{"label-position":"right"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"模板文件："},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量上传模版.xls "),(0,l._)("div",{class:"downLoad",onClick:a[1]||(a[1]=(...e)=>b.downLoadTemplate&&b.downLoadTemplate(...e))},"下载")])),_:1})])),_:1})])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(S,{"label-width":"150px"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:14,offset:5},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"可导入店铺数:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(w.uploadInfo.importQuantity),1)])),_:1}),(0,l.Wm)(I,{label:"无法导入数:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,[(0,l.Uk)((0,i.zw)(w.uploadInfo.unImportQuantity)+" ",1),w.uploadInfo.unImportQuantity?((0,l.wg)(),(0,l.iD)("div",{key:0,class:"downLoad",onClick:a[2]||(a[2]=(...e)=>b.downLoadErr&&b.downLoadErr(...e))},"下载失败信息")):(0,l.kq)("",!0)])])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["title","modelValue"])}var b={emits:["success","closed"],props:{marketList:{type:Array,default:()=>[]},businessList:{type:Array,default:()=>[]}},data(){return{apiObj:this.$API.business.UploadImport,active:1,mode:"import",titleMap:{import:"批量导入店铺"},visible:!1,isSaveing:!1,file:[],uploadInfo:{fileName:"",importId:"",importQuantity:0,unImportQuantity:0}}},mounted(){},computed:{uploadStatus({file:e}){return e.length>0}},methods:{open(e="import"){return this.mode=e,this.visible=!0,this},changePage(e){this.active=e},onRemove(){return this.uploadInfo={fileName:"",importId:"",importQuantity:0,unImportQuantity:0},this.file=[],!0},uploadSuccess(e){const{fileName:a,importId:t}=e.data;return this.uploadInfo=e.data,this.file=[{name:a,url:t}],!1},async submit(){let e=await this.$API.business.ImportShop.post(this.uploadInfo.importId);200==e.code?(this.$emit("success",{},"import"),this.visible=!1,this.$message.success("导入成功")):this.$alert(e.message,"提示",{type:"error"})},async setData(e){Object.assign(this.form,e)},async downLoadTemplate(){let e=await this.$API.business.DownloadImportTemplate.get();const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","批量上传模版.xls"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},async downLoadErr(){let e=await this.$API.business.DownloadImportRES.get(this.uploadInfo.importId);const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","失败信息.xls"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}},y=t(3744);const _=(0,y.Z)(b,[["render",w],["__scopeId","data-v-1ed25555"]]);var v=_},7798:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return m}});var l=t(6252);const i=e=>((0,l.dD)("data-v-2a4d28f0"),e=e(),(0,l.Cn)(),e),s=i((()=>(0,l._)("p",null,"高性能 / 精致 / 优雅。基于Vue3 + Element-Plus 的中后台前端解决方案，如果喜欢就点个星星支持一下。",-1))),o=i((()=>(0,l._)("p",null,[(0,l._)("a",{href:"https://gitee.com/lolicode/scui",target:"_blank"},[(0,l._)("img",{src:"https://gitee.com/lolicode/scui/badge/star.svg?theme=dark",alt:"star",style:{"vertical-align":"middle"}})])],-1)));function n(e,a,t,i,n,r){const d=(0,l.up)("el-card");return(0,l.wg)(),(0,l.j4)(d,{shadow:"hover",header:"关于项目",class:"item-background"},{default:(0,l.w5)((()=>[s,o])),_:1})}var r={title:"关于项目",icon:"el-icon-setting",description:"点个星星支持一下",data(){return{}}},d=t(3744);const u=(0,d.Z)(r,[["render",n],["__scopeId","data-v-2a4d28f0"]]);var m=u},390:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return w}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("scEcharts"),r=(0,l.up)("el-card"),d=(0,l.Q2)("loading");return(0,l.wy)(((0,l.wg)(),(0,l.j4)(r,{shadow:"hover",header:"实时收入"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{ref:"c1",height:"300px",option:s.option},null,8,["option"])])),_:1})),[[d,s.loading]])}t(541),t(7658);var s=t(3577);function o(e,a,t,i,o,n){return(0,l.wg)(),(0,l.iD)("div",{ref:"scEcharts",style:(0,s.j5)({height:t.height,width:t.width})},null,4)}var n=t(4826);const r={color:["#409EFF","#36CE9E","#f56e6a","#626c91","#edb00d","#909399"],grid:{left:"3%",right:"3%",bottom:"10",top:"40",containLabel:!0},legend:{textStyle:{color:"#999"},inactiveColor:"rgba(128,128,128,0.4)"},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"rgba(128,128,128,0.2)",width:1}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{color:"#999"},splitLine:{show:!1,lineStyle:{color:["#eee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(255,255,255,0.01)","rgba(0,0,0,0.01)"]}}},valueAxis:{axisLine:{show:!1,lineStyle:{color:"#999"}},splitLine:{show:!0,lineStyle:{color:"rgba(128,128,128,0.2)"}}}};var d=r;n.registerTheme("T",d);const u=e=>e&&(e.__v_raw||e.valueOf()||e);var m={...n,name:"scEcharts",props:{height:{type:String,default:"100%"},width:{type:String,default:"100%"},nodata:{type:Boolean,default:!1},option:{type:Object,default:()=>{}}},data(){return{isActivat:!1,myChart:null}},watch:{option:{deep:!0,handler(e){u(this.myChart).setOption(e)}}},computed:{myOptions:function(){return this.option||{}}},activated(){this.isActivat||this.$nextTick((()=>{this.myChart.resize()}))},deactivated(){this.isActivat=!1},mounted(){this.isActivat=!0,this.$nextTick((()=>{this.draw()}))},methods:{draw(){var e=n.init(this.$refs.scEcharts,"T");e.setOption(this.myOptions),this.myChart=e,window.addEventListener("resize",(()=>e.resize()))}}},c=t(3744);const p=(0,c.Z)(m,[["render",o]]);var h=p,f={title:"实时收入",icon:"el-icon-data-line",description:"Echarts组件演示",components:{scEcharts:h},data(){return{loading:!0,option:{}}},created(){var e=this;setTimeout((function(){e.loading=!1}),500);var a={tooltip:{trigger:"axis"},xAxis:{boundaryGap:!1,type:"category",data:function(){var e=new Date,a=[],t=30;while(t--)a.unshift(e.toLocaleTimeString().replace(/^\D*/,"")),e=new Date(e-2e3);return a}()},yAxis:[{type:"value",name:"价格",splitLine:{show:!1}}],series:[{name:"收入",type:"line",symbol:"none",lineStyle:{width:1,color:"#409EFF"},areaStyle:{opacity:.1,color:"#79bbff"},data:function(){var e=[],a=30;while(a--)e.push(Math.round(0*Math.random()));return e}()}]};this.option=a},mounted(){var e=this;setInterval((function(){var a=e.option;a.series[0].data.shift(),a.series[0].data.push(Math.round(100*Math.random())),a.xAxis.data.shift(),a.xAxis.data.push((new Date).toLocaleTimeString().replace(/^\D*/,""))}),2100)}};const g=(0,c.Z)(f,[["render",i]]);var w=g},8259:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return p}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-02bc7e68"),e=e(),(0,l.Cn)(),e),o={class:"progress"},n={class:"percentage-value"},r=s((()=>(0,l._)("div",{class:"percentage-label"},"当前进度",-1)));function d(e,a,t,s,d,u){const m=(0,l.up)("el-progress"),c=(0,l.up)("el-card");return(0,l.wg)(),(0,l.j4)(c,{shadow:"hover",header:"进度环"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(m,{type:"dashboard",percentage:85.5,width:160},{default:(0,l.w5)((({percentage:e})=>[(0,l._)("div",n,(0,i.zw)(e)+"%",1),r])),_:1},8,["percentage"])])])),_:1})}var u={title:"进度环",icon:"el-icon-odometer",description:"进度环原子组件演示",data(){return{}}},m=t(3744);const c=(0,m.Z)(u,[["render",d],["__scopeId","data-v-02bc7e68"]]);var p=c},7568:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var l=t(6252),i=t(3577);const s={class:"time"};function o(e,a,t,o,n,r){const d=(0,l.up)("el-card");return(0,l.wg)(),(0,l.j4)(d,{shadow:"hover",header:"时钟",class:"item-background"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l._)("h2",null,(0,i.zw)(n.time),1),(0,l._)("p",null,(0,i.zw)(n.day),1)])])),_:1})}var n={title:"时钟",icon:"el-icon-clock",description:"演示部件效果",data(){return{time:"",day:""}},mounted(){this.showTime(),setInterval((()=>{this.showTime()}),1e3)},methods:{showTime(){this.time=this.$TOOL.dateFormat(new Date,"hh:mm:ss"),this.day=this.$TOOL.dateFormat(new Date,"yyyy年MM月dd日")}}},r=t(3744);const d=(0,r.Z)(n,[["render",o],["__scopeId","data-v-1e5a9c0b"]]);var u=d},4511:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(6252),i=t(3577);const s={style:{height:"210px","text-align":"center"}},o=(0,l._)("img",{src:"img/ver.svg",style:{height:"140px"}},null,-1),n={style:{"margin-top":"15px"}},r={style:{"margin-top":"5px"}},d={style:{"margin-top":"20px"}};function u(e,a,t,u,m,c){const p=(0,l.up)("el-button"),h=(0,l.up)("el-card");return(0,l.wg)(),(0,l.j4)(h,{shadow:"hover",header:"版本信息"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[o,(0,l._)("h2",n,"SCUI "+(0,i.zw)(e.$CONFIG.CORE_VER),1),(0,l._)("p",r,"最新版本 "+(0,i.zw)(m.ver),1)]),(0,l._)("div",d,[(0,l.Wm)(p,{type:"primary",plain:"",round:"",onClick:c.golog},{default:(0,l.w5)((()=>[(0,l.Uk)("更新日志")])),_:1},8,["onClick"]),(0,l.Wm)(p,{type:"primary",plain:"",round:"",onClick:c.gogit},{default:(0,l.w5)((()=>[(0,l.Uk)("gitee")])),_:1},8,["onClick"])])])),_:1})}var m={title:"版本信息",icon:"el-icon-monitor",description:"当前项目版本信息",data(){return{ver:"loading..."}},mounted(){this.getVer()},methods:{async getVer(){const e=await this.$API.demo.ver.get();this.ver=e.data},golog(){window.open("https://gitee.com/lolicode/scui/releases")},gogit(){window.open("https://gitee.com/lolicode/scui")}}},c=t(3744);const p=(0,c.Z)(m,[["render",u]]);var h=p},287:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return g}});var l=t(6252),i=t(3577);const s={class:"myMods"},o=["href"],n={href:"javascript:void(0)"},r={class:"setMods"},d={class:"setMods"};function u(e,a,t,u,m,c){const p=(0,l.up)("el-icon"),h=(0,l.up)("router-link"),f=(0,l.up)("el-icon-plus"),g=(0,l.up)("draggable"),w=(0,l.up)("el-button"),b=(0,l.up)("el-drawer");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("ul",s,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.myMods,(a=>((0,l.wg)(),(0,l.iD)("li",{key:a.path,style:(0,i.j5)({background:a.meta.color||"#909399"})},["link"==a.meta.type?((0,l.wg)(),(0,l.iD)("a",{key:0,href:a.path,target:"_blank"},[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.j4)((0,l.LL)(a.meta.icon||e.el-e.icon-e.menu)))])),_:2},1024),(0,l._)("p",null,(0,i.zw)(a.meta.title),1)],8,o)):((0,l.wg)(),(0,l.j4)(h,{key:1,to:{path:a.path}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.j4)((0,l.LL)(a.meta.icon||e.el-e.icon-e.menu)))])),_:2},1024),(0,l._)("p",null,(0,i.zw)(a.meta.title),1)])),_:2},1032,["to"]))],4)))),128)),(0,l._)("li",{class:"modItem-add",onClick:a[0]||(a[0]=(...e)=>c.addMods&&c.addMods(...e))},[(0,l._)("a",n,[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f)])),_:1})])])]),(0,l.Wm)(b,{title:"添加应用",modelValue:m.modsDrawer,"onUpdate:modelValue":a[4]||(a[4]=e=>m.modsDrawer=e),size:570,"destroy-on-close":""},{footer:(0,l.w5)((()=>[(0,l.Wm)(w,{onClick:a[3]||(a[3]=e=>m.modsDrawer=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(w,{type:"primary",onClick:c.saveMods},{default:(0,l.w5)((()=>[(0,l.Uk)("保存")])),_:1},8,["onClick"])])),default:(0,l.w5)((()=>[(0,l._)("div",r,[(0,l._)("h4",null,"我的常用 ( "+(0,i.zw)(m.myMods.length)+" )",1),(0,l.Wm)(g,{tag:"ul",modelValue:m.myMods,"onUpdate:modelValue":a[1]||(a[1]=e=>m.myMods=e),animation:"200","item-key":"path",group:"people"},{item:(0,l.w5)((({element:a})=>[(0,l._)("li",{style:(0,i.j5)({background:a.meta.color||"#909399"})},[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.j4)((0,l.LL)(a.meta.icon||e.el-e.icon-e.menu)))])),_:2},1024),(0,l._)("p",null,(0,i.zw)(a.meta.title),1)],4)])),_:1},8,["modelValue"])]),(0,l._)("div",d,[(0,l._)("h4",null,"全部应用 ( "+(0,i.zw)(m.filterMods.length)+" )",1),(0,l.Wm)(g,{tag:"ul",modelValue:m.filterMods,"onUpdate:modelValue":a[2]||(a[2]=e=>m.filterMods=e),animation:"200","item-key":"path",sort:!1,group:"people"},{item:(0,l.w5)((({element:a})=>[(0,l._)("li",{style:(0,i.j5)({background:a.meta.color||"#909399"})},[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.j4)((0,l.LL)(a.meta.icon||e.el-e.icon-e.menu)))])),_:2},1024),(0,l._)("p",null,(0,i.zw)(a.meta.title),1)],4)])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])])}t(7658);var m=t(9980),c=t.n(m),p={components:{draggable:c()},data(){return{mods:[],myMods:[],myModsName:[],filterMods:[],modsDrawer:!1}},mounted(){this.getMods()},methods:{addMods(){this.modsDrawer=!0},getMods(){this.myModsName=this.$TOOL.data.get("my-mods")||[];var e=this.$TOOL.data.get("MENU");this.filterMenu(e),this.myMods=this.mods.filter((e=>this.myModsName.includes(e.name))),this.filterMods=this.mods.filter((e=>!this.myModsName.includes(e.name)))},filterMenu(e){e.forEach((e=>{if(e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0?this.filterMenu(e.children):this.mods.push(e)}))},saveMods(){const e=this.myMods.map((e=>e.name));this.$TOOL.data.set("my-mods",e),this.$message.success("设置常用成功"),this.modsDrawer=!1}}},h=t(3744);const f=(0,h.Z)(p,[["render",u],["__scopeId","data-v-ddc038fc"]]);var g=f},9202:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var l=t(6252);const i=e=>((0,l.dD)("data-v-12d57090"),e=e(),(0,l.Cn)(),e),s=i((()=>(0,l._)("div",{class:"welcome"},[(0,l._)("div",{class:"logo"},[(0,l._)("h2",null,"武汉黄鹤调研管理平台")])],-1)));function o(e,a,t,i,o,n){const r=(0,l.up)("el-card");return(0,l.wg)(),(0,l.j4)(r,{shadow:"hover",header:"欢迎"},{default:(0,l.w5)((()=>[s])),_:1})}var n={title:"欢迎",icon:"el-icon-present",description:"项目特色以及文档链接",data(){return{}},methods:{godoc(){window.open("https://lolicode.gitee.io/scui-doc/")}}},r=t(3744);const d=(0,r.Z)(n,[["render",o],["__scopeId","data-v-12d57090"]]);var u=d},6379:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return w}});var l=t(6252),i=t(3577);const s={class:"common-header-left"},o={class:"common-header-logo"},n=["alt"],r={class:"common-header-title"},d={class:"common-header-right"},u={class:"common-container"},m={class:"common-title"},c={class:"common-main el-card"};function p(e,a,t,p,h,f){const g=(0,l.up)("router-link"),w=(0,l.up)("el-header"),b=(0,l.up)("el-main"),y=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(w,{style:{height:"50px"}},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l._)("div",o,[(0,l._)("img",{alt:e.$CONFIG.APP_NAME,src:"img/logo.png"},null,8,n),(0,l._)("label",null,(0,i.zw)(e.$CONFIG.APP_NAME),1)]),(0,l._)("div",r,(0,i.zw)(t.title),1)]),(0,l._)("div",d,[(0,l.Wm)(g,{to:"/login"},{default:(0,l.w5)((()=>[(0,l.Uk)("返回登录")])),_:1})])])),_:1}),(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l._)("div",u,[(0,l._)("h2",m,(0,i.zw)(t.title),1),(0,l._)("div",c,[(0,l.WI)(e.$slots,"default")])])])),_:3})])),_:3})}var h={props:{title:{type:String,default:""}}},f=t(3744);const g=(0,f.Z)(h,[["render",p]]);var w=g},1071:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var l=t(6252),i=t(9963),s=t(3577);function o(e,a,t,o,n,r){const d=(0,l.up)("el-input"),u=(0,l.up)("el-form-item"),m=(0,l.up)("el-checkbox"),c=(0,l.up)("el-col"),p=(0,l.up)("el-button"),h=(0,l.up)("el-form");return(0,l.wg)(),(0,l.j4)(h,{ref:"loginForm",model:n.form,rules:n.rules,"label-width":"0",size:"large",onKeyup:(0,i.D2)(r.login,["enter"])},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{prop:"user"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:n.form.user,"onUpdate:modelValue":a[0]||(a[0]=e=>n.form.user=e),"prefix-icon":"el-icon-user",clearable:"",placeholder:e.$t("login.userPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),(0,l.Wm)(u,{prop:"password"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:n.form.password,"onUpdate:modelValue":a[1]||(a[1]=e=>n.form.password=e),"prefix-icon":"el-icon-lock",clearable:"","show-password":"",placeholder:e.$t("login.PWPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),(0,l.Wm)(u,{style:{"margin-bottom":"10px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:e.$t("login.rememberMe"),modelValue:n.form.autologin,"onUpdate:modelValue":a[2]||(a[2]=e=>n.form.autologin=e)},null,8,["label","modelValue"])])),_:1}),(0,l.Wm)(c,{span:12,class:"login-forgot"})])),_:1}),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{type:"primary",style:{width:"100%"},loading:n.islogin,round:"",onClick:r.login},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("login.signIn")),1)])),_:1},8,["loading","onClick"])])),_:1})])),_:1},8,["model","rules","onKeyup"])}var n={data(){return{form:{user:"",password:"",autologin:!1},rules:{user:[{required:!0,message:this.$t("login.userError"),trigger:"blur"}],password:[{required:!0,message:this.$t("login.PWError"),trigger:"blur"}]},islogin:!1}},watch:{},mounted(){},methods:{async login(){var e=await this.$refs.loginForm.validate().catch((()=>{}));if(!e)return!1;this.islogin=!0;var a={account:this.form.user,passWord:this.form.password},t=await this.$API.auth.token.post(a);return 200!=t.code?(this.islogin=!1,this.$message.warning(t.message),!1):"3"===t.data.userInfo.role?(this.islogin=!1,this.$alert("当前用户无任何菜单权限，请联系系统管理员","无权限访问",{type:"error",center:!0}),!1):(this.$TOOL.cookie.set("TOKEN",t.data.token,{expires:this.form.autologin?86400:0}),this.$TOOL.data.set("USER_INFO",t.data.userInfo),this.$store.state.user.USER_INFO=t.data.userInfo,this.$TOOL.data.set("PERMISSIONS",[t.data.userInfo.role]),this.$router.replace({path:"/"}),this.$message.success("Login Success 登录成功"),void(this.islogin=!1))}}},r=t(3744);const d=(0,r.Z)(n,[["render",o]]);var u=d},527:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return p}});var l=t(6252),i=t(9963),s=t(3577);const o={class:"login-msg-yzm"},n={key:0},r={class:"login-reg"};function d(e,a,t,d,u,m){const c=(0,l.up)("el-input"),p=(0,l.up)("el-form-item"),h=(0,l.up)("el-button"),f=(0,l.up)("router-link"),g=(0,l.up)("el-form");return(0,l.wg)(),(0,l.j4)(g,{ref:"loginForm",model:u.form,rules:u.rules,"label-width":"0",size:"large",onKeyup:(0,i.D2)(m.login,["enter"])},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{prop:"phone"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{modelValue:u.form.phone,"onUpdate:modelValue":a[0]||(a[0]=e=>u.form.phone=e),"prefix-icon":"el-icon-iphone",clearable:"",placeholder:e.$t("login.mobilePlaceholder")},{prepend:(0,l.w5)((()=>[(0,l.Uk)("+86")])),_:1},8,["modelValue","placeholder"])])),_:1}),(0,l.Wm)(p,{prop:"yzm",style:{"margin-bottom":"35px"}},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(c,{modelValue:u.form.yzm,"onUpdate:modelValue":a[1]||(a[1]=e=>u.form.yzm=e),"prefix-icon":"el-icon-unlock",clearable:"",placeholder:e.$t("login.smsPlaceholder")},null,8,["modelValue","placeholder"]),(0,l.Wm)(h,{onClick:m.getYzm,disabled:u.disabled},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(this.$t("login.smsGet")),1),u.disabled?((0,l.wg)(),(0,l.iD)("span",n," ("+(0,s.zw)(u.time)+")",1)):(0,l.kq)("",!0)])),_:1},8,["onClick","disabled"])])])),_:1}),(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(h,{type:"primary",style:{width:"100%"},loading:u.islogin,round:"",onClick:m.login},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("login.signIn")),1)])),_:1},8,["loading","onClick"])])),_:1}),(0,l._)("div",r,[(0,l.Uk)((0,s.zw)(e.$t("login.noAccount"))+" ",1),(0,l.Wm)(f,{to:"/user_register"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("login.createAccount")),1)])),_:1})])])),_:1},8,["model","rules","onKeyup"])}var u={data(){return{form:{phone:"",yzm:""},rules:{phone:[{required:!0,message:this.$t("login.mobileError")}],yzm:[{required:!0,message:this.$t("login.smsError")}]},disabled:!1,time:0,islogin:!1}},mounted(){},methods:{async getYzm(){var e=await this.$refs.loginForm.validateField("phone").catch((()=>{}));if(!e)return!1;this.$message.success(this.$t("login.smsSent")),this.disabled=!0,this.time=60;var a=setInterval((()=>{this.time-=1,this.time<1&&(clearInterval(a),this.disabled=!1,this.time=0)}),1e3)},async login(){var e=await this.$refs.loginForm.validate().catch((()=>{}));if(!e)return!1}}},m=t(3744);const c=(0,m.Z)(u,[["render",d]]);var p=c},7621:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(6252);const i=e=>((0,l.dD)("data-v-6e4ecddb"),e=e(),(0,l.Cn)(),e),s={class:"left-panel"},o={class:"right-panel"},n={class:"right-panel-search",style:{margin:"5px 0"}},r=i((()=>(0,l._)("div",null,[(0,l._)("p",{class:"complaint-top"},[(0,l._)("span",{class:"orange"}),(0,l.Uk)("该项申诉调研公司未处理 "),(0,l._)("span",{class:"red"}),(0,l.Uk)("该项申诉调研公司已驳回 "),(0,l._)("span",{class:"deepSkyBlue"}),(0,l.Uk)("代表-该项申诉区局（市场部、营销部）超时未处理 "),(0,l._)("span",{class:"green"}),(0,l.Uk)("该项申诉调研公司已通过 "),(0,l._)("span",{class:"blue"}),(0,l.Uk)("该项申诉被调研公司修改 "),(0,l._)("span",{class:"gainsboro"}),(0,l.Uk)("代表-该项申诉已被区局（市场部、营销部）驳回")])],-1)));function d(e,a,t,i,d,u){const m=(0,l.up)("el-input"),c=(0,l.up)("el-form-item"),p=(0,l.up)("el-col"),h=(0,l.up)("el-option"),f=(0,l.up)("el-select"),g=(0,l.up)("el-row"),w=(0,l.up)("el-button"),b=(0,l.up)("el-header"),y=(0,l.up)("el-table-column"),_=(0,l.up)("el-switch"),v=(0,l.up)("scTable"),k=(0,l.up)("el-main"),W=(0,l.up)("el-container"),I=(0,l.up)("user-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(g,{gutter:20,style:{width:"80%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{xs:24,sm:24,md:7,lg:7,xl:7},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"店铺名称:"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:d.queryInfo.paramData.surveyUserName,"onUpdate:modelValue":a[0]||(a[0]=e=>d.queryInfo.paramData.surveyUserName=e),placeholder:"请输入店铺名称"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:7,lg:7,xl:7},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:d.queryInfo.paramData.surveyUserPhone,"onUpdate:modelValue":a[1]||(a[1]=e=>d.queryInfo.paramData.surveyUserPhone=e),placeholder:"请输入客户经理名称"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:9,lg:9,xl:9},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"分数筛选:"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入最高分数",modelValue:d.queryInfo.paramData.surveyUserPhone,"onUpdate:modelValue":a[2]||(a[2]=e=>d.queryInfo.paramData.surveyUserPhone=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{class:"line",span:2},{default:(0,l.w5)((()=>[(0,l.Uk)("-")])),_:1}),(0,l.Wm)(p,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入最低分数",modelValue:d.queryInfo.paramData.surveyUserPhone,"onUpdate:modelValue":a[3]||(a[3]=e=>d.queryInfo.paramData.surveyUserPhone=e),style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:7,lg:7,xl:7},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"所属营销部:"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:d.queryInfo.paramData.surveyUserName,"onUpdate:modelValue":a[4]||(a[4]=e=>d.queryInfo.paramData.surveyUserName=e),placeholder:"请输入营销部"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:7,lg:7,xl:7},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:d.queryInfo.paramData.surveyUserPhone,"onUpdate:modelValue":a[5]||(a[5]=e=>d.queryInfo.paramData.surveyUserPhone=e),placeholder:"请输入市场部"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:7,lg:7,xl:7},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"标记项筛选:"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:d.value,"onUpdate:modelValue":a[6]||(a[6]=e=>d.value=e),placeholder:"请选择标记状态"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.options,(e=>((0,l.wg)(),(0,l.j4)(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:7,lg:7,xl:7},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"数据范围:"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:d.queryInfo.paramData.surveyUserName,"onUpdate:modelValue":a[7]||(a[7]=e=>d.queryInfo.paramData.surveyUserName=e),placeholder:"请输入数据范围"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:7,lg:7,xl:7},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:d.queryInfo.paramData.surveyUserPhone,"onUpdate:modelValue":a[8]||(a[8]=e=>d.queryInfo.paramData.surveyUserPhone=e),placeholder:"请输入专卖许可证号"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})]),(0,l._)("div",o,[(0,l._)("div",n,[(0,l.Wm)(w,{type:"default",onClick:a[9]||(a[9]=e=>u.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(w,{type:"primary",onClick:a[10]||(a[10]=e=>u.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),r,(0,l.Wm)(k,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{ref:"table",data:d.tableData,height:"520px",staticTotal:d.total,onPaginationChange:u.paginationChange,onPageSizeChange:u.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:u.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"客户经理",prop:"surveyUserName","min-width":"200",align:"center"}),(0,l.Wm)(y,{label:"店铺名称",prop:"surveyUserPhone","min-width":"200",align:"center"}),(0,l.Wm)(y,{label:"专卖许可证号",prop:"surveyUserAccount","min-width":"200",align:"center"}),(0,l.Wm)(y,{label:"所属营销部",prop:"surveysCount","min-width":"200",align:"center"}),(0,l.Wm)(y,{label:"添加人",prop:"createUserAccount","min-width":"200",align:"center"}),(0,l.Wm)(y,{label:"添加时间",prop:"createTime","min-width":"200",align:"center"}),(0,l.Wm)(y,{label:"参与权",prop:"disable","min-width":"100",align:"center",fixed:"right"},{default:(0,l.w5)((e=>[(0,l.Wm)(_,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,"inline-prompt":"","active-text":"启用","inactive-text":"禁用",onChange:a=>u.disableUser(a,e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),d.dialog.save?((0,l.wg)(),(0,l.j4)(I,{key:0,ref:"userDialog",onClosed:a[11]||(a[11]=e=>d.dialog.save=!1),onSuccess:u.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var u=t(5488),m={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{userDialog:u["default"]},data(){return{dialog:{save:!1},tableData:[],total:0,queryInfo:{current:1,paramData:{marketScorePlanId:"",surveyUserName:"",surveyUserPhone:"",status:""},size:10},options:[{value:"选项1",label:"全部"},{value:"选项2",label:"有标记"},{value:"选项3",label:"无标记"}],value:"",statusList:[{label:"正常",value:1},{label:"禁用",value:2},{label:"已删除",value:3}]}},watch:{},mounted(){},methods:{initData(){this.queryInfo={current:1,paramData:{marketScorePlanId:this.marketScorePlanId,surveyUserName:"",surveyUserPhone:"",status:""},size:10},this.getDataList()},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.userDialog.open(this.marketScorePlanId)}))},filterType(e,a){return a.find((a=>a.value===e))?.label||"-"},changeData(e){this.queryInfo.paramData.status=e},async disableUser(e,a){this.$confirm(`确定${2===e?"禁用":"启用"}${a.surveyUserName}吗？`,"提示",{type:"warning"}).then((async()=>{const t=this.$loading();let l=await this.$API.researchInfo.ResearchCompany.UpdatePlanUserStatus.put(a.id,{status:e});200===l.code?(this.$message.success("操作成功"),this.getDataList()):this.$message.error(l.message),t.close()})).catch((()=>{this.$message.info("用户取消禁用"),a.status=2===e?1:2}))},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetJoinUserList.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo.paramData.surveyUserName="",this.queryInfo.paramData.surveyUserPhone="",this.queryInfo.paramData.status=""),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},c=t(3744);const p=(0,c.Z)(m,[["render",d],["__scopeId","data-v-6e4ecddb"]]);var h=p},2633:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var l=t(6252);const i={class:"left-panel"},s={class:"right-panel"},o={class:"right-panel-search",style:{margin:"5px 0"}};function n(e,a,t,n,r,d){const u=(0,l.up)("el-input"),m=(0,l.up)("el-form-item"),c=(0,l.up)("el-col"),p=(0,l.up)("el-row"),h=(0,l.up)("el-form"),f=(0,l.up)("el-button"),g=(0,l.up)("el-header"),w=(0,l.up)("el-table-column"),b=(0,l.up)("el-button-group"),y=(0,l.up)("scTable"),_=(0,l.up)("el-main"),v=(0,l.up)("el-container"),k=(0,l.up)("storeDialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(h,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{gutter:20,style:{width:"90%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:6,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>r.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:6,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[1]||(a[1]=e=>r.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:5,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"分数筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.startScore,"onUpdate:modelValue":a[2]||(a[2]=e=>r.queryInfo.paramData.startScore=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:5,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"~"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.endScore,"onUpdate:modelValue":a[3]||(a[3]=e=>r.queryInfo.paramData.endScore=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:7,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"处理状态："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.auditStatus,"onUpdate:modelValue":a[4]||(a[4]=e=>r.queryInfo.paramData.auditStatus=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:7,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"所属区营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[5]||(a[5]=e=>r.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:7,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"所属区市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[6]||(a[6]=e=>r.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:7,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[7]||(a[7]=e=>r.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",s,[(0,l._)("div",o,[(0,l.Wm)(f,{type:"default",onClick:a[8]||(a[8]=e=>d.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(f,{type:"primary",onClick:a[9]||(a[9]=e=>d.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(_,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{ref:"table",data:r.tableData,height:"520px",staticTotal:r.total,onPaginationChange:d.paginationChange,onPageSizeChange:d.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:d.getTableData},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{label:"客户经理",prop:"accountManagerName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"所属市场部",prop:"organizationName","min-width":"150",align:"center"}),(0,l.Wm)(w,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),(0,l.Wm)(w,{label:"申诉项",prop:"appealCount","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"已处理",prop:"processedCount","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"处理状态",prop:"auditStatus","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{text:"",type:"primary",size:"small",onClick:a=>d.viewPointTable(e.row.auditId)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"]),(0,l.Wm)(f,{text:"",type:"primary",size:"small",onClick:a=>d.table_del(e.row,e.$index)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),r.dialog.save?((0,l.wg)(),(0,l.j4)(k,{key:0,ref:"storeDialog",onClosed:a[10]||(a[10]=e=>r.dialog.save=!1),onSuccess:d.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}t(7658);var r=t(6690),d={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{storeDialog:r["default"]},data(){return{dialog:{save:!1},tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{accountManagerName:"",auditStatus:"",auditUserType:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",sysMarkScorePlanId:this.marketScorePlanId},size:10}}},watch:{},mounted(){this.getTableData()},methods:{initData(){this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:2,sysMarkScorePlanId:this.marketScorePlanId},size:10},this.getTableData(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/pointTable/index",query:{auditId:e}})},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.storeDialog.open(this.marketScorePlanId)}))},async table_del(e){this.$confirm("是否删除当前打分记录？","删除提示",{type:"warning"}).then((async()=>{let a=await this.$API.researchInfo.ResearchCompany.DeletePlanSheet.delete(e.id);200==a.code?(this.getTableData(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},paginationChange(e){this.queryInfo.current=e,this.getTableData()},pageSizeChange(e){this.queryInfo.size=e,this.getTableData()},async getTableData(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.CityMarketOffice.GetAuditList.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:2,sysMarkScorePlanId:this.marketScorePlanId},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getTableData()},handleSuccess(){this.getTableData()}}},u=t(3744);const m=(0,u.Z)(d,[["render",n],["__scopeId","data-v-2c1fdf4e"]]);var c=m},1089:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return w}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-3e3a044c"),e=e(),(0,l.Cn)(),e),o={class:"left-panel"},n={class:"right-panel"},r={class:"right-panel-search",style:{margin:"5px 0"}},d={class:"left-panel"},u=s((()=>(0,l._)("div",{class:"right-panel"},null,-1)));function m(e,a,t,s,m,c){const p=(0,l.up)("el-input"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-col"),g=(0,l.up)("el-option"),w=(0,l.up)("el-select"),b=(0,l.up)("el-row"),y=(0,l.up)("el-form"),_=(0,l.up)("el-button"),v=(0,l.up)("el-header"),k=(0,l.up)("el-table-column"),W=(0,l.up)("el-tag"),I=(0,l.up)("el-popconfirm"),S=(0,l.up)("el-button-group"),D=(0,l.up)("scTable"),C=(0,l.up)("el-main"),U=(0,l.up)("el-container"),V=(0,l.up)("storeDialog"),q=(0,l.up)("upload-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(y,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{gutter:20,style:{width:"70%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>m.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>m.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"调研状态："},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{style:{width:"100%"},modelValue:m.queryInfo.paramData.status,"onUpdate:modelValue":a[2]||(a[2]=e=>m.queryInfo.paramData.status=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{label:"全部",value:""}),(0,l.Wm)(g,{label:"未打分",value:1}),(0,l.Wm)(g,{label:"已完成",value:2})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[3]||(a[3]=e=>m.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[4]||(a[4]=e=>m.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.customerName,"onUpdate:modelValue":a[5]||(a[5]=e=>m.queryInfo.paramData.customerName=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",n,[(0,l._)("div",r,[(0,l.Wm)(_,{type:"default",onClick:a[6]||(a[6]=e=>c.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(_,{type:"primary",onClick:a[7]||(a[7]=e=>c.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l.Wm)(_,{type:"primary",size:"default",onClick:c.add},{default:(0,l.w5)((()=>[(0,l.Uk)(" 添加店铺 ")])),_:1},8,["onClick"]),(0,l.Wm)(_,{type:"primary",size:"default",onClick:c.uploadImport},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量导入 ")])),_:1},8,["onClick"]),(0,l.Wm)(_,{type:"primary",disabled:0===m.selection.length,size:"default",onClick:c.batch_del},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量删除 ")])),_:1},8,["disabled","onClick"])]),u])),_:1}),(0,l.Wm)(C,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{ref:"table",data:m.tableData,height:"520px",staticTotal:m.total,onPaginationChange:c.paginationChange,onSelectionChange:c.selectionChange,onPageSizeChange:c.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:c.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{type:"selection","min-width":"50"}),(0,l.Wm)(k,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"150",align:"center"}),(0,l.Wm)(k,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"调研状态",prop:"status","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(W,{type:c.filterStatus(e.row.status)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(c.filterType(e.row.status,m.statusList)),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(k,{label:"店铺状态",prop:"businessStatus","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,i.zw)(c.filterType(e.row.businessStatus,m.businessStatusList)),1)])),_:1}),(0,l.Wm)(k,{label:"添加时间",prop:"createTime","min-width":"150",align:"center"}),(0,l.Wm)(k,{label:"操作",fixed:"right",align:"center","min-width":"100"},{default:(0,l.w5)((e=>[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(I,{title:"确定删除吗？",onConfirm:a=>c.table_del(e.row,e.$index)},{reference:(0,l.w5)((()=>[(0,l.Wm)(_,{text:"",type:"primary",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onSelectionChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),m.dialog.save?((0,l.wg)(),(0,l.j4)(V,{key:0,ref:"storeDialog",onClosed:a[8]||(a[8]=e=>m.dialog.save=!1),onSuccess:c.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0),m.dialog.upload?((0,l.wg)(),(0,l.j4)(q,{key:1,ref:"uploadDialog",onSuccess:c.handleSuccess,onClosed:a[9]||(a[9]=e=>m.dialog.upload=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var c=t(6690),p=t(1069),h={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{storeDialog:c["default"],uploadDialog:p["default"]},data(){return{dialog:{save:!1,upload:!1},tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{businessShopName:"",customerName:"",customerPhone:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10},statusList:[{label:"未打分",value:1},{label:"已完成",value:2}],businessStatusList:[{label:"禁用",value:0},{label:"启用",value:1}]}},watch:{},mounted(){},methods:{uploadImport(){this.dialog.upload=!0,this.$nextTick((()=>{this.$refs.uploadDialog.open()}))},initData(){this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10},this.getDataList()},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.storeDialog.open(this.marketScorePlanId)}))},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break}return a},filterType(e,a){return a.find((a=>a.value===e))?.label||"-"},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},selectionChange(e){this.selection=e},async table_del(e){this.$confirm("是否删除当前店铺？删除后该店铺会退出当前计划，本次计划相关打分记录将会同步删除；","删除提示",{type:"warning"}).then((async()=>{let a=await this.$API.researchInfo.ResearchCompany.DeletePlanBusiness.delete(e.id);200==a.code?(this.getDataList(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},async batch_del(){this.$confirm(`确定删除选中的 ${this.selection.length} 项吗？删除后 ${this.selection.length} 家店铺会退出当前计划，本次计划相关打分记录将会同步删除；`,"提示",{type:"warning"}).then((async()=>{const e=this.$loading();let a=await this.$API.researchInfo.ResearchCompany.BatchDeletePlanBusiness.delete(this.selection.map((e=>e.id)));200===a.code?(this.getDataList(),e.close(),this.$message.success("操作成功")):e.close()})).catch((e=>{console.log(e)}))},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanBusiness.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},f=t(3744);const g=(0,f.Z)(h,[["render",m],["__scopeId","data-v-3e3a044c"]]);var w=g},6690:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-input"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-form"),u=(0,l.up)("el-button"),m=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(m,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>s.visible=e),width:500,"destroy-on-close":"",onClosed:a[4]||(a[4]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(u,{onClick:a[2]||(a[2]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(u,{type:"primary",loading:s.isSaveing,onClick:o.submit},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading","onClick"])])),default:(0,l.w5)((()=>[(0,l.Wm)(d,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"120px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"店铺名称",prop:"businessShopName"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.businessShopName=e),placeholder:"请输入店铺名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"专卖许可证号",prop:"retailLicenseNumber"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.retailLicenseNumber=e),placeholder:"请输入专卖许可证号",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"添加店铺"},visible:!1,isSaveing:!1,form:{sysMarkScorePlanId:"",businessShopName:"",retailLicenseNumber:""},rules:{businessShopName:[{required:!0,message:"请输入店铺名称"}],retailLicenseNumber:[{required:!0,message:"请输入专卖许可证号"}]}}},methods:{open(e){return this.form.sysMarkScorePlanId=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.AddPlanBusiness.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},setData(e){Object.assign(this.form,e)}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-17820a01"]]);var r=n},1069:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-f0293d24"),e=e(),(0,l.Cn)(),e),o=s((()=>(0,l._)("div",{class:"ball"},"1",-1))),n=s((()=>(0,l._)("div",{class:"text"},"上传文件",-1))),r=s((()=>(0,l._)("div",{class:"ball"},"2",-1))),d=s((()=>(0,l._)("div",{class:"text"},"确认结果",-1))),u={key:0,class:"center"},m=s((()=>(0,l._)("div",{class:"el-upload__text"}," 点击或将文件拖拽到这里上传 ",-1))),c={key:1,class:"center"},p={class:"successText"},h={class:"errText"},f={key:0},g={key:1};function w(e,a,t,s,w,b){const y=(0,l.up)("el-col"),_=(0,l.up)("el-row"),v=(0,l.up)("el-icon-message-box"),k=(0,l.up)("el-icon"),W=(0,l.up)("sc-upload-file"),I=(0,l.up)("el-form-item"),S=(0,l.up)("el-form"),D=(0,l.up)("el-button"),C=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(C,{title:w.titleMap[w.mode],modelValue:w.visible,"onUpdate:modelValue":a[7]||(a[7]=e=>w.visible=e),width:700,"destroy-on-close":"",onClosed:a[8]||(a[8]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[1===w.active?((0,l.wg)(),(0,l.iD)("div",f,[(0,l.Wm)(D,{onClick:a[3]||(a[3]=e=>w.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(D,{type:"primary",disabled:!b.uploadStatus,onClick:a[4]||(a[4]=e=>b.changePage(2))},{default:(0,l.w5)((()=>[(0,l.Uk)("下一步")])),_:1},8,["disabled"])])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",g,[(0,l.Wm)(D,{onClick:a[5]||(a[5]=e=>b.changePage(1))},{default:(0,l.w5)((()=>[(0,l.Uk)("上一步")])),_:1}),(0,l.Wm)(D,{type:"primary",loading:w.isSaveing,onClick:a[6]||(a[6]=e=>b.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交结果")])),_:1},8,["loading"])])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:18,offset:3},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{style:{"margin-bottom":"24px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>0?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[o,n])),_:1},8,["style"]),(0,l.Wm)(y,{span:12,class:"line"}),(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>1?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[r,d])),_:1},8,["style"])])),_:1}),1===w.active?((0,l.wg)(),(0,l.iD)("div",u,[(0,l.Wm)(S,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"上传文件：",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:(0,i.C_)({disUoloadSty:b.uploadStatus}),id:w.id,tip:"支持拓展名: .xls .xlsx",accept:".xls,.xlsx",modelValue:w.file,"onUpdate:modelValue":a[0]||(a[0]=e=>w.file=e),apiObj:w.apiObj,limit:1,drag:"",onRemove:b.onRemove,onSuccess:b.uploadSuccess},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{class:"el-icon--upload",style:{color:"rgb(24, 144, 255)"}},{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}),m])),_:1},8,["class","id","modelValue","apiObj","onRemove","onSuccess"])])),_:1})])),_:1}),(0,l.Wm)(S,{"label-position":"right"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"模板文件："},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量上传模版.xls "),(0,l._)("div",{class:"downLoad",onClick:a[1]||(a[1]=(...e)=>b.downLoadTemplate&&b.downLoadTemplate(...e))},"下载")])),_:1})])),_:1})])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(S,{"label-width":"150px"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:14,offset:5},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"可导入店铺数:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(w.uploadInfo.sureAddBusinessCount),1)])),_:1}),(0,l.Wm)(I,{label:"无法导入数:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,[(0,l.Uk)((0,i.zw)(w.uploadInfo.failAddBusinessCount)+" ",1),w.uploadInfo.failAddBusinessCount?((0,l.wg)(),(0,l.iD)("div",{key:0,class:"downLoad",onClick:a[2]||(a[2]=(...e)=>b.downLoadErr&&b.downLoadErr(...e))},"下载失败信息")):(0,l.kq)("",!0)])])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["title","modelValue"])}var b={emits:["success","closed"],props:{marketList:{type:Array,default:()=>[]},businessList:{type:Array,default:()=>[]}},data(){return{id:this.$route.query.id,apiObj:this.$API.researchInfo.ResearchCompany.UploadImport,active:1,mode:"import",titleMap:{import:"批量添加店铺"},visible:!1,isSaveing:!1,file:[],uploadInfo:{fileName:"",importId:"",sureAddBusinessCount:0,failAddBusinessCount:0}}},mounted(){},computed:{uploadStatus({file:e}){return e.length>0}},methods:{open(e="import"){return this.mode=e,this.visible=!0,this},changePage(e){this.active=e},onRemove(){return this.uploadInfo={fileName:"",importId:"",sureAddBusinessCount:0,failAddBusinessCount:0},this.file=[],!0},uploadSuccess(e){const{fileName:a,importId:t}=e.data;return this.uploadInfo=e.data,this.file=[{name:a,url:t}],!1},async submit(){let e=await this.$API.researchInfo.ResearchCompany.ImportBusiness.get(this.id,{importId:this.uploadInfo.importId});200==e.code?(this.$emit("success",{},"import"),this.visible=!1,this.$message.success("导入成功")):this.$alert(e.message,"提示",{type:"error"})},async setData(e){Object.assign(this.form,e)},async downLoadTemplate(){let e=await this.$API.researchInfo.ResearchCompany.DownloadImportTemplate.get();const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","批量上传模版.xlsx"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},async downLoadErr(){let e=await this.$API.researchInfo.ResearchCompany.DownloadImportRES.get(this.uploadInfo.importId);const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","失败信息.xlsx"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}},y=t(3744);const _=(0,y.Z)(b,[["render",w],["__scopeId","data-v-f0293d24"]]);var v=_},5488:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-transfer"),r=(0,l.up)("el-button"),d=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(d,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>s.visible=e),width:605,"destroy-on-close":"",onClosed:a[4]||(a[4]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(r,{onClick:a[1]||(a[1]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(r,{type:"primary",loading:s.isSaveing,onClick:a[2]||(a[2]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(n,{modelValue:s.joinList,"onUpdate:modelValue":a[0]||(a[0]=e=>s.joinList=e),data:s.list,props:{key:"id",label:"name"}},null,8,["modelValue","data"])])])),_:1},8,["title","modelValue"])}t(7658);var s={emits:["success","closed"],data(){return{id:"",mode:"add",titleMap:{add:"选择参与人员",edit:"编辑店铺"},visible:!1,isSaveing:!1,loading:!1,list:[],joinList:[]}},mounted(){},methods:{open(e){return this.id=e,this.visible=!0,this.getDataList(),this},async submit(){this.isSaveing=!0;let e=[];this.joinList.forEach((a=>{let t={...this.list.find((e=>e.id===a)),sysMarkScorePlanId:this.id};e.push(t)}));var a=await this.$API.researchInfo.ResearchCompany.BatchAddJoinUser.post(e.map((e=>{let a={surveyUserAccount:e.account,surveyUserDisable:e.disable,surveyUserId:e.id,surveyUserName:e.name,surveyUserPhone:e.phone,sysMarkScorePlanId:e.sysMarkScorePlanId};return a})));this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})},async getDataList(){let e=await this.$API.researchInfo.ResearchCompany.GetUserCList.get(),a=await this.$API.researchInfo.ResearchCompany.GetJoinUserListNo.post({marketScorePlanId:this.id});this.list=e.data.filter((e=>-1===a.data.findIndex((a=>a.surveyUserId===e.id))))},filterMethod(e,a){return a.name.toLowerCase().includes(e.toLowerCase())},async setData(e){Object.assign(this.form,e)}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-6f9f14ef"]]);var r=n},1803:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-input"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-option"),u=(0,l.up)("el-select"),m=(0,l.up)("el-col"),c=(0,l.up)("el-row"),p=(0,l.up)("el-date-picker"),h=(0,l.up)("el-radio"),f=(0,l.up)("el-radio-group"),g=(0,l.up)("el-form"),w=(0,l.up)("el-button"),b=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(b,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[13]||(a[13]=e=>s.visible=e),width:700,"destroy-on-close":"",onClosed:a[14]||(a[14]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(w,{onClick:a[10]||(a[10]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),["add"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(w,{key:0,type:"primary",loading:s.isSaveing,onClick:a[11]||(a[11]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0),["edit"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(w,{key:1,type:"primary",loading:s.isSaveing,onClick:a[12]||(a[12]=e=>o.editData())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(g,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"140px"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"计划名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.name=e),placeholder:"请输入计划名称",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1}),(0,l.Wm)(r,{label:"选择评分表",prop:"sysAppraiseSheetNo"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},modelValue:s.form.sysAppraiseSheetNo,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.sysAppraiseSheetNo=e),onChange:o.change,filterable:"",remote:"",clearable:"","reserve-keyword":"",placeholder:"请输入关键词",loading:s.loading,disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.sysAppraiseList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.name,value:e.no},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange","loading","disabled"])])),_:1}),(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"回收目标数",prop:"recoveryTargetCount"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.recoveryTargetCount,"onUpdate:modelValue":a[2]||(a[2]=e=>s.form.recoveryTargetCount=e),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"请输入回收目标数",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"回收阀数值",prop:"recoveryDoorsillCount"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.recoveryDoorsillCount,"onUpdate:modelValue":a[3]||(a[3]=e=>s.form.recoveryDoorsillCount=e),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"请输入回收阀值",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"调研对象",prop:"researchObjectType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.researchObjectType,"onUpdate:modelValue":a[4]||(a[4]=e=>s.form.researchObjectType=e),filterable:"",placeholder:"请选择调研对象",disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.researchObjectList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"所属部门",prop:"deptType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.deptType,"onUpdate:modelValue":a[5]||(a[5]=e=>s.form.deptType=e),filterable:"",placeholder:"请选择所属部门",disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.deptList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"调研周期",prop:"researchPeriodType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.researchPeriodType,"onUpdate:modelValue":a[6]||(a[6]=e=>s.form.researchPeriodType=e),filterable:"",placeholder:"请选择调研周期",disabled:[4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.researchPeriodList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,{label:"调研起止时间",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{style:{width:"100% !important"},gutter:10},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"startTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{style:{width:"100%"},modelValue:s.form.startTime,"onUpdate:modelValue":a[7]||(a[7]=e=>s.form.startTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"开始时间",disabled:[2,3,4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"endTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{style:{width:"100%"},modelValue:s.form.endTime,"onUpdate:modelValue":a[8]||(a[8]=e=>s.form.endTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"结束时间",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,{label:"是否开启店铺限制",prop:"businessShopType"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:s.form.businessShopType,"onUpdate:modelValue":a[9]||(a[9]=e=>s.form.businessShopType=e),disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:2},{default:(0,l.w5)((()=>[(0,l.Uk)("是")])),_:1}),(0,l.Wm)(h,{label:1},{default:(0,l.w5)((()=>[(0,l.Uk)("否")])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s=t(2787),o={emits:["success","closed"],props:{deptList:{type:Array,default:()=>[]},researchObjectList:{type:Array,default:()=>[]},researchPeriodList:{type:Array,default:()=>[]}},data(){return{mode:"add",titleMap:{add:"新建打分计划",edit:"编辑店铺"},visible:!1,isSaveing:!1,apiObj:this.$API.researchInfo.ResearchCompany.GetAppraiseSheetList,form:{name:"",sysAppraiseSheetName:"",sysAppraiseSheetNo:"",recoveryTargetCount:"",recoveryDoorsillCount:"",researchObjectType:"",deptType:"",researchPeriodType:"",startTime:"",endTime:"",businessShopType:""},rules:{name:[{required:!0,message:"请输入店铺名称"}],sysAppraiseSheetNo:[{required:!0,message:"请选择评分表"}],recoveryTargetCount:[{required:!0,message:"请输入回收目标数"},{validator:s.C$,trigger:["change","blur"]}],recoveryDoorsillCount:[{required:!0,message:"请输入回收阀值"},{validator:s.C$,trigger:["change","blur"]},{validator:(e,a,t)=>{"add"===this.mode?a>=this.form.recoveryTargetCount?t():t(new Error("回收阀值不得低于回收目标数")):"edit"===this.mode&&(a<this.form.recoveryTargetCount?t(new Error("回收阀值不得低于回收目标数")):a<this.form.completeCount?t(new Error("回收阀值不得低于当前已收集数")):t())},trigger:["change","blur"]}],researchObjectType:[{required:!0,message:"请选择调研对象"}],deptType:[{required:!0,message:"请选择所属部门"}],researchPeriodType:[{required:!0,message:"请选择调研周期"}],startTime:[{required:!0,message:"请选择调研开始时间"}],endTime:[{required:!0,message:"请选择调研结束时间"}],businessShopType:[{required:!0,message:"请选择是否开启店铺限制"}]},sysAppraiseList:[],loading:!1}},mounted(){this.getSysAppraiseList()},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},async getSysAppraiseList(){this.loading=!0;let e={current:1,paramData:{},size:10},a=await this.$API.researchInfo.ResearchCompany.GetAppraiseSheetList.post(e);this.loading=!1,200==a.code?this.sysAppraiseList=a.data.list:this.$alert(a.message,"提示",{type:"error"})},change(e){this.form.sysAppraiseSheetName=this.sysAppraiseList.find((a=>a.no===e))?.name||""},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.CreatePlan.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}}))},editData(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.UpdatePlan.put(this.form.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},async setData(e){this.sysAppraiseList=[{no:e.sysAppraiseSheetNo,name:e.sysAppraiseSheetName}],Object.assign(this.form,e)}}},n=t(3744);const r=(0,n.Z)(o,[["render",i],["__scopeId","data-v-4823c643"]]);var d=r},2089:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(6252),i=t(3577);const s={key:0},o={key:1},n={key:2},r={key:3},d={key:0};function u(e,a,t,u,m,c){const p=(0,l.up)("el-form-item"),h=(0,l.up)("el-radio"),f=(0,l.up)("el-radio-group"),g=(0,l.up)("el-input"),w=(0,l.up)("el-form"),b=(0,l.up)("el-button"),y=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(y,{modelValue:m.visible,"onUpdate:modelValue":a[2]||(a[2]=e=>m.visible=e),class:"answer","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[3]||(a[3]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(b,{autoInsertSpace:"",type:"primary",onClick:a[0]||(a[0]=e=>m.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1}),(0,l.Wm)(b,{autoInsertSpace:"",type:"primary",loading:m.isSaveing,onClick:a[1]||(a[1]=e=>c.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(w,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{label:"检查要点:",class:"block_item"}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},[(0,l.Wm)(p,{label:e.name},{default:(0,l.w5)((()=>["BZXZZD_CLASS_07_TOPIC_01"===e.no?((0,l.wg)(),(0,l.iD)("div",s,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"陈列数≥40",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数≥40")])),_:1}),(0,l.Wm)(h,{label:"陈列数<40",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数<40")])),_:1}),(0,l.Wm)(h,{label:"无",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("无")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):"BZXZZD_CLASS_07_TOPIC_04"===e.no?((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"陈列数≥30",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数≥30")])),_:1}),(0,l.Wm)(h,{label:"陈列数<30",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数<30")])),_:1}),(0,l.Wm)(h,{label:"无",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("无")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):1===e.type?((0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4",disabled:"BZXZZD_CLASS_01_TOPIC_01"===e.no},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:e.optionYes,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.optionYes),1)])),_:2},1032,["label"]),(0,l.Wm)(h,{label:e.optionNo,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.optionNo),1)])),_:2},1032,["label"])])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])):2===e.type?((0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(g,{min:"0",type:"number",modelValue:e.count,"onUpdate:modelValue":a=>e.count=a},null,8,["modelValue","onUpdate:modelValue"])])):(0,l.kq)("",!0)])),_:2},1032,["label"])])))),128)),m.queryOptions.length&&"BZXZZD_CLASS_02_TOPIC_01"===m.queryOptions[0].no&&"是"===m.queryOptions[0].selectOption?((0,l.wg)(),(0,l.iD)("div",d,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.form,((e,a)=>((0,l.wg)(),(0,l.j4)(p,{key:a,label:e.label},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:e.whether,"onUpdate:modelValue":a=>e.whether=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"是",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("是")])),_:1}),(0,l.Wm)(h,{label:"否",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("否")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])))),128))])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["modelValue"])}var m={emits:["success","closed"],data(){return{id:this.$route.query.id,mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:[{label:"店招是否被污损",topicNo:"BZXZZD_CLASS_02_TOPIC_02",whether:""},{label:"店招是否被遮挡",topicNo:"BZXZZD_CLASS_02_TOPIC_03",whether:""}],queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add"){return this.mode=e,this.visible=!0,this},async submit(){this.isSaveing=!0;let e,a=this.queryOptions.map((e=>{let a={topicNo:e.no,whether:e.selectOption},t={quantity:e.count,topicNo:e.no};return 1===e.type?a:t}));if(e=a.length&&"BZXZZD_CLASS_02_TOPIC_01"===a[0].topicNo&&"是"===a[0].whether?[...a,...this.form]:a,e.find((e=>""===e.whether)))return this.$message.warning("请检查数据是否填写完整"),void(this.isSaveing=!1);let t=await this.$API.researchInfo.ResearchCompany.UpdatePlanOption.post(this.id,e);this.isSaveing=!1,200==t.code?(this.$emit("success",t.data),this.visible=!1,this.$message.success("操作成功")):this.$alert(t.message,"提示",{type:"error"})},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))}}},c=t(3744);const p=(0,c.Z)(m,[["render",u],["__scopeId","data-v-6b5b393a"]]);var h=p},3611:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);const i={class:"box"};function s(e,a,t,s,o,n){const r=(0,l.up)("el-form-item"),d=(0,l.up)("el-image"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"查看",modelValue:o.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>o.visible=e),class:"answer","show-close":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{autoInsertSpace:"",type:"primary",onClick:a[4]||(a[4]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"基础照片",class:"block_item"}),(0,l._)("div",i,[(0,l.Wm)(r,{label:`门头照片（${t.detail.doorheadImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.doorheadImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`许可证照片（${t.detail.licenceImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.licenceImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`室内环境（${t.detail.indoorImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[2]||(a[2]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.indoorImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`其他（${t.detail.otherImage.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[3]||(a[3]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.otherImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1})])])),_:1})])),_:1},8,["modelValue"])}var o={emits:["success","closed"],props:{detail:{type:Object,default:()=>{}}},data(){return{id:this.$route.query.id,visible:!1,isSaveing:!1,queryOptions:[],loading:!1,openPre:!1}},mounted(){},computed:{},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if("el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},open(){return this.visible=!0,this}}},n=t(3744);const r=(0,n.Z)(o,[["render",s],["__scopeId","data-v-aa11800a"]]);var d=r},5152:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return m}});var l=t(6252),i=t(3577);const s={class:"box"};function o(e,a,t,o,n,r){const d=(0,l.up)("el-form-item"),u=(0,l.up)("el-col"),m=(0,l.up)("el-row"),c=(0,l.up)("el-image"),p=(0,l.up)("el-button"),h=(0,l.up)("el-dialog"),f=(0,l.up)("answerDialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(h,{title:n.titleMap[n.mode],class:"answer",modelValue:n.visible,"onUpdate:modelValue":a[2]||(a[2]=e=>n.visible=e),width:700,"align-center":"","destroy-on-close":"",onClosed:a[3]||(a[3]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(p,{autoInsertSpace:"",type:"primary",onClick:a[1]||(a[1]=e=>n.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"评分情况"}),(0,l._)("div",s,[(0,l.Wm)(d,{label:"检查要点:",class:"block_item"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},(0,i.zw)(e.name),1)))),128))])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"分值:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(r.isCombine?r.combineInfo.combineScore:r.combineInfo.score),1)])),_:1})])),_:1}),(0,l.Wm)(u,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"得分:"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(r.filterColor(r.combineInfo))},(0,i.zw)(r.isCombine?r.combineInfo.combineHitScore:r.combineInfo.hitScore),5)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(d,{label:"回答:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(r.filterColor(r.combineInfo,!0))},(0,i.zw)(r.answer(n.queryOptions)),5)])),_:1}),(0,l.Wm)(d,{label:`照片（${r.combineInfo.url.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>r.clickImage&&r.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.combineInfo.url,((e,a)=>((0,l.wg)(),(0,l.j4)(c,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:r.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(d,{label:"备注:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(r.combineInfo.userRemark),1)])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"最新修改人账号:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(r.combineInfo.updateAccount||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(u,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"最新修改时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(r.combineInfo.updateTime||"-"),1)])),_:1})])),_:1})])),_:1})])])),_:1},8,["title","modelValue"]),n.dialog.save?((0,l.wg)(),(0,l.j4)(f,{key:0,ref:"answerDialog",onSuccess:r.handleSaveSuccess,onClosed:a[4]||(a[4]=e=>n.dialog.save=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var n=t(2089),r={emits:["success","closed"],components:{answerDialog:n["default"]},data(){return{id:this.$route.query.id,dialog:{save:!1},mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:{},queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1,openPre:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if(console.log(e),"el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},answer(e){if("BZXZZD_CLASS_02_TOPIC_01"===this.combineInfo.no)return this.combineInfo.selectOption;const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add"){return this.mode=e,this.visible=!0,this},async setData(e){console.log(e,"我是data"),this.queryOptions=JSON.parse(JSON.stringify(e))},handleSaveSuccess(e){"BZXZZD_CLASS_02_TOPIC_01"===e[0].no?this.queryOptions=JSON.parse(JSON.stringify([e[0]])):this.queryOptions=JSON.parse(JSON.stringify(e)),this.$parent.getDetail(this.id)}}},d=t(3744);const u=(0,d.Z)(r,[["render",o],["__scopeId","data-v-5730df69"]]);var m=u},1596:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return g}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-4211b1c5"),e=e(),(0,l.Cn)(),e),o={class:"left-panel"},n={class:"right-panel"},r={class:"right-panel-search",style:{margin:"5px 0"}},d={class:"left-panel"},u=s((()=>(0,l._)("div",{class:"right-panel"},null,-1)));function m(e,a,t,s,m,c){const p=(0,l.up)("el-input"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-col"),g=(0,l.up)("el-radio-button"),w=(0,l.up)("el-radio-group"),b=(0,l.up)("el-row"),y=(0,l.up)("el-button"),_=(0,l.up)("el-header"),v=(0,l.up)("el-table-column"),k=(0,l.up)("el-switch"),W=(0,l.up)("scTable"),I=(0,l.up)("el-main"),S=(0,l.up)("el-container"),D=(0,l.up)("user-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(b,{gutter:20},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"调研人员："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.surveyUserName,"onUpdate:modelValue":a[0]||(a[0]=e=>m.queryInfo.paramData.surveyUserName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"联系方式："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.surveyUserPhone,"onUpdate:modelValue":a[1]||(a[1]=e=>m.queryInfo.paramData.surveyUserPhone=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"参与权："},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{modelValue:m.queryInfo.paramData.status,"onUpdate:modelValue":a[2]||(a[2]=e=>m.queryInfo.paramData.status=e),onChange:c.changeData},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{label:""},{default:(0,l.w5)((()=>[(0,l.Uk)("全部")])),_:1}),(0,l.Wm)(g,{label:1},{default:(0,l.w5)((()=>[(0,l.Uk)("启用")])),_:1}),(0,l.Wm)(g,{label:2},{default:(0,l.w5)((()=>[(0,l.Uk)("禁用")])),_:1})])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1})])),_:1})]),(0,l._)("div",n,[(0,l._)("div",r,[(0,l.Wm)(y,{type:"default",onClick:a[3]||(a[3]=e=>c.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(y,{type:"primary",onClick:a[4]||(a[4]=e=>c.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l.Wm)(y,{type:"primary",size:"default",onClick:c.add},{default:(0,l.w5)((()=>[(0,l.Uk)(" 新增人员 ")])),_:1},8,["onClick"])]),u])),_:1}),(0,l.Wm)(I,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{ref:"table",data:m.tableData,height:"520px",staticTotal:m.total,onPaginationChange:c.paginationChange,onPageSizeChange:c.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:c.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{label:"人员名称",prop:"surveyUserName","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"联系方式",prop:"surveyUserPhone","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"账号",prop:"surveyUserAccount","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"已完成调研数",prop:"surveysCount","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"状态",prop:"surveysUserIsDelete","min-width":"200",align:"center"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,i.zw)(e.row.surveysUserIsDelete?"已删除":"正常"),1)])),_:1}),(0,l.Wm)(v,{label:"添加人",prop:"createUserAccount","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"添加时间",prop:"createTime","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"参与权",prop:"disable","min-width":"100",align:"center",fixed:"right"},{default:(0,l.w5)((e=>[(0,l.Wm)(k,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,"inline-prompt":"","active-text":"启用","inactive-text":"禁用",onChange:a=>c.disableUser(a,e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),m.dialog.save?((0,l.wg)(),(0,l.j4)(D,{key:0,ref:"userDialog",onClosed:a[5]||(a[5]=e=>m.dialog.save=!1),onSuccess:c.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var c=t(2037),p={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{userDialog:c["default"]},data(){return{dialog:{save:!1},tableData:[],total:0,queryInfo:{current:1,paramData:{marketScorePlanId:"",surveyUserName:"",surveyUserPhone:"",status:""},size:10},statusList:[{label:"正常",value:1},{label:"禁用",value:2},{label:"已删除",value:3}]}},watch:{},mounted(){},methods:{initData(){this.queryInfo={current:1,paramData:{marketScorePlanId:this.marketScorePlanId,surveyUserName:"",surveyUserPhone:"",status:""},size:10},this.getDataList()},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.userDialog.open(this.marketScorePlanId)}))},filterType(e,a){return a.find((a=>a.value===e))?.label||"-"},changeData(e){this.queryInfo.paramData.status=e},async disableUser(e,a){this.$confirm(`确定${2===e?"禁用":"启用"}${a.surveyUserName}吗？`,"提示",{type:"warning"}).then((async()=>{const t=this.$loading();let l=await this.$API.researchInfo.ResearchCompany.UpdatePlanUserStatus.put(a.id,{status:e});200===l.code?(this.$message.success("操作成功"),this.getDataList()):this.$message.error(l.message),t.close()})).catch((()=>{this.$message.info("用户取消禁用"),a.status=2===e?1:2}))},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetJoinUserList.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo.paramData.surveyUserName="",this.queryInfo.paramData.surveyUserPhone="",this.queryInfo.paramData.status=""),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},h=t(3744);const f=(0,h.Z)(p,[["render",m],["__scopeId","data-v-4211b1c5"]]);var g=f},3516:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var l=t(6252);const i={class:"left-panel"},s={class:"right-panel"},o={class:"right-panel-search",style:{margin:"5px 0"}};function n(e,a,t,n,r,d){const u=(0,l.up)("el-input"),m=(0,l.up)("el-form-item"),c=(0,l.up)("el-col"),p=(0,l.up)("el-row"),h=(0,l.up)("el-form"),f=(0,l.up)("el-button"),g=(0,l.up)("el-header"),w=(0,l.up)("el-table-column"),b=(0,l.up)("el-button-group"),y=(0,l.up)("scTable"),_=(0,l.up)("el-main"),v=(0,l.up)("el-container"),k=(0,l.up)("storeDialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(h,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{gutter:20,style:{width:"70%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>r.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>r.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[2]||(a[2]=e=>r.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[3]||(a[3]=e=>r.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[4]||(a[4]=e=>r.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"调研人员："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.surveyUserName,"onUpdate:modelValue":a[5]||(a[5]=e=>r.queryInfo.paramData.surveyUserName=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",s,[(0,l._)("div",o,[(0,l.Wm)(f,{type:"default",onClick:a[6]||(a[6]=e=>d.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(f,{type:"primary",onClick:a[7]||(a[7]=e=>d.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(_,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{ref:"table",data:r.tableData,height:"520px",staticTotal:r.total,onPaginationChange:d.paginationChange,onPageSizeChange:d.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:d.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(w,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),(0,l.Wm)(w,{label:"调研人员",prop:"surveyUserName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"完成时间",prop:"completionTime","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{text:"",type:"primary",size:"small",onClick:a=>d.viewPointTable(e.row.id)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"]),(0,l.Wm)(f,{text:"",type:"primary",size:"small",onClick:a=>d.table_del(e.row,e.$index)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),r.dialog.save?((0,l.wg)(),(0,l.j4)(k,{key:0,ref:"storeDialog",onClosed:a[8]||(a[8]=e=>r.dialog.save=!1),onSuccess:d.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}t(7658);var r=t(1593),d={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{storeDialog:r["default"]},data(){return{dialog:{save:!1},tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{businessShopName:"",accountManagerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:2,sysMarkScorePlanId:this.marketScorePlanId},size:10}}},watch:{},mounted(){},methods:{initData(){this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:2,sysMarkScorePlanId:this.marketScorePlanId},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/pointTable/index",query:{id:e}})},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.storeDialog.open(this.marketScorePlanId)}))},async table_del(e){this.$confirm("是否删除当前打分记录？","删除提示",{type:"warning"}).then((async()=>{let a=await this.$API.researchInfo.ResearchCompany.DeletePlanSheet.delete(e.id);200==a.code?(this.getDataList(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanBusiness.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:2,sysMarkScorePlanId:this.marketScorePlanId},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},u=t(3744);const m=(0,u.Z)(d,[["render",n],["__scopeId","data-v-21f4cc5f"]]);var c=m},9136:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return w}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-ff7e0372"),e=e(),(0,l.Cn)(),e),o={class:"left-panel"},n={class:"right-panel"},r={class:"right-panel-search",style:{margin:"5px 0"}},d={class:"left-panel"},u=s((()=>(0,l._)("div",{class:"right-panel"},null,-1)));function m(e,a,t,s,m,c){const p=(0,l.up)("el-input"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-col"),g=(0,l.up)("el-option"),w=(0,l.up)("el-select"),b=(0,l.up)("el-row"),y=(0,l.up)("el-form"),_=(0,l.up)("el-button"),v=(0,l.up)("el-header"),k=(0,l.up)("el-table-column"),W=(0,l.up)("el-tag"),I=(0,l.up)("el-popconfirm"),S=(0,l.up)("el-button-group"),D=(0,l.up)("scTable"),C=(0,l.up)("el-main"),U=(0,l.up)("el-container"),V=(0,l.up)("storeDialog"),q=(0,l.up)("upload-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(y,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{gutter:20,style:{width:"70%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>m.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>m.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"调研状态："},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{style:{width:"100%"},modelValue:m.queryInfo.paramData.status,"onUpdate:modelValue":a[2]||(a[2]=e=>m.queryInfo.paramData.status=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{label:"全部",value:""}),(0,l.Wm)(g,{label:"未打分",value:1}),(0,l.Wm)(g,{label:"已完成",value:2})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[3]||(a[3]=e=>m.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[4]||(a[4]=e=>m.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.customerName,"onUpdate:modelValue":a[5]||(a[5]=e=>m.queryInfo.paramData.customerName=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",n,[(0,l._)("div",r,[(0,l.Wm)(_,{type:"default",onClick:a[6]||(a[6]=e=>c.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(_,{type:"primary",onClick:a[7]||(a[7]=e=>c.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l.Wm)(_,{type:"primary",size:"default",onClick:c.add},{default:(0,l.w5)((()=>[(0,l.Uk)(" 添加店铺 ")])),_:1},8,["onClick"]),(0,l.Wm)(_,{type:"primary",size:"default",onClick:c.uploadImport},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量导入 ")])),_:1},8,["onClick"]),(0,l.Wm)(_,{type:"primary",disabled:0===m.selection.length,size:"default",onClick:c.batch_del},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量删除 ")])),_:1},8,["disabled","onClick"])]),u])),_:1}),(0,l.Wm)(C,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{ref:"table",data:m.tableData,height:"520px",staticTotal:m.total,onPaginationChange:c.paginationChange,onSelectionChange:c.selectionChange,onPageSizeChange:c.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:c.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{type:"selection","min-width":"50"}),(0,l.Wm)(k,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"150",align:"center"}),(0,l.Wm)(k,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"调研状态",prop:"status","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(W,{type:c.filterStatus(e.row.status)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(c.filterType(e.row.status,m.statusList)),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(k,{label:"店铺状态",prop:"businessStatus","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,i.zw)(c.filterType(e.row.businessStatus,m.businessStatusList)),1)])),_:1}),(0,l.Wm)(k,{label:"添加时间",prop:"createTime","min-width":"150",align:"center"}),(0,l.Wm)(k,{label:"操作",fixed:"right",align:"center","min-width":"100"},{default:(0,l.w5)((e=>[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(I,{title:"确定删除吗？",onConfirm:a=>c.table_del(e.row,e.$index)},{reference:(0,l.w5)((()=>[(0,l.Wm)(_,{text:"",type:"primary",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onSelectionChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),m.dialog.save?((0,l.wg)(),(0,l.j4)(V,{key:0,ref:"storeDialog",onClosed:a[8]||(a[8]=e=>m.dialog.save=!1),onSuccess:c.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0),m.dialog.upload?((0,l.wg)(),(0,l.j4)(q,{key:1,ref:"uploadDialog",onSuccess:c.handleSuccess,onClosed:a[9]||(a[9]=e=>m.dialog.upload=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var c=t(1593),p=t(8066),h={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{storeDialog:c["default"],uploadDialog:p["default"]},data(){return{dialog:{save:!1,upload:!1},tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{businessShopName:"",customerName:"",customerPhone:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10},statusList:[{label:"未打分",value:1},{label:"已完成",value:2}],businessStatusList:[{label:"禁用",value:0},{label:"启用",value:1}]}},watch:{},mounted(){},methods:{uploadImport(){this.dialog.upload=!0,this.$nextTick((()=>{this.$refs.uploadDialog.open()}))},initData(){this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10},this.getDataList()},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.storeDialog.open(this.marketScorePlanId)}))},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break}return a},filterType(e,a){return a.find((a=>a.value===e))?.label||"-"},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},selectionChange(e){this.selection=e},async table_del(e){this.$confirm("是否删除当前店铺？删除后该店铺会退出当前计划，本次计划相关打分记录将会同步删除；","删除提示",{type:"warning"}).then((async()=>{let a=await this.$API.researchInfo.ResearchCompany.DeletePlanBusiness.delete(e.id);200==a.code?(this.getDataList(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},async batch_del(){this.$confirm(`确定删除选中的 ${this.selection.length} 项吗？删除后 ${this.selection.length} 家店铺会退出当前计划，本次计划相关打分记录将会同步删除；`,"提示",{type:"warning"}).then((async()=>{const e=this.$loading();let a=await this.$API.researchInfo.ResearchCompany.BatchDeletePlanBusiness.delete(this.selection.map((e=>e.id)));200===a.code?(this.getDataList(),e.close(),this.$message.success("操作成功")):e.close()})).catch((e=>{console.log(e)}))},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanBusiness.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},f=t(3744);const g=(0,f.Z)(h,[["render",m],["__scopeId","data-v-ff7e0372"]]);var w=g},1593:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-input"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-form"),u=(0,l.up)("el-button"),m=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(m,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>s.visible=e),width:500,"destroy-on-close":"",onClosed:a[4]||(a[4]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(u,{onClick:a[2]||(a[2]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(u,{type:"primary",loading:s.isSaveing,onClick:o.submit},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading","onClick"])])),default:(0,l.w5)((()=>[(0,l.Wm)(d,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"120px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"店铺名称",prop:"businessShopName"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.businessShopName=e),placeholder:"请输入店铺名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"专卖许可证号",prop:"retailLicenseNumber"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.retailLicenseNumber=e),placeholder:"请输入专卖许可证号",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"添加店铺"},visible:!1,isSaveing:!1,form:{sysMarkScorePlanId:"",businessShopName:"",retailLicenseNumber:""},rules:{businessShopName:[{required:!0,message:"请输入店铺名称"}],retailLicenseNumber:[{required:!0,message:"请输入专卖许可证号"}]}}},methods:{open(e){return this.form.sysMarkScorePlanId=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.AddPlanBusiness.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},setData(e){Object.assign(this.form,e)}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-1fa44bae"]]);var r=n},8066:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-dd8a053e"),e=e(),(0,l.Cn)(),e),o=s((()=>(0,l._)("div",{class:"ball"},"1",-1))),n=s((()=>(0,l._)("div",{class:"text"},"上传文件",-1))),r=s((()=>(0,l._)("div",{class:"ball"},"2",-1))),d=s((()=>(0,l._)("div",{class:"text"},"确认结果",-1))),u={key:0,class:"center"},m=s((()=>(0,l._)("div",{class:"el-upload__text"}," 点击或将文件拖拽到这里上传 ",-1))),c={key:1,class:"center"},p={class:"successText"},h={class:"errText"},f={key:0},g={key:1};function w(e,a,t,s,w,b){const y=(0,l.up)("el-col"),_=(0,l.up)("el-row"),v=(0,l.up)("el-icon-message-box"),k=(0,l.up)("el-icon"),W=(0,l.up)("sc-upload-file"),I=(0,l.up)("el-form-item"),S=(0,l.up)("el-form"),D=(0,l.up)("el-button"),C=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(C,{title:w.titleMap[w.mode],modelValue:w.visible,"onUpdate:modelValue":a[7]||(a[7]=e=>w.visible=e),width:700,"destroy-on-close":"",onClosed:a[8]||(a[8]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[1===w.active?((0,l.wg)(),(0,l.iD)("div",f,[(0,l.Wm)(D,{onClick:a[3]||(a[3]=e=>w.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(D,{type:"primary",disabled:!b.uploadStatus,onClick:a[4]||(a[4]=e=>b.changePage(2))},{default:(0,l.w5)((()=>[(0,l.Uk)("下一步")])),_:1},8,["disabled"])])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",g,[(0,l.Wm)(D,{onClick:a[5]||(a[5]=e=>b.changePage(1))},{default:(0,l.w5)((()=>[(0,l.Uk)("上一步")])),_:1}),(0,l.Wm)(D,{type:"primary",loading:w.isSaveing,onClick:a[6]||(a[6]=e=>b.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交结果")])),_:1},8,["loading"])])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:18,offset:3},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{style:{"margin-bottom":"24px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>0?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[o,n])),_:1},8,["style"]),(0,l.Wm)(y,{span:12,class:"line"}),(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>1?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[r,d])),_:1},8,["style"])])),_:1}),1===w.active?((0,l.wg)(),(0,l.iD)("div",u,[(0,l.Wm)(S,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"上传文件：",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:(0,i.C_)({disUoloadSty:b.uploadStatus}),id:w.id,tip:"支持拓展名: .xls .xlsx",accept:".xls,.xlsx",modelValue:w.file,"onUpdate:modelValue":a[0]||(a[0]=e=>w.file=e),apiObj:w.apiObj,limit:1,drag:"",onRemove:b.onRemove,onSuccess:b.uploadSuccess},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{class:"el-icon--upload",style:{color:"rgb(24, 144, 255)"}},{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}),m])),_:1},8,["class","id","modelValue","apiObj","onRemove","onSuccess"])])),_:1})])),_:1}),(0,l.Wm)(S,{"label-position":"right"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"模板文件："},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量上传模版.xls "),(0,l._)("div",{class:"downLoad",onClick:a[1]||(a[1]=(...e)=>b.downLoadTemplate&&b.downLoadTemplate(...e))},"下载")])),_:1})])),_:1})])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(S,{"label-width":"150px"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:14,offset:5},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"可导入店铺数:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(w.uploadInfo.sureAddBusinessCount),1)])),_:1}),(0,l.Wm)(I,{label:"无法导入数:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,[(0,l.Uk)((0,i.zw)(w.uploadInfo.failAddBusinessCount)+" ",1),w.uploadInfo.failAddBusinessCount?((0,l.wg)(),(0,l.iD)("div",{key:0,class:"downLoad",onClick:a[2]||(a[2]=(...e)=>b.downLoadErr&&b.downLoadErr(...e))},"下载失败信息")):(0,l.kq)("",!0)])])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["title","modelValue"])}var b={emits:["success","closed"],props:{marketList:{type:Array,default:()=>[]},businessList:{type:Array,default:()=>[]}},data(){return{id:this.$route.query.id,apiObj:this.$API.researchInfo.ResearchCompany.UploadImport,active:1,mode:"import",titleMap:{import:"批量添加店铺"},visible:!1,isSaveing:!1,file:[],uploadInfo:{fileName:"",importId:"",sureAddBusinessCount:0,failAddBusinessCount:0}}},mounted(){},computed:{uploadStatus({file:e}){return e.length>0}},methods:{open(e="import"){return this.mode=e,this.visible=!0,this},changePage(e){this.active=e},onRemove(){return this.uploadInfo={fileName:"",importId:"",sureAddBusinessCount:0,failAddBusinessCount:0},this.file=[],!0},uploadSuccess(e){const{fileName:a,importId:t}=e.data;return this.uploadInfo=e.data,this.file=[{name:a,url:t}],!1},async submit(){let e=await this.$API.researchInfo.ResearchCompany.ImportBusiness.get(this.id,{importId:this.uploadInfo.importId});200==e.code?(this.$emit("success",{},"import"),this.visible=!1,this.$message.success("导入成功")):this.$alert(e.message,"提示",{type:"error"})},async setData(e){Object.assign(this.form,e)},async downLoadTemplate(){let e=await this.$API.researchInfo.ResearchCompany.DownloadImportTemplate.get();const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","批量上传模版.xlsx"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},async downLoadErr(){let e=await this.$API.researchInfo.ResearchCompany.DownloadImportRES.get(this.uploadInfo.importId);const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","失败信息.xlsx"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}},y=t(3744);const _=(0,y.Z)(b,[["render",w],["__scopeId","data-v-dd8a053e"]]);var v=_},2037:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-transfer"),r=(0,l.up)("el-button"),d=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(d,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>s.visible=e),width:605,"destroy-on-close":"",onClosed:a[4]||(a[4]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(r,{onClick:a[1]||(a[1]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(r,{type:"primary",loading:s.isSaveing,onClick:a[2]||(a[2]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(n,{modelValue:s.joinList,"onUpdate:modelValue":a[0]||(a[0]=e=>s.joinList=e),data:s.list,props:{key:"id",label:"name"}},null,8,["modelValue","data"])])])),_:1},8,["title","modelValue"])}t(7658);var s={emits:["success","closed"],data(){return{id:"",mode:"add",titleMap:{add:"选择参与人员",edit:"编辑店铺"},visible:!1,isSaveing:!1,loading:!1,list:[],joinList:[]}},mounted(){},methods:{open(e){return this.id=e,this.visible=!0,this.getDataList(),this},async submit(){this.isSaveing=!0;let e=[];this.joinList.forEach((a=>{let t={...this.list.find((e=>e.id===a)),sysMarkScorePlanId:this.id};e.push(t)}));var a=await this.$API.researchInfo.ResearchCompany.BatchAddJoinUser.post(e.map((e=>{let a={surveyUserAccount:e.account,surveyUserDisable:e.disable,surveyUserId:e.id,surveyUserName:e.name,surveyUserPhone:e.phone,sysMarkScorePlanId:e.sysMarkScorePlanId};return a})));this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})},async getDataList(){let e=await this.$API.researchInfo.ResearchCompany.GetUserCList.get(),a=await this.$API.researchInfo.ResearchCompany.GetJoinUserListNo.post({marketScorePlanId:this.id});this.list=e.data.filter((e=>-1===a.data.findIndex((a=>a.surveyUserId===e.id))))},filterMethod(e,a){return a.name.toLowerCase().includes(e.toLowerCase())},async setData(e){Object.assign(this.form,e)}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-6c9f273c"]]);var r=n},1002:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-input"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-option"),u=(0,l.up)("el-select"),m=(0,l.up)("el-col"),c=(0,l.up)("el-row"),p=(0,l.up)("el-date-picker"),h=(0,l.up)("el-radio"),f=(0,l.up)("el-radio-group"),g=(0,l.up)("el-form"),w=(0,l.up)("el-button"),b=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(b,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[13]||(a[13]=e=>s.visible=e),width:700,"destroy-on-close":"",onClosed:a[14]||(a[14]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(w,{onClick:a[10]||(a[10]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),["add"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(w,{key:0,type:"primary",loading:s.isSaveing,onClick:a[11]||(a[11]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0),["edit"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(w,{key:1,type:"primary",loading:s.isSaveing,onClick:a[12]||(a[12]=e=>o.editData())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(g,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"140px"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"计划名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.name=e),placeholder:"请输入计划名称",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1}),(0,l.Wm)(r,{label:"选择评分表",prop:"sysAppraiseSheetNo"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},modelValue:s.form.sysAppraiseSheetNo,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.sysAppraiseSheetNo=e),onChange:o.change,filterable:"",remote:"",clearable:"","reserve-keyword":"",placeholder:"请输入关键词",loading:s.loading,disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.sysAppraiseList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.name,value:e.no},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange","loading","disabled"])])),_:1}),(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"回收目标数",prop:"recoveryTargetCount"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.recoveryTargetCount,"onUpdate:modelValue":a[2]||(a[2]=e=>s.form.recoveryTargetCount=e),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"请输入回收目标数",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"回收阀数值",prop:"recoveryDoorsillCount"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.recoveryDoorsillCount,"onUpdate:modelValue":a[3]||(a[3]=e=>s.form.recoveryDoorsillCount=e),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"请输入回收阀值",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"调研对象",prop:"researchObjectType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.researchObjectType,"onUpdate:modelValue":a[4]||(a[4]=e=>s.form.researchObjectType=e),filterable:"",placeholder:"请选择调研对象",disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.researchObjectList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"所属部门",prop:"deptType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.deptType,"onUpdate:modelValue":a[5]||(a[5]=e=>s.form.deptType=e),filterable:"",placeholder:"请选择所属部门",disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.deptList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"调研周期",prop:"researchPeriodType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.researchPeriodType,"onUpdate:modelValue":a[6]||(a[6]=e=>s.form.researchPeriodType=e),filterable:"",placeholder:"请选择调研周期",disabled:[4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.researchPeriodList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,{label:"调研起止时间",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{style:{width:"100% !important"},gutter:10},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"startTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{style:{width:"100%"},modelValue:s.form.startTime,"onUpdate:modelValue":a[7]||(a[7]=e=>s.form.startTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"开始时间",disabled:[2,3,4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"endTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{style:{width:"100%"},modelValue:s.form.endTime,"onUpdate:modelValue":a[8]||(a[8]=e=>s.form.endTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"结束时间",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,{label:"是否开启店铺限制",prop:"businessShopType"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:s.form.businessShopType,"onUpdate:modelValue":a[9]||(a[9]=e=>s.form.businessShopType=e),disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:2},{default:(0,l.w5)((()=>[(0,l.Uk)("是")])),_:1}),(0,l.Wm)(h,{label:1},{default:(0,l.w5)((()=>[(0,l.Uk)("否")])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s=t(2787),o={emits:["success","closed"],props:{deptList:{type:Array,default:()=>[]},researchObjectList:{type:Array,default:()=>[]},researchPeriodList:{type:Array,default:()=>[]}},data(){return{mode:"add",titleMap:{add:"新建打分计划",edit:"编辑店铺"},visible:!1,isSaveing:!1,apiObj:this.$API.researchInfo.ResearchCompany.GetAppraiseSheetList,form:{name:"",sysAppraiseSheetName:"",sysAppraiseSheetNo:"",recoveryTargetCount:"",recoveryDoorsillCount:"",researchObjectType:"",deptType:"",researchPeriodType:"",startTime:"",endTime:"",businessShopType:""},rules:{name:[{required:!0,message:"请输入店铺名称"}],sysAppraiseSheetNo:[{required:!0,message:"请选择评分表"}],recoveryTargetCount:[{required:!0,message:"请输入回收目标数"},{validator:s.C$,trigger:["change","blur"]}],recoveryDoorsillCount:[{required:!0,message:"请输入回收阀值"},{validator:s.C$,trigger:["change","blur"]},{validator:(e,a,t)=>{"add"===this.mode?a>=this.form.recoveryTargetCount?t():t(new Error("回收阀值不得低于回收目标数")):"edit"===this.mode&&(a<this.form.recoveryTargetCount?t(new Error("回收阀值不得低于回收目标数")):a<this.form.completeCount?t(new Error("回收阀值不得低于当前已收集数")):t())},trigger:["change","blur"]}],researchObjectType:[{required:!0,message:"请选择调研对象"}],deptType:[{required:!0,message:"请选择所属部门"}],researchPeriodType:[{required:!0,message:"请选择调研周期"}],startTime:[{required:!0,message:"请选择调研开始时间"}],endTime:[{required:!0,message:"请选择调研结束时间"}],businessShopType:[{required:!0,message:"请选择是否开启店铺限制"}]},sysAppraiseList:[],loading:!1}},mounted(){this.getSysAppraiseList()},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},async getSysAppraiseList(){this.loading=!0;let e={current:1,paramData:{},size:10},a=await this.$API.researchInfo.ResearchCompany.GetAppraiseSheetList.post(e);this.loading=!1,200==a.code?this.sysAppraiseList=a.data.list:this.$alert(a.message,"提示",{type:"error"})},change(e){this.form.sysAppraiseSheetName=this.sysAppraiseList.find((a=>a.no===e))?.name||""},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.CreatePlan.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}}))},editData(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.UpdatePlan.put(this.form.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},async setData(e){this.sysAppraiseList=[{no:e.sysAppraiseSheetNo,name:e.sysAppraiseSheetName}],Object.assign(this.form,e)}}},n=t(3744);const r=(0,n.Z)(o,[["render",i],["__scopeId","data-v-bfb9d394"]]);var d=r},9598:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(6252),i=t(3577);const s={key:0},o={key:1},n={key:2},r={key:3},d={key:0};function u(e,a,t,u,m,c){const p=(0,l.up)("el-form-item"),h=(0,l.up)("el-radio"),f=(0,l.up)("el-radio-group"),g=(0,l.up)("el-input"),w=(0,l.up)("el-form"),b=(0,l.up)("el-button"),y=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(y,{modelValue:m.visible,"onUpdate:modelValue":a[2]||(a[2]=e=>m.visible=e),class:"answer","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[3]||(a[3]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(b,{autoInsertSpace:"",type:"primary",onClick:a[0]||(a[0]=e=>m.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1}),(0,l.Wm)(b,{autoInsertSpace:"",type:"primary",loading:m.isSaveing,onClick:a[1]||(a[1]=e=>c.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(w,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{label:"检查要点:",class:"block_item"}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},[(0,l.Wm)(p,{label:e.name},{default:(0,l.w5)((()=>["BZXZZD_CLASS_07_TOPIC_01"===e.no?((0,l.wg)(),(0,l.iD)("div",s,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"陈列数≥40",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数≥40")])),_:1}),(0,l.Wm)(h,{label:"陈列数<40",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数<40")])),_:1}),(0,l.Wm)(h,{label:"无",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("无")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):"BZXZZD_CLASS_07_TOPIC_04"===e.no?((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"陈列数≥30",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数≥30")])),_:1}),(0,l.Wm)(h,{label:"陈列数<30",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数<30")])),_:1}),(0,l.Wm)(h,{label:"无",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("无")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):1===e.type?((0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4",disabled:"BZXZZD_CLASS_01_TOPIC_01"===e.no},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:e.optionYes,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.optionYes),1)])),_:2},1032,["label"]),(0,l.Wm)(h,{label:e.optionNo,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.optionNo),1)])),_:2},1032,["label"])])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])):2===e.type?((0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(g,{min:"0",type:"number",modelValue:e.count,"onUpdate:modelValue":a=>e.count=a},null,8,["modelValue","onUpdate:modelValue"])])):(0,l.kq)("",!0)])),_:2},1032,["label"])])))),128)),m.queryOptions.length&&"BZXZZD_CLASS_02_TOPIC_01"===m.queryOptions[0].no&&"是"===m.queryOptions[0].selectOption?((0,l.wg)(),(0,l.iD)("div",d,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.form,((e,a)=>((0,l.wg)(),(0,l.j4)(p,{key:a,label:e.label},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:e.whether,"onUpdate:modelValue":a=>e.whether=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"是",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("是")])),_:1}),(0,l.Wm)(h,{label:"否",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("否")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])))),128))])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["modelValue"])}var m={emits:["success","closed"],data(){return{id:this.$route.query.id,mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:[{label:"店招是否被污损",topicNo:"BZXZZD_CLASS_02_TOPIC_02",whether:""},{label:"店招是否被遮挡",topicNo:"BZXZZD_CLASS_02_TOPIC_03",whether:""}],queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add"){return this.mode=e,this.visible=!0,this},async submit(){this.isSaveing=!0;let e,a=this.queryOptions.map((e=>{let a={topicNo:e.no,whether:e.selectOption},t={quantity:e.count,topicNo:e.no};return 1===e.type?a:t}));if(e=a.length&&"BZXZZD_CLASS_02_TOPIC_01"===a[0].topicNo&&"是"===a[0].whether?[...a,...this.form]:a,e.find((e=>""===e.whether)))return this.$message.warning("请检查数据是否填写完整"),void(this.isSaveing=!1);let t=await this.$API.researchInfo.ResearchCompany.UpdatePlanOption.post(this.id,e);this.isSaveing=!1,200==t.code?(this.$emit("success",t.data),this.visible=!1,this.$message.success("操作成功")):this.$alert(t.message,"提示",{type:"error"})},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))}}},c=t(3744);const p=(0,c.Z)(m,[["render",u],["__scopeId","data-v-4d36a696"]]);var h=p},2790:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);const i={class:"box"};function s(e,a,t,s,o,n){const r=(0,l.up)("el-form-item"),d=(0,l.up)("el-image"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"查看",modelValue:o.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>o.visible=e),class:"answer","show-close":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{autoInsertSpace:"",type:"primary",onClick:a[4]||(a[4]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"基础照片",class:"block_item"}),(0,l._)("div",i,[(0,l.Wm)(r,{label:`门头照片（${t.detail.doorheadImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.doorheadImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`许可证照片（${t.detail.licenceImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.licenceImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`室内环境（${t.detail.indoorImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[2]||(a[2]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.indoorImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`其他（${t.detail.otherImage.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[3]||(a[3]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.otherImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1})])])),_:1})])),_:1},8,["modelValue"])}var o={emits:["success","closed"],props:{detail:{type:Object,default:()=>{}}},data(){return{id:this.$route.query.id,visible:!1,isSaveing:!1,queryOptions:[],loading:!1,openPre:!1}},mounted(){},computed:{},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if("el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},open(){return this.visible=!0,this}}},n=t(3744);const r=(0,n.Z)(o,[["render",s],["__scopeId","data-v-24e14268"]]);var d=r},7707:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return m}});var l=t(6252),i=t(3577);const s={class:"box"};function o(e,a,t,o,n,r){const d=(0,l.up)("el-form-item"),u=(0,l.up)("el-col"),m=(0,l.up)("el-row"),c=(0,l.up)("el-image"),p=(0,l.up)("el-button"),h=(0,l.up)("el-dialog"),f=(0,l.up)("answerDialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(h,{title:n.titleMap[n.mode],class:"answer",modelValue:n.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>n.visible=e),width:700,"align-center":"","destroy-on-close":"",onClosed:a[4]||(a[4]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(p,{autoInsertSpace:"",onClick:a[1]||(a[1]=e=>r.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("修改选项")])),_:1}),(0,l.Wm)(p,{autoInsertSpace:"",type:"primary",onClick:a[2]||(a[2]=e=>n.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"评分情况"}),(0,l._)("div",s,[(0,l.Wm)(d,{label:"检查要点:",class:"block_item"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},(0,i.zw)(e.name),1)))),128))])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"分值:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(r.isCombine?r.combineInfo.combineScore:r.combineInfo.score),1)])),_:1})])),_:1}),(0,l.Wm)(u,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"得分:"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(r.filterColor(r.combineInfo))},(0,i.zw)(r.isCombine?r.combineInfo.combineHitScore:r.combineInfo.hitScore),5)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(d,{label:"回答:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(r.filterColor(r.combineInfo,!0))},(0,i.zw)(r.answer(n.queryOptions)),5)])),_:1}),(0,l.Wm)(d,{label:`照片（${r.combineInfo.url.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>r.clickImage&&r.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.combineInfo.url,((e,a)=>((0,l.wg)(),(0,l.j4)(c,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:r.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(d,{label:"备注:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(r.combineInfo.userRemark),1)])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"最新修改人账号:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(r.combineInfo.updateAccount||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(u,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"最新修改时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(r.combineInfo.updateTime||"-"),1)])),_:1})])),_:1})])),_:1})])])),_:1},8,["title","modelValue"]),n.dialog.save?((0,l.wg)(),(0,l.j4)(f,{key:0,ref:"answerDialog",onSuccess:r.handleSaveSuccess,onClosed:a[5]||(a[5]=e=>n.dialog.save=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var n=t(9598),r={emits:["success","closed"],components:{answerDialog:n["default"]},data(){return{id:this.$route.query.id,dialog:{save:!1},mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:{},queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1,openPre:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if(console.log(e),"el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},answer(e){if("BZXZZD_CLASS_02_TOPIC_01"===this.combineInfo.no)return this.combineInfo.selectOption;const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.answerDialog.open().setData(this.queryOptions)}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))},handleSaveSuccess(e){"BZXZZD_CLASS_02_TOPIC_01"===e[0].no?this.queryOptions=JSON.parse(JSON.stringify([e[0]])):this.queryOptions=JSON.parse(JSON.stringify(e)),this.$parent.getDetail(this.id)}}},d=t(3744);const u=(0,d.Z)(r,[["render",o],["__scopeId","data-v-5e442389"]]);var m=u},8443:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-input"),r=(0,l.up)("el-form-item"),d=(0,l.up)("sc-upload-multiple"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{modelValue:s.visible,"onUpdate:modelValue":a[4]||(a[4]=e=>s.visible=e),title:"申诉",class:"answer","close-on-click-modal":!1,"close-on-press-escape":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[5]||(a[5]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{autoInsertSpace:"",onClick:a[2]||(a[2]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(m,{autoInsertSpace:"",type:"primary",loading:s.isSaveing,onClick:a[3]||(a[3]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"label-position":"top",ref:"dialogForm",rules:s.rules,model:s.form},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"申诉理由:",class:"block_item",prop:"auditRemark"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{type:"textarea",placeholder:"请输入申诉理由",maxlength:"200","show-word-limit":"",modelValue:s.form.auditRemark,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.auditRemark=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:`上传图片（${s.form.auditImages.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,{prop:"auditImages"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:s.form.auditImages,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.auditImages=e),draggable:"",limit:9,tip:"最多上传9个文件,单个文件不要超过10M,请上传图像格式文件"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue"])}var s={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:{auditImages:[],auditRemark:"",resultId:0},queryOptions:[],rules:{auditRemark:[{required:!0,message:"请输入申诉理由，字数不超过200",trigger:["change","blur"]}],auditImages:[{required:!0,message:"请上传图片",trigger:["change","blur"]}]},loading:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add",a){return this.mode=e,this.visible=!0,this.form.resultId=a,this},async submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.$confirm("提交后将无法修改申诉理由和图片，且每项只能提交一次，是否确认提交申诉？","提示",{type:"warning"}).then((async()=>{this.isSaveing=!0;let{auditImages:e,auditRemark:a,resultId:t}=this.form,l={auditRemark:a,auditImages:e.map((e=>e.url)),resultId:t,topicNo:this.queryOptions.map((e=>e.no)).join("-"),topicType:this.combineInfo.combineStatus},i=await this.$API.researchInfo.ClientManager.AuditAppeal.post(l);this.isSaveing=!1,200==i.code?(this.$emit("success",i.data),this.visible=!1,this.$message.success("操作成功")):this.$alert(i.message,"提示",{type:"error"})})).catch((()=>{}))}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-86794172"]]);var r=n},2677:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);const i={class:"box"};function s(e,a,t,s,o,n){const r=(0,l.up)("el-form-item"),d=(0,l.up)("el-image"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"查看",modelValue:o.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>o.visible=e),class:"answer","show-close":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{autoInsertSpace:"",type:"primary",onClick:a[4]||(a[4]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"基础照片",class:"block_item"}),(0,l._)("div",i,[(0,l.Wm)(r,{label:`门头照片（${t.detail.doorheadImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.doorheadImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`许可证照片（${t.detail.licenceImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.licenceImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`室内环境（${t.detail.indoorImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[2]||(a[2]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.indoorImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`其他（${t.detail.otherImage.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[3]||(a[3]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.otherImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1})])])),_:1})])),_:1},8,["modelValue"])}var o={emits:["success","closed"],props:{detail:{type:Object,default:()=>{}}},data(){return{id:this.$route.query.id,visible:!1,isSaveing:!1,queryOptions:[],loading:!1,openPre:!1}},mounted(){},computed:{},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if("el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},open(){return this.visible=!0,this}}},n=t(3744);const r=(0,n.Z)(o,[["render",s],["__scopeId","data-v-7e908633"]]);var d=r},948:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return k}});var l=t(6252),i=t(3577);const s={class:"box"},o={key:0},n={style:{width:"80%","margin-left":"5px"}},r={class:"audit_name"},d={class:"audit_name"},u={class:"audit_name"},m={class:"audit_name"},c={class:"audit_name"},p={class:"audit_name"},h={class:"audit_name"},f={class:"audit_name"},g={class:"audit_name"};function w(e,a,t,w,b,y){const _=(0,l.up)("el-form-item"),v=(0,l.up)("el-col"),k=(0,l.up)("el-row"),W=(0,l.up)("el-image"),I=(0,l.up)("el-divider"),S=(0,l.up)("el-card"),D=(0,l.up)("el-timeline-item"),C=(0,l.up)("el-timeline"),U=(0,l.up)("el-button"),V=(0,l.up)("el-dialog"),q=(0,l.up)("openAppeal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(V,{title:b.titleMap[b.mode],class:"answer",modelValue:b.visible,"onUpdate:modelValue":a[4]||(a[4]=e=>b.visible=e),width:700,"align-center":"","destroy-on-close":"",onClosed:a[5]||(a[5]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[y.filteShow(y.combineInfo)?((0,l.wg)(),(0,l.j4)(U,{key:0,autoInsertSpace:"",onClick:a[2]||(a[2]=e=>y.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("发起申诉")])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(U,{autoInsertSpace:"",type:"primary",onClick:a[3]||(a[3]=e=>b.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"评分情况"}),(0,l._)("div",s,[(0,l.Wm)(_,{label:"检查要点:",class:"block_item"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(b.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},(0,i.zw)(e.name),1)))),128))])),_:1}),(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"分值:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(y.isCombine?y.combineInfo.combineScore:y.combineInfo.score),1)])),_:1})])),_:1}),(0,l.Wm)(v,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"得分:"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(y.filterColor(y.combineInfo))},(0,i.zw)(y.isCombine?y.combineInfo.combineHitScore:y.combineInfo.hitScore),5)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(_,{label:"回答:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(y.filterColor(y.combineInfo,!0))},(0,i.zw)(y.answer(b.queryOptions)),5)])),_:1}),(0,l.Wm)(_,{label:`照片（${y.combineInfo.url.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>y.clickImage&&y.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(y.combineInfo.url,((e,a)=>((0,l.wg)(),(0,l.j4)(W,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:y.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(_,{label:"备注:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(y.combineInfo.userRemark),1)])),_:1}),(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"最新修改人账号:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(y.combineInfo.updateAccount||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(v,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"最新修改时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(y.combineInfo.updateTime||"-"),1)])),_:1})])),_:1})])),_:1}),b.isShowTime?((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Uk)("申诉情况")])),_:1}),(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"申诉人："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.auditInfo.auditCircumstances.auditUserName),1)])),_:1})])),_:1}),(0,l.Wm)(v,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.auditInfo.auditCircumstances.marketingDepartmentName),1)])),_:1})])),_:1}),(0,l.Wm)(v,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.auditInfo.auditCircumstances.organizationName),1)])),_:1})])),_:1}),(0,l.Wm)(v,{span:24},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"申诉理由："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.auditInfo.auditCircumstances.auditRemark),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(_,{label:`照片（${b.auditInfo.auditCircumstances.auditImageList.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>y.clickImage&&y.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(b.auditInfo.auditCircumstances.auditImageList,((e,a)=>((0,l.wg)(),(0,l.j4)(W,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:y.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l._)("div",n,[(0,l.Wm)(C,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(b.auditInfo.auditList,((e,a)=>((0,l.wg)(),(0,l.j4)(D,{type:"success",key:a,timestamp:y.filterTime(e),placement:"top"},{default:(0,l.w5)((()=>[1===e.auditUserType?((0,l.wg)(),(0,l.j4)(S,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"客户经理:"},{default:(0,l.w5)((()=>[(0,l._)("div",r,(0,i.zw)(e.auditUserName),1),(0,l.Uk)(" 发起申诉 ")])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),[2,3].includes(e.auditUserType)?((0,l.wg)(),(0,l.j4)(S,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"审核结果:"},{default:(0,l.w5)((()=>[(0,l._)("div",d,(0,i.zw)(y.filterStatus(e.auditStatus)),1)])),_:2},1024),(0,l.Wm)(_,{label:"审核人:"},{default:(0,l.w5)((()=>[(0,l._)("div",u,(0,i.zw)(e.auditUserName),1)])),_:2},1024),(0,l.Wm)(_,{label:"审核理由:"},{default:(0,l.w5)((()=>[(0,l._)("div",m,(0,i.zw)(e.auditRemark),1)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),4===e.auditUserType?((0,l.wg)(),(0,l.j4)(S,{key:2},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"审核结果:"},{default:(0,l.w5)((()=>[(0,l._)("div",c,(0,i.zw)(y.filterStatus(e.auditStatus)),1)])),_:2},1024),(0,l.Wm)(_,{label:"审核人:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(e.auditUserName),1)])),_:2},1024),(0,l.Wm)(_,{label:"审核理由:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,(0,i.zw)(e.auditRemark),1)])),_:2},1024),(0,l.Wm)(_,{label:"回答更新:"},{default:(0,l.w5)((()=>[(0,l._)("div",f,(0,i.zw)(e.updateResult),1)])),_:2},1024),(0,l.Wm)(_,{label:"得分更新:"},{default:(0,l.w5)((()=>[(0,l._)("div",g,(0,i.zw)(e.updateScore),1)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0)])),_:2},1032,["timestamp"])))),128))])),_:1})])])):(0,l.kq)("",!0)])])),_:1},8,["title","modelValue"]),b.dialog.appeal?((0,l.wg)(),(0,l.j4)(q,{key:0,ref:"openAppeal",onSuccess:y.handleSaveSuccess,onClose:a[6]||(a[6]=e=>b.dialog.appeal=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var b=t(8443),y={emits:["success","closed"],components:{openAppeal:b["default"]},data(){return{id:this.$route.query.id,resultId:"",mode:"add",titleMap:{add:"查看"},dialog:{appeal:!1},auditInfo:{auditCircumstances:{auditImageList:[]},auditList:[]},visible:!1,isSaveing:!1,form:{},queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1,openPre:!1,isShowTime:!1,statusList:[{label:"未处理",value:0},{label:"通过",value:1},{label:"驳回",value:2},{label:"超时未处理",value:3},{label:"调研公司修改",value:4}]}},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{filterStatus(e){return this.statusList?.find((a=>a.value===e))?.label||"-"},filterTime(e){let a="";switch(e.auditUserType){case 1:a=`已发起申诉，待公布结果 ${e.auditTime}`;break;case 2:a=`区市场部审核结果 ${e.auditTime}`;break;case 3:a=`区营销部审核结果 ${e.auditTime}`;break;case 4:a=`调研公司审核结果 ${e.auditTime}`;break}return a},answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if(console.log(e),"el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0]?.appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},filteShow(e){let a=!1;return 1===e.combineStatus?e.combineHitScore<e.combineScore&&!e.status&&(a=!0):e.hitScore<e.score&&!e.status&&(a=!0),a},open(e="add",a){return this.mode=e,this.visible=!0,this.resultId=a,this},async getAuditDetail(){let e={topic:this.queryOptions.map((e=>e.no)).join("-")},a=await this.$API.researchInfo.ClientManager.GetAppealDetail.get(this.resultId,e);200===a.code?(this.auditInfo=a.data,this.isShowTime=!0):this.isShowTime=!1},submit(){this.dialog.appeal=!0,this.$nextTick((()=>{this.$refs.openAppeal.open("add",this.resultId).setData(this.queryOptions)}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e)),this.getAuditDetail()},appealSuccess(){this.$parent.getDetail(this.id)},handleSaveSuccess(){this.combineInfo.status=1,this.getAuditDetail(),this.$parent.getDetail(this.id)}}},_=t(3744);const v=(0,_.Z)(y,[["render",w],["__scopeId","data-v-3aab65aa"]]);var k=v},8615:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return m}});var l=t(6252);const i={class:"left-panel"},s={class:"right-panel"},o={class:"right-panel-search",style:{margin:"5px 0"}};function n(e,a,t,n,r,d){const u=(0,l.up)("el-input"),m=(0,l.up)("el-form-item"),c=(0,l.up)("el-col"),p=(0,l.up)("el-row"),h=(0,l.up)("el-form"),f=(0,l.up)("el-button"),g=(0,l.up)("el-header"),w=(0,l.up)("el-table-column"),b=(0,l.up)("el-button-group"),y=(0,l.up)("scTable"),_=(0,l.up)("el-main"),v=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(h,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{gutter:20,style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"商铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{placeholder:"请输入店铺名称",modelValue:r.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>r.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{placeholder:"请输入专卖许可证号",modelValue:r.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>r.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"分数筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{placeholder:"最低分数",modelValue:r.queryInfo.paramData.startScore,"onUpdate:modelValue":a[2]||(a[2]=e=>r.queryInfo.paramData.startScore=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(c,{span:2,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Uk)("~")])),_:1}),(0,l.Wm)(c,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{placeholder:"最高分数",modelValue:r.queryInfo.paramData.endScore,"onUpdate:modelValue":a[3]||(a[3]=e=>r.queryInfo.paramData.endScore=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",s,[(0,l._)("div",o,[(0,l.Wm)(f,{type:"default",onClick:a[4]||(a[4]=e=>d.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(f,{type:"primary",onClick:a[5]||(a[5]=e=>d.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(_,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{ref:"table",data:r.tableData,height:"520px",staticTotal:r.total,onPaginationChange:d.paginationChange,onPageSizeChange:d.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:d.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(w,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),(0,l.Wm)(w,{label:"申诉项",prop:"appealCount","min-width":"100",align:"center"}),(0,l.Wm)(w,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{text:"",type:"primary",size:"small",onClick:a=>d.viewPointTable(e.row.auditId)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1})}t(7658);var r={emits:["initData"],name:"PlanUserList",props:{},data(){return{dialog:{save:!1},open:!1,tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",sysMarkScorePlanId:this.$route.query.id},size:10}}},watch:{},mounted(){},methods:{filterType(e,a){return a?.find((a=>a.value===e))?.label||"-"},initData(){this.queryInfo={current:1,paramData:{businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",sysMarkScorePlanId:this.$route.query.id},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/appealTable",query:{id:e}})},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanAudit.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",sysMarkScorePlanId:this.$route.query.id},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},d=t(3744);const u=(0,d.Z)(r,[["render",n],["__scopeId","data-v-272e824e"]]);var m=u},4410:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-radio"),r=(0,l.up)("el-radio-group"),d=(0,l.up)("el-form-item"),u=(0,l.up)("el-input"),m=(0,l.up)("el-form"),c=(0,l.up)("el-button"),p=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(p,{modelValue:s.visible,"onUpdate:modelValue":a[4]||(a[4]=e=>s.visible=e),title:"申诉",class:"answer","close-on-click-modal":!1,"close-on-press-escape":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[5]||(a[5]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(c,{autoInsertSpace:"",onClick:a[2]||(a[2]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(c,{autoInsertSpace:"",type:"primary",loading:s.isSaveing,onClick:a[3]||(a[3]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(m,{"label-position":"top",ref:"dialogForm",rules:s.rules,model:s.form},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"是否通过审核:",class:"block_item",prop:"auditStatus"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{modelValue:s.form.auditStatus,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.auditStatus=e),class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{label:1,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("通过")])),_:1}),(0,l.Wm)(n,{label:2,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("驳回")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(d,{label:"审核理由:",class:"block_item",prop:"auditRemark"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{type:"textarea",placeholder:"请输入审核理由",maxlength:"200","show-word-limit":"",modelValue:s.form.auditRemark,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.auditRemark=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue"])}var s={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:{auditStatus:1,auditRemark:"",resultId:0},queryOptions:[],rules:{auditRemark:[{required:!0,message:"请输入审核理由，字数不超过200",trigger:["change","blur"]}],auditStatus:[{required:!0,message:"请选择是否通过审核",trigger:["change","blur"]}]},loading:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add",a){return this.mode=e,this.visible=!0,this.form.resultId=a,this},async submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.$confirm("提交后将无法修改审核结果和理由，是否确认提交审核？","提示",{type:"warning"}).then((async()=>{this.isSaveing=!0;let{auditStatus:e,auditRemark:a,resultId:t}=this.form,l={auditRemark:a,auditStatus:e,resultId:t,topicNo:this.queryOptions.map((e=>e.no)).join("-"),topicType:this.combineInfo.combineStatus},i=await this.$API.researchInfo.DistrictBazaarBranch.AuditAppeal.post(l);this.isSaveing=!1,200==i.code?(this.$emit("success",i.data),this.visible=!1,this.$message.success("操作成功")):this.$alert(i.message,"提示",{type:"error"})})).catch((()=>{}))}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-18725d30"]]);var r=n},6858:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);const i={class:"box"};function s(e,a,t,s,o,n){const r=(0,l.up)("el-form-item"),d=(0,l.up)("el-image"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"查看",modelValue:o.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>o.visible=e),class:"answer","show-close":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{autoInsertSpace:"",type:"primary",onClick:a[4]||(a[4]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"基础照片",class:"block_item"}),(0,l._)("div",i,[(0,l.Wm)(r,{label:`门头照片（${t.detail.doorheadImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.doorheadImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`许可证照片（${t.detail.licenceImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.licenceImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`室内环境（${t.detail.indoorImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[2]||(a[2]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.indoorImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`其他（${t.detail.otherImage.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[3]||(a[3]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.otherImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1})])])),_:1})])),_:1},8,["modelValue"])}var o={emits:["success","closed"],props:{detail:{type:Object,default:()=>{}}},data(){return{id:this.$route.query.id,visible:!1,isSaveing:!1,queryOptions:[],loading:!1,openPre:!1}},mounted(){},computed:{},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if("el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},open(){return this.visible=!0,this}}},n=t(3744);const r=(0,n.Z)(o,[["render",s],["__scopeId","data-v-7175cfb4"]]);var d=r},2540:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),i=t(3577);const s={class:"box"},o={key:0},n={style:{width:"80%","margin-left":"5px"}},r={class:"audit_name"},d={class:"audit_name"},u={class:"audit_name"},m={class:"audit_name"},c={class:"audit_name"},p={class:"audit_name"},h={class:"audit_name"},f={class:"audit_name"};function g(e,a,t,g,w,b){const y=(0,l.up)("el-form-item"),_=(0,l.up)("el-col"),v=(0,l.up)("el-row"),k=(0,l.up)("el-image"),W=(0,l.up)("el-divider"),I=(0,l.up)("el-card"),S=(0,l.up)("el-timeline-item"),D=(0,l.up)("el-timeline"),C=(0,l.up)("el-button"),U=(0,l.up)("el-dialog"),V=(0,l.up)("openAppeal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(U,{title:w.titleMap[w.mode],class:"answer",modelValue:w.visible,"onUpdate:modelValue":a[4]||(a[4]=e=>w.visible=e),width:700,"align-center":"","destroy-on-close":"",onClosed:a[5]||(a[5]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[b.filteShow(b.combineInfo)?((0,l.wg)(),(0,l.j4)(C,{key:0,autoInsertSpace:"",onClick:a[2]||(a[2]=e=>b.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("审核")])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(C,{autoInsertSpace:"",type:"primary",onClick:a[3]||(a[3]=e=>w.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"评分情况"}),(0,l._)("div",s,[(0,l.Wm)(y,{label:"检查要点:",class:"block_item"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},(0,i.zw)(e.name),1)))),128))])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"分值:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(b.isCombine?b.combineInfo.combineScore:b.combineInfo.score),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"得分:"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(b.filterColor(b.combineInfo))},(0,i.zw)(b.isCombine?b.combineInfo.combineHitScore:b.combineInfo.hitScore),5)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(y,{label:"回答:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(b.filterColor(b.combineInfo,!0))},(0,i.zw)(b.answer(w.queryOptions)),5)])),_:1}),(0,l.Wm)(y,{label:`照片（${b.combineInfo.url.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>b.clickImage&&b.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(b.combineInfo.url,((e,a)=>((0,l.wg)(),(0,l.j4)(k,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:b.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(y,{label:"备注:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.combineInfo.userRemark),1)])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"最新修改人账号:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(b.combineInfo.updateAccount||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"最新修改时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.combineInfo.updateTime||"-"),1)])),_:1})])),_:1})])),_:1}),w.isShowTime?((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Uk)("申诉情况")])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"申诉人："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.auditUserName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.marketingDepartmentName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.organizationName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:24},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"申诉理由："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.auditRemark),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(y,{label:`照片（${w.auditInfo.auditCircumstances.auditImageList.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>b.clickImage&&b.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.auditInfo.auditCircumstances.auditImageList,((e,a)=>((0,l.wg)(),(0,l.j4)(k,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:b.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l._)("div",n,[(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.auditInfo.auditList,((e,a)=>((0,l.wg)(),(0,l.j4)(S,{type:"success",key:a,timestamp:b.filterTime(e),placement:"top"},{default:(0,l.w5)((()=>[1===e.auditUserType?((0,l.wg)(),(0,l.j4)(I,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"客户经理:"},{default:(0,l.w5)((()=>[(0,l._)("div",r,(0,i.zw)(e.auditUserName),1),(0,l.Uk)(" 发起申诉 ")])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),[2,3].includes(e.auditUserType)?((0,l.wg)(),(0,l.j4)(I,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"审核结果:"},{default:(0,l.w5)((()=>[(0,l._)("div",{class:"audit_name",style:(0,i.j5)(b.filterStyle(e))},(0,i.zw)(b.filterStatus(e.auditStatus)),5)])),_:2},1024),(0,l.Wm)(y,{label:"审核人:"},{default:(0,l.w5)((()=>[(0,l._)("div",d,(0,i.zw)(e.auditUserName),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核理由:"},{default:(0,l.w5)((()=>[(0,l._)("div",u,(0,i.zw)(e.auditRemark),1)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),4===e.auditUserType?((0,l.wg)(),(0,l.j4)(I,{key:2},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"审核结果:"},{default:(0,l.w5)((()=>[(0,l._)("div",m,(0,i.zw)(b.filterStatus(e.auditStatus)),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核人:"},{default:(0,l.w5)((()=>[(0,l._)("div",c,(0,i.zw)(e.auditUserName),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核理由:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(e.auditRemark),1)])),_:2},1024),(0,l.Wm)(y,{label:"回答更新:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,(0,i.zw)(e.updateResult),1)])),_:2},1024),(0,l.Wm)(y,{label:"得分更新:"},{default:(0,l.w5)((()=>[(0,l._)("div",f,(0,i.zw)(e.updateScore),1)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0)])),_:2},1032,["timestamp"])))),128))])),_:1})])])):(0,l.kq)("",!0)])])),_:1},8,["title","modelValue"]),w.dialog.appeal?((0,l.wg)(),(0,l.j4)(V,{key:0,ref:"openAppeal",onSuccess:b.handleSaveSuccess,onClose:a[6]||(a[6]=e=>w.dialog.appeal=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var w=t(4410),b={emits:["success","closed"],components:{openAppeal:w["default"]},data(){return{id:this.$route.query.id,resultId:"",mode:"add",titleMap:{add:"查看"},dialog:{appeal:!1},auditInfo:{auditCircumstances:{auditImageList:[]},auditList:[]},visible:!1,isSaveing:!1,form:{},queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1,openPre:!1,isShowTime:!1,statusList:[{label:"未处理",value:0},{label:"通过",value:1},{label:"驳回",value:2},{label:"超时未处理",value:3},{label:"调研公司修改",value:4}]}},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{filterStatus(e){return this.statusList?.find((a=>a.value===e))?.label||"-"},filterStyle(e){let a="";switch(e.auditUserType){case 2:case 3:a="color:"+([2,3].includes(e.auditStatus)?"red":"#399C4E");break}return a},filterTime(e){let a="";switch(e.auditUserType){case 1:a=`已发起申诉，待公布结果 ${e.auditTime}`;break;case 2:a=`区市场部审核结果 ${e.auditTime}`;break;case 3:a=`区营销部审核结果 ${e.auditTime}`;break;case 4:a=`调研公司审核结果 ${e.auditTime}`;break}return a},answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if(console.log(e),"el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0]?.appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},filteShow(e){let a=!1;return 1===e.combineStatus?e.combineHitScore<e.combineScore&&!e.status&&(a=!0):e.hitScore<e.score&&!e.status&&(a=!0),a},open(e="add",a){return this.mode=e,this.visible=!0,this.resultId=a,this},async getAuditDetail(){let e={topic:this.queryOptions.map((e=>e.no)).join("-")},a=await this.$API.researchInfo.DistrictBazaarBranch.GetAppealDetail.get(this.resultId,e);200===a.code?(this.auditInfo=a.data,this.isShowTime=!0):this.isShowTime=!1},submit(){this.dialog.appeal=!0,this.$nextTick((()=>{this.$refs.openAppeal.open("add",this.resultId).setData(this.queryOptions)}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e)),this.getAuditDetail()},appealSuccess(){this.$parent.getDetail(this.id)},handleSaveSuccess(){this.combineInfo.status=1,this.getAuditDetail(),this.$parent.getDetail(this.id)}}},y=t(3744);const _=(0,y.Z)(b,[["render",g],["__scopeId","data-v-529011c1"]]);var v=_},2165:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(6252),i=t(3577);const s={class:"left-panel"},o={class:"right-panel"},n={class:"right-panel-search",style:{margin:"5px 0"}},r=["title"],d={key:0};function u(e,a,t,u,m,c){const p=(0,l.up)("el-input"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-col"),g=(0,l.up)("el-row"),w=(0,l.up)("el-form"),b=(0,l.up)("el-button"),y=(0,l.up)("el-header"),_=(0,l.up)("el-table-column"),v=(0,l.up)("el-tooltip"),k=(0,l.up)("el-button-group"),W=(0,l.up)("scTable"),I=(0,l.up)("el-main"),S=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(w,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{gutter:20,style:{width:"85%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入店铺名称",modelValue:m.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>m.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入客户经理名称",modelValue:m.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[1]||(a[1]=e=>m.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"分数筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"最低分数",modelValue:m.queryInfo.paramData.startScore,"onUpdate:modelValue":a[2]||(a[2]=e=>m.queryInfo.paramData.startScore=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f,{span:2,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Uk)("~")])),_:1}),(0,l.Wm)(f,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"最高分数",modelValue:m.queryInfo.paramData.endScore,"onUpdate:modelValue":a[3]||(a[3]=e=>m.queryInfo.paramData.endScore=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入专卖许可证号",modelValue:m.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[4]||(a[4]=e=>m.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入所属营销部",modelValue:m.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[5]||(a[5]=e=>m.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Uk)(),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入所属市场部",modelValue:m.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[6]||(a[6]=e=>m.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",o,[(0,l._)("div",n,[(0,l.Wm)(b,{type:"default",onClick:a[7]||(a[7]=e=>c.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(b,{type:"primary",onClick:a[8]||(a[8]=e=>c.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(I,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{ref:"table",data:m.tableData,height:"520px",staticTotal:m.total,onPaginationChange:c.paginationChange,onPageSizeChange:c.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:c.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(_,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.headList,((e,a)=>((0,l.wg)(),(0,l.j4)(_,{key:a,label:e.label,align:"center"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.headList[a].children,((e,t)=>((0,l.wg)(),(0,l.j4)(_,{"min-width":"120",key:t,prop:`${a}_${t}`,align:"center",label:e.label},{header:(0,l.w5)((()=>[(0,l.Wm)(v,{effect:"dark",content:e.label,placement:"top"},{default:(0,l.w5)((()=>[(0,l._)("div",{title:e.label,class:"tbHead"},(0,i.zw)(e.label),9,r)])),_:2},1032,["content"])])),default:(0,l.w5)((e=>[0===a||1===a&&0===t?((0,l.wg)(),(0,l.iD)("div",d,"-")):((0,l.wg)(),(0,l.iD)("div",{key:1,style:(0,i.j5)(c.filterColor(e.row.topicListList[a].topicList[t]))},(0,i.zw)(e.row.topicListList[a].topicList[t].hitScore),5))])),_:2},1032,["prop","label"])))),128))])),_:2},1032,["label"])))),128)),(0,l.Wm)(_,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,{text:"",type:"primary",size:"small",onClick:a=>c.viewPointTable(e.row.auditId)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1})}t(7658);var m={emits:["initData"],name:"PlanUserList",props:{},data(){return{dialog:{save:!1},open:!1,tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",marketingDepartmentName:"",sysMarkScorePlanId:this.$route.query.id},size:10},statusList:[{label:"待处理",value:1},{label:"已处理",value:2},{label:"已截止",value:3}],headList:[]}},watch:{},mounted(){},methods:{filterColor(e){let a="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(a="color: red;"):e.hitScore<e.score&&(a="color: red;"),a},changeCellStyle({row:e,column:a}){if(2===a.level){const[t,l]=a.property.split("_"),{status:i}=e.topicListList[t].topicList[l];if(i&&0===i)return{background:"#ffc327"};if(i&&1===i)return{background:"#b6f3ca"};if(i&&2===i)return{background:"#fbcbcb"};if(i&&3===i)return{background:"#91d5ff"}}},filterType(e,a){return a?.find((a=>a.value===e))?.label||"-"},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break;case 3:a="info";break}return a},initData(){this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",marketingDepartmentName:"",sysMarkScorePlanId:this.$route.query.id},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/appealTable",query:{id:e}})},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.DistrictBazaarBranch.GetAllData.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.headList=this.getHead(e.data.list?.[0]?.topicListList),this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},getHead(e){return e?e&&e.length>0?e.map((e=>({label:e.className,children:e.topicList.map((e=>({label:e.name})))}))):void 0:[]},upsearch(e){e&&(this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",marketingDepartmentName:"",sysMarkScorePlanId:this.$route.query.id},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},c=t(3744);const p=(0,c.Z)(m,[["render",u],["__scopeId","data-v-9a67e35a"]]);var h=p},3045:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var l=t(6252),i=t(3577);const s={class:"left-panel"},o={class:"right-panel"},n={class:"right-panel-search",style:{margin:"5px 0"}};function r(e,a,t,r,d,u){const m=(0,l.up)("el-input"),c=(0,l.up)("el-form-item"),p=(0,l.up)("el-col"),h=(0,l.up)("el-row"),f=(0,l.up)("el-option"),g=(0,l.up)("el-select"),w=(0,l.up)("el-form"),b=(0,l.up)("el-button"),y=(0,l.up)("el-header"),_=(0,l.up)("el-table-column"),v=(0,l.up)("el-tag"),k=(0,l.up)("el-button-group"),W=(0,l.up)("scTable"),I=(0,l.up)("el-main"),S=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(w,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{gutter:20,style:{width:"85%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入店铺名称",modelValue:d.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>d.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入客户经理名称",modelValue:d.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[1]||(a[1]=e=>d.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"分数筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"最低分数",modelValue:d.queryInfo.paramData.startScore,"onUpdate:modelValue":a[2]||(a[2]=e=>d.queryInfo.paramData.startScore=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{span:2,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Uk)("~")])),_:1}),(0,l.Wm)(p,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"最高分数",modelValue:d.queryInfo.paramData.endScore,"onUpdate:modelValue":a[3]||(a[3]=e=>d.queryInfo.paramData.endScore=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入专卖许可证号",modelValue:d.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[4]||(a[4]=e=>d.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"处理状态："},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{placeholder:"请选择处理状态",clearable:"",modelValue:d.queryInfo.paramData.auditStatus,"onUpdate:modelValue":a[5]||(a[5]=e=>d.queryInfo.paramData.auditStatus=e),style:{width:"100%"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.statusList,((e,a)=>((0,l.wg)(),(0,l.j4)(f,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",o,[(0,l._)("div",n,[(0,l.Wm)(b,{type:"default",onClick:a[6]||(a[6]=e=>u.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(b,{type:"primary",onClick:a[7]||(a[7]=e=>u.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(I,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{ref:"table",data:d.tableData,height:"520px",staticTotal:d.total,onPaginationChange:u.paginationChange,onPageSizeChange:u.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:u.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(_,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"申诉项",prop:"appealCount","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"已处理",prop:"processedCount","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"处理状态",prop:"processedCount","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(v,{type:u.filterStatus(e.row.auditStatus)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(u.filterType(e.row.auditStatus,d.statusList)),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(_,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,{text:"",type:"primary",size:"small",onClick:a=>u.viewPointTable(e.row.auditId)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1})}t(7658);var d={emits:["initData"],name:"PlanUserList",props:{},data(){return{dialog:{save:!1},open:!1,tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",auditStatus:"",sysMarkScorePlanId:this.$route.query.id},size:10},statusList:[{label:"待处理",value:1},{label:"已处理",value:2},{label:"已截止",value:3}]}},watch:{},mounted(){},methods:{filterType(e,a){return a?.find((a=>a.value===e))?.label||"-"},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break;case 3:a="info";break}return a},initData(){this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",auditStatus:"",sysMarkScorePlanId:this.$route.query.id},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/appealTable",query:{id:e}})},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanAudit.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",auditStatus:"",sysMarkScorePlanId:this.$route.query.id},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},u=t(3744);const m=(0,u.Z)(d,[["render",r],["__scopeId","data-v-6d76b4af"]]);var c=m},9924:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-radio"),r=(0,l.up)("el-radio-group"),d=(0,l.up)("el-form-item"),u=(0,l.up)("el-input"),m=(0,l.up)("el-form"),c=(0,l.up)("el-button"),p=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(p,{modelValue:s.visible,"onUpdate:modelValue":a[4]||(a[4]=e=>s.visible=e),title:"申诉",class:"answer","close-on-click-modal":!1,"close-on-press-escape":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[5]||(a[5]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(c,{autoInsertSpace:"",onClick:a[2]||(a[2]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(c,{autoInsertSpace:"",type:"primary",loading:s.isSaveing,onClick:a[3]||(a[3]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(m,{"label-position":"top",ref:"dialogForm",rules:s.rules,model:s.form},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"是否通过审核:",class:"block_item",prop:"auditStatus"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{modelValue:s.form.auditStatus,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.auditStatus=e),class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{label:1,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("通过")])),_:1}),(0,l.Wm)(n,{label:2,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("驳回")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(d,{label:"审核理由:",class:"block_item",prop:"auditRemark"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{type:"textarea",placeholder:"请输入审核理由",maxlength:"200","show-word-limit":"",modelValue:s.form.auditRemark,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.auditRemark=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue"])}var s={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:{auditStatus:1,auditRemark:"",resultId:0},queryOptions:[],rules:{auditRemark:[{required:!0,message:"请输入审核理由，字数不超过200",trigger:["change","blur"]}],auditStatus:[{required:!0,message:"请选择是否通过审核",trigger:["change","blur"]}]},loading:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add",a){return this.mode=e,this.visible=!0,this.form.resultId=a,this},async submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.$confirm("提交后将无法修改审核结果和理由，是否确认提交审核？","提示",{type:"warning"}).then((async()=>{this.isSaveing=!0;let{auditStatus:e,auditRemark:a,resultId:t}=this.form,l={auditRemark:a,auditStatus:e,resultId:t,topicNo:this.queryOptions.map((e=>e.no)).join("-"),topicType:this.combineInfo.combineStatus},i=await this.$API.researchInfo.DistrictMarketBranch.AuditAppeal.post(l);this.isSaveing=!1,200==i.code?(this.$emit("success",i.data),this.visible=!1,this.$message.success("操作成功")):this.$alert(i.message,"提示",{type:"error"})})).catch((()=>{}))}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-f8233c44"]]);var r=n},3227:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);const i={class:"box"};function s(e,a,t,s,o,n){const r=(0,l.up)("el-form-item"),d=(0,l.up)("el-image"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"查看",modelValue:o.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>o.visible=e),class:"answer","show-close":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{autoInsertSpace:"",type:"primary",onClick:a[4]||(a[4]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"基础照片",class:"block_item"}),(0,l._)("div",i,[(0,l.Wm)(r,{label:`门头照片（${t.detail.doorheadImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.doorheadImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`许可证照片（${t.detail.licenceImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.licenceImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`室内环境（${t.detail.indoorImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[2]||(a[2]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.indoorImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`其他（${t.detail.otherImage.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[3]||(a[3]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.otherImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1})])])),_:1})])),_:1},8,["modelValue"])}var o={emits:["success","closed"],props:{detail:{type:Object,default:()=>{}}},data(){return{id:this.$route.query.id,visible:!1,isSaveing:!1,queryOptions:[],loading:!1,openPre:!1}},mounted(){},computed:{},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if("el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},open(){return this.visible=!0,this}}},n=t(3744);const r=(0,n.Z)(o,[["render",s],["__scopeId","data-v-76342d21"]]);var d=r},1724:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),i=t(3577);const s={class:"box"},o={key:0},n={style:{width:"80%","margin-left":"5px"}},r={class:"audit_name"},d={class:"audit_name"},u={class:"audit_name"},m={class:"audit_name"},c={class:"audit_name"},p={class:"audit_name"},h={class:"audit_name"},f={class:"audit_name"};function g(e,a,t,g,w,b){const y=(0,l.up)("el-form-item"),_=(0,l.up)("el-col"),v=(0,l.up)("el-row"),k=(0,l.up)("el-image"),W=(0,l.up)("el-divider"),I=(0,l.up)("el-card"),S=(0,l.up)("el-timeline-item"),D=(0,l.up)("el-timeline"),C=(0,l.up)("el-button"),U=(0,l.up)("el-dialog"),V=(0,l.up)("openAppeal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(U,{title:w.titleMap[w.mode],class:"answer",modelValue:w.visible,"onUpdate:modelValue":a[4]||(a[4]=e=>w.visible=e),width:700,"align-center":"","destroy-on-close":"",onClosed:a[5]||(a[5]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[b.filteShow(b.combineInfo)?((0,l.wg)(),(0,l.j4)(C,{key:0,autoInsertSpace:"",onClick:a[2]||(a[2]=e=>b.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("审核")])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(C,{autoInsertSpace:"",type:"primary",onClick:a[3]||(a[3]=e=>w.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"评分情况"}),(0,l._)("div",s,[(0,l.Wm)(y,{label:"检查要点:",class:"block_item"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},(0,i.zw)(e.name),1)))),128))])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"分值:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(b.isCombine?b.combineInfo.combineScore:b.combineInfo.score),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"得分:"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(b.filterColor(b.combineInfo))},(0,i.zw)(b.isCombine?b.combineInfo.combineHitScore:b.combineInfo.hitScore),5)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(y,{label:"回答:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(b.filterColor(b.combineInfo,!0))},(0,i.zw)(b.answer(w.queryOptions)),5)])),_:1}),(0,l.Wm)(y,{label:`照片（${b.combineInfo.url.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>b.clickImage&&b.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(b.combineInfo.url,((e,a)=>((0,l.wg)(),(0,l.j4)(k,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:b.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(y,{label:"备注:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.combineInfo.userRemark),1)])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"最新修改人账号:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(b.combineInfo.updateAccount||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"最新修改时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.combineInfo.updateTime||"-"),1)])),_:1})])),_:1})])),_:1}),w.isShowTime?((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Uk)("申诉情况")])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"申诉人："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.auditUserName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.marketingDepartmentName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.organizationName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:24},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"申诉理由："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.auditRemark),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(y,{label:`照片（${w.auditInfo.auditCircumstances.auditImageList.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>b.clickImage&&b.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.auditInfo.auditCircumstances.auditImageList,((e,a)=>((0,l.wg)(),(0,l.j4)(k,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:b.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l._)("div",n,[(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.auditInfo.auditList,((e,a)=>((0,l.wg)(),(0,l.j4)(S,{type:"success",key:a,timestamp:b.filterTime(e),placement:"top"},{default:(0,l.w5)((()=>[1===e.auditUserType?((0,l.wg)(),(0,l.j4)(I,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"客户经理:"},{default:(0,l.w5)((()=>[(0,l._)("div",r,(0,i.zw)(e.auditUserName),1),(0,l.Uk)(" 发起申诉 ")])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),[2,3].includes(e.auditUserType)?((0,l.wg)(),(0,l.j4)(I,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"审核结果:"},{default:(0,l.w5)((()=>[(0,l._)("div",{class:"audit_name",style:(0,i.j5)(b.filterStyle(e))},(0,i.zw)(b.filterStatus(e.auditStatus)),5)])),_:2},1024),(0,l.Wm)(y,{label:"审核人:"},{default:(0,l.w5)((()=>[(0,l._)("div",d,(0,i.zw)(e.auditUserName),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核理由:"},{default:(0,l.w5)((()=>[(0,l._)("div",u,(0,i.zw)(e.auditRemark),1)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),4===e.auditUserType?((0,l.wg)(),(0,l.j4)(I,{key:2},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"审核结果:"},{default:(0,l.w5)((()=>[(0,l._)("div",m,(0,i.zw)(b.filterStatus(e.auditStatus)),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核人:"},{default:(0,l.w5)((()=>[(0,l._)("div",c,(0,i.zw)(e.auditUserName),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核理由:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(e.auditRemark),1)])),_:2},1024),(0,l.Wm)(y,{label:"回答更新:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,(0,i.zw)(e.updateResult),1)])),_:2},1024),(0,l.Wm)(y,{label:"得分更新:"},{default:(0,l.w5)((()=>[(0,l._)("div",f,(0,i.zw)(e.updateScore),1)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0)])),_:2},1032,["timestamp"])))),128))])),_:1})])])):(0,l.kq)("",!0)])])),_:1},8,["title","modelValue"]),w.dialog.appeal?((0,l.wg)(),(0,l.j4)(V,{key:0,ref:"openAppeal",onSuccess:b.handleSaveSuccess,onClose:a[6]||(a[6]=e=>w.dialog.appeal=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var w=t(9924),b={emits:["success","closed"],components:{openAppeal:w["default"]},data(){return{id:this.$route.query.id,resultId:"",mode:"add",titleMap:{add:"查看"},dialog:{appeal:!1},auditInfo:{auditCircumstances:{auditImageList:[]},auditList:[]},visible:!1,isSaveing:!1,form:{},queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1,openPre:!1,isShowTime:!1,statusList:[{label:"未处理",value:0},{label:"通过",value:1},{label:"驳回",value:2},{label:"超时未处理",value:3},{label:"调研公司修改",value:4}]}},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{filterStatus(e){return this.statusList?.find((a=>a.value===e))?.label||"-"},filterStyle(e){let a="";switch(e.auditUserType){case 2:case 3:a="color:"+([2,3].includes(e.auditStatus)?"red":"#399C4E");break}return a},filterTime(e){let a="";switch(e.auditUserType){case 1:a=`已发起申诉，待公布结果 ${e.auditTime}`;break;case 2:a=`区市场部审核结果 ${e.auditTime}`;break;case 3:a=`区营销部审核结果 ${e.auditTime}`;break;case 4:a=`调研公司审核结果 ${e.auditTime}`;break}return a},answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if(console.log(e),"el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0]?.appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},filteShow(e){let a=!1;return 1===e.combineStatus?e.combineHitScore<e.combineScore&&!e.status&&(a=!0):e.hitScore<e.score&&!e.status&&(a=!0),a},open(e="add",a){return this.mode=e,this.visible=!0,this.resultId=a,this},async getAuditDetail(){let e={topic:this.queryOptions.map((e=>e.no)).join("-")},a=await this.$API.researchInfo.DistrictMarketBranch.GetAppealDetail.get(this.resultId,e);200===a.code?(this.auditInfo=a.data,this.isShowTime=!0):this.isShowTime=!1},submit(){this.dialog.appeal=!0,this.$nextTick((()=>{this.$refs.openAppeal.open("add",this.resultId).setData(this.queryOptions)}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e)),this.getAuditDetail()},appealSuccess(){this.$parent.getDetail(this.id)},handleSaveSuccess(){this.combineInfo.status=1,this.getAuditDetail(),this.$parent.getDetail(this.id)}}},y=t(3744);const _=(0,y.Z)(b,[["render",g],["__scopeId","data-v-6eab760b"]]);var v=_},2755:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(6252),i=t(3577);const s={class:"left-panel"},o={class:"right-panel"},n={class:"right-panel-search",style:{margin:"5px 0"}},r=["title"],d={key:0};function u(e,a,t,u,m,c){const p=(0,l.up)("el-input"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-col"),g=(0,l.up)("el-row"),w=(0,l.up)("el-form"),b=(0,l.up)("el-button"),y=(0,l.up)("el-header"),_=(0,l.up)("el-table-column"),v=(0,l.up)("el-tooltip"),k=(0,l.up)("el-button-group"),W=(0,l.up)("scTable"),I=(0,l.up)("el-main"),S=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(w,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{gutter:20,style:{width:"85%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入店铺名称",modelValue:m.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>m.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入客户经理名称",modelValue:m.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[1]||(a[1]=e=>m.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"分数筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"最低分数",modelValue:m.queryInfo.paramData.startScore,"onUpdate:modelValue":a[2]||(a[2]=e=>m.queryInfo.paramData.startScore=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f,{span:2,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Uk)("~")])),_:1}),(0,l.Wm)(f,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"最高分数",modelValue:m.queryInfo.paramData.endScore,"onUpdate:modelValue":a[3]||(a[3]=e=>m.queryInfo.paramData.endScore=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入专卖许可证号",modelValue:m.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[4]||(a[4]=e=>m.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入所属营销部",modelValue:m.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[5]||(a[5]=e=>m.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Uk)(),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入所属市场部",modelValue:m.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[6]||(a[6]=e=>m.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",o,[(0,l._)("div",n,[(0,l.Wm)(b,{type:"default",onClick:a[7]||(a[7]=e=>c.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(b,{type:"primary",onClick:a[8]||(a[8]=e=>c.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(I,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{ref:"table",data:m.tableData,height:"520px",staticTotal:m.total,onPaginationChange:c.paginationChange,onPageSizeChange:c.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:c.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(_,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.headList,((e,a)=>((0,l.wg)(),(0,l.j4)(_,{key:a,label:e.label,align:"center"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.headList[a].children,((e,t)=>((0,l.wg)(),(0,l.j4)(_,{"min-width":"120",key:t,prop:`${a}_${t}`,align:"center",label:e.label},{header:(0,l.w5)((()=>[(0,l.Wm)(v,{effect:"dark",content:e.label,placement:"top"},{default:(0,l.w5)((()=>[(0,l._)("div",{title:e.label,class:"tbHead"},(0,i.zw)(e.label),9,r)])),_:2},1032,["content"])])),default:(0,l.w5)((e=>[0===a||1===a&&0===t?((0,l.wg)(),(0,l.iD)("div",d,"-")):((0,l.wg)(),(0,l.iD)("div",{key:1,style:(0,i.j5)(c.filterColor(e.row.topicListList[a].topicList[t]))},(0,i.zw)(e.row.topicListList[a].topicList[t].hitScore),5))])),_:2},1032,["prop","label"])))),128))])),_:2},1032,["label"])))),128)),(0,l.Wm)(_,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,{text:"",type:"primary",size:"small",onClick:a=>c.viewPointTable(e.row.auditId)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1})}t(7658);var m={emits:["initData"],name:"PlanUserList",props:{},data(){return{dialog:{save:!1},open:!1,tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",marketingDepartmentName:"",sysMarkScorePlanId:this.$route.query.id},size:10},statusList:[{label:"待处理",value:1},{label:"已处理",value:2},{label:"已截止",value:3}],headList:[]}},watch:{},mounted(){},methods:{filterColor(e){let a="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(a="color: red;"):e.hitScore<e.score&&(a="color: red;"),a},changeCellStyle({row:e,column:a}){if(2===a.level){const[t,l]=a.property.split("_"),{status:i}=e.topicListList[t].topicList[l];if(i&&0===i)return{background:"#ffc327"};if(i&&1===i)return{background:"#b6f3ca"};if(i&&2===i)return{background:"#fbcbcb"};if(i&&3===i)return{background:"#91d5ff"}}},filterType(e,a){return a?.find((a=>a.value===e))?.label||"-"},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break;case 3:a="info";break}return a},initData(){this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",marketingDepartmentName:"",sysMarkScorePlanId:this.$route.query.id},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/appealTable",query:{id:e}})},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.DistrictMarketBranch.GetAllData.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.headList=this.getHead(e.data.list?.[0]?.topicListList),this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},getHead(e){return e?e&&e.length>0?e.map((e=>({label:e.className,children:e.topicList.map((e=>({label:e.name})))}))):void 0:[]},upsearch(e){e&&(this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",marketingDepartmentName:"",sysMarkScorePlanId:this.$route.query.id},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},c=t(3744);const p=(0,c.Z)(m,[["render",u],["__scopeId","data-v-68924c1d"]]);var h=p},8364:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var l=t(6252),i=t(3577);const s={class:"left-panel"},o={class:"right-panel"},n={class:"right-panel-search",style:{margin:"5px 0"}};function r(e,a,t,r,d,u){const m=(0,l.up)("el-input"),c=(0,l.up)("el-form-item"),p=(0,l.up)("el-col"),h=(0,l.up)("el-row"),f=(0,l.up)("el-option"),g=(0,l.up)("el-select"),w=(0,l.up)("el-form"),b=(0,l.up)("el-button"),y=(0,l.up)("el-header"),_=(0,l.up)("el-table-column"),v=(0,l.up)("el-tag"),k=(0,l.up)("el-button-group"),W=(0,l.up)("scTable"),I=(0,l.up)("el-main"),S=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(w,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{gutter:20,style:{width:"85%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入店铺名称",modelValue:d.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>d.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入客户经理名称",modelValue:d.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[1]||(a[1]=e=>d.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"分数筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"最低分数",modelValue:d.queryInfo.paramData.startScore,"onUpdate:modelValue":a[2]||(a[2]=e=>d.queryInfo.paramData.startScore=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{span:2,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Uk)("~")])),_:1}),(0,l.Wm)(p,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"最高分数",modelValue:d.queryInfo.paramData.endScore,"onUpdate:modelValue":a[3]||(a[3]=e=>d.queryInfo.paramData.endScore=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入专卖许可证号",modelValue:d.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[4]||(a[4]=e=>d.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入所属市场部",modelValue:d.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[5]||(a[5]=e=>d.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"处理状态："},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{placeholder:"请选择处理状态",clearable:"",modelValue:d.queryInfo.paramData.auditStatus,"onUpdate:modelValue":a[6]||(a[6]=e=>d.queryInfo.paramData.auditStatus=e),style:{width:"100%"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.statusList,((e,a)=>((0,l.wg)(),(0,l.j4)(f,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",o,[(0,l._)("div",n,[(0,l.Wm)(b,{type:"default",onClick:a[7]||(a[7]=e=>u.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(b,{type:"primary",onClick:a[8]||(a[8]=e=>u.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(I,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{ref:"table",data:d.tableData,height:"520px",staticTotal:d.total,onPaginationChange:u.paginationChange,onPageSizeChange:u.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:u.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(_,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"申诉项",prop:"appealCount","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"已处理",prop:"processedCount","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"处理状态",prop:"processedCount","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(v,{type:u.filterStatus(e.row.auditStatus)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(u.filterType(e.row.auditStatus,d.statusList)),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(_,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,{text:"",type:"primary",size:"small",onClick:a=>u.viewPointTable(e.row.auditId)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1})}t(7658);var d={emits:["initData"],name:"PlanUserList",props:{},data(){return{dialog:{save:!1},open:!1,tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",auditStatus:"",sysMarkScorePlanId:this.$route.query.id},size:10},statusList:[{label:"待处理",value:1},{label:"已处理",value:2},{label:"已截止",value:3}]}},watch:{},mounted(){},methods:{filterType(e,a){return a?.find((a=>a.value===e))?.label||"-"},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break;case 3:a="info";break}return a},initData(){this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",auditStatus:"",sysMarkScorePlanId:this.$route.query.id},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/appealTable",query:{id:e}})},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanAudit.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",auditStatus:"",sysMarkScorePlanId:this.$route.query.id},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},u=t(3744);const m=(0,u.Z)(d,[["render",r],["__scopeId","data-v-c15aab3e"]]);var c=m},3953:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(6252),i=t(3577);const s={class:"left-panel"},o={class:"right-panel"},n={class:"right-panel-search",style:{margin:"5px 0"}},r=["title"],d={key:0};function u(e,a,t,u,m,c){const p=(0,l.up)("el-input"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-col"),g=(0,l.up)("el-row"),w=(0,l.up)("el-option"),b=(0,l.up)("el-select"),y=(0,l.up)("el-form"),_=(0,l.up)("el-button"),v=(0,l.up)("el-header"),k=(0,l.up)("el-table-column"),W=(0,l.up)("el-tooltip"),I=(0,l.up)("el-button-group"),S=(0,l.up)("scTable"),D=(0,l.up)("el-main"),C=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(C,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(y,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{gutter:20,style:{width:"70%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入店铺名称",modelValue:m.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>m.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入客户经理名称",modelValue:m.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[1]||(a[1]=e=>m.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"分数筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"最低分数",modelValue:m.queryInfo.paramData.startScore,"onUpdate:modelValue":a[2]||(a[2]=e=>m.queryInfo.paramData.startScore=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f,{span:2,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Uk)("~")])),_:1}),(0,l.Wm)(f,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"最高分数",modelValue:m.queryInfo.paramData.endScore,"onUpdate:modelValue":a[3]||(a[3]=e=>m.queryInfo.paramData.endScore=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入所属营销部",modelValue:m.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[4]||(a[4]=e=>m.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Uk)(),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入所属市场部",modelValue:m.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[5]||(a[5]=e=>m.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"标记项筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{placeholder:"请选择标记状态",clearable:"",modelValue:m.queryInfo.paramData.tab,"onUpdate:modelValue":a[6]||(a[6]=e=>m.queryInfo.paramData.tab=e),style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{label:"有标记",value:"1"}),(0,l.Wm)(w,{label:"无标记",value:"0"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),m.open?((0,l.wg)(),(0,l.j4)(f,{key:0,xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"数据范围："},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{placeholder:"请选择数据范围",clearable:"",modelValue:m.queryInfo.paramData.dataRange,"onUpdate:modelValue":a[7]||(a[7]=e=>m.queryInfo.paramData.dataRange=e),style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{label:"申诉至调研公司",value:"1"})])),_:1},8,["modelValue"])])),_:1})])),_:1})):(0,l.kq)("",!0),m.open?((0,l.wg)(),(0,l.j4)(f,{key:1,xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{placeholder:"请输入专卖许可证号",modelValue:m.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[8]||(a[8]=e=>m.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1})):(0,l.kq)("",!0)])),_:1})])),_:1})]),(0,l._)("div",o,[(0,l._)("div",n,[(0,l.Wm)(_,{type:"default",onClick:a[9]||(a[9]=e=>c.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(_,{type:"primary",onClick:a[10]||(a[10]=e=>c.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1}),(0,l._)("div",{class:"openBtn",onClick:a[11]||(a[11]=e=>m.open=!m.open)},(0,i.zw)(m.open?"收起":"展开"),1)])])])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.colorList,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"color-item",key:a},[(0,l._)("div",{class:"block",style:(0,i.j5)({"--background":e.color})},null,4),(0,l.Uk)(" "+(0,i.zw)(e.label),1)])))),128))])),_:1}),(0,l.Wm)(D,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{ref:"table",data:m.tableData,height:"520px",staticTotal:m.total,onPaginationChange:c.paginationChange,onPageSizeChange:c.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:c.getDataList,"cell-style":c.changeCellStyle},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(k,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.headList,((e,a)=>((0,l.wg)(),(0,l.j4)(k,{key:a,label:e.label,align:"center"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.headList[a].children,((e,t)=>((0,l.wg)(),(0,l.j4)(k,{"min-width":"120",key:t,prop:`${a}_${t}`,align:"center",label:e.label},{header:(0,l.w5)((()=>[(0,l.Wm)(W,{effect:"dark",content:e.label,placement:"top"},{default:(0,l.w5)((()=>[(0,l._)("div",{title:e.label,class:"tbHead"},(0,i.zw)(e.label),9,r)])),_:2},1032,["content"])])),default:(0,l.w5)((e=>[0===a||1===a&&0===t?((0,l.wg)(),(0,l.iD)("div",d,"-")):((0,l.wg)(),(0,l.iD)("div",{key:1,style:(0,i.j5)(c.filterColor(e.row.topicListList[a].topicList[t]))},(0,i.zw)(e.row.topicListList[a].topicList[t].hitScore),5))])),_:2},1032,["prop","label"])))),128))])),_:2},1032,["label"])))),128)),(0,l.Wm)(k,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{text:"",type:"primary",size:"small",onClick:a=>c.viewPointTable(e.row.auditId)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh","cell-style"])])),_:1})])),_:1})}t(7658);var m={emits:["initData"],name:"PlanUserList",props:{},data(){return{dialog:{save:!1},open:!1,tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{accountManagerName:"",businessShopName:"",dataRange:"",endScore:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",startScore:"",tab:"",sysMarkScorePlanId:this.$route.query.id},size:10},statusList:[{label:"待处理",value:1},{label:"已处理",value:2},{label:"已截止",value:3}],headList:[],colorList:[{label:"该项申诉调研公司未处理",color:"#ffc327"},{label:"该项申诉调研公司已通过",color:"#23994a"},{label:"该项申诉调研公司已驳回",color:"#ff2727"},{label:"该项申诉被调研公司修改",color:"#7b18ff"},{label:"该项申诉区局（市场部、营销部）超时未处理",color:"#2780ff"},{label:"该项申诉已被区局（市场部、营销部）驳回",color:"#d9d9d9"}]}},watch:{},mounted(){},methods:{filterColor(e){let a="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(a="color: red;"):e.hitScore<e.score&&(a="color: red;"),a},changeCellStyle({row:e,column:a}){if(2===a.level){const[t,l]=a.property.split("_"),{status:i}=e.topicListList[t].topicList[l];if(0===i)return{background:"#ffc327"};if(1===i)return{background:"#b6f3ca"};if(2===i)return{background:"#fbcbcb"};if(3===i)return{background:"#b98bf5"};if(4===i)return{background:"#91d5ff"};if(5===i)return{background:"#d7d7d7"}}},filterType(e,a){return a?.find((a=>a.value===e))?.label||"-"},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break;case 3:a="info";break}return a},initData(){this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",marketingDepartmentName:"",sysMarkScorePlanId:this.$route.query.id},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/appealTable",query:{id:e}})},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.DistrictMarketBranch.GetAllData.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.headList=this.getHead(e.data.list?.[0]?.topicListList),this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},getHead(e){return e?e&&e.length>0?e.map((e=>({label:e.className,children:e.topicList.map((e=>({label:e.name})))}))):void 0:[]},upsearch(e){e&&(this.queryInfo={current:1,paramData:{accountManagerName:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",organizationName:"",marketingDepartmentName:"",sysMarkScorePlanId:this.$route.query.id},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},c=t(3744);const p=(0,c.Z)(m,[["render",u],["__scopeId","data-v-1805c44f"]]);var h=p},9889:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var l=t(6252),i=t(3577);const s={class:"left-panel"},o={class:"right-panel"},n={class:"right-panel-search",style:{margin:"5px 0"}};function r(e,a,t,r,d,u){const m=(0,l.up)("el-input"),c=(0,l.up)("el-form-item"),p=(0,l.up)("el-col"),h=(0,l.up)("el-row"),f=(0,l.up)("el-option"),g=(0,l.up)("el-select"),w=(0,l.up)("el-form"),b=(0,l.up)("el-button"),y=(0,l.up)("el-header"),_=(0,l.up)("el-table-column"),v=(0,l.up)("el-tag"),k=(0,l.up)("el-button-group"),W=(0,l.up)("scTable"),I=(0,l.up)("el-main"),S=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",s,[(0,l.Wm)(w,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{gutter:20,style:{width:"70%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入店铺名称",modelValue:d.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>d.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入客户经理名称",modelValue:d.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[1]||(a[1]=e=>d.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"分数筛选："},{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"最低分数",modelValue:d.queryInfo.paramData.startScore,"onUpdate:modelValue":a[2]||(a[2]=e=>d.queryInfo.paramData.startScore=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{span:2,style:{"text-align":"center"}},{default:(0,l.w5)((()=>[(0,l.Uk)("~")])),_:1}),(0,l.Wm)(p,{span:11},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"最高分数",modelValue:d.queryInfo.paramData.endScore,"onUpdate:modelValue":a[3]||(a[3]=e=>d.queryInfo.paramData.endScore=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"处理状态："},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{placeholder:"请选择处理状态",clearable:"",modelValue:d.queryInfo.paramData.auditStatus,"onUpdate:modelValue":a[4]||(a[4]=e=>d.queryInfo.paramData.auditStatus=e),style:{width:"100%"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.statusList,((e,a)=>((0,l.wg)(),(0,l.j4)(f,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入区营销部",modelValue:d.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[5]||(a[5]=e=>d.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(p,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入区市场部",modelValue:d.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[6]||(a[6]=e=>d.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),d.open?((0,l.wg)(),(0,l.j4)(p,{key:0,xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{label:"许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"请输入专卖许可证号",modelValue:d.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[7]||(a[7]=e=>d.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1})):(0,l.kq)("",!0)])),_:1})])),_:1})]),(0,l._)("div",o,[(0,l._)("div",n,[(0,l.Wm)(b,{type:"default",onClick:a[8]||(a[8]=e=>u.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(b,{type:"primary",onClick:a[9]||(a[9]=e=>u.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1}),(0,l._)("div",{class:"openBtn",onClick:a[10]||(a[10]=e=>d.open=!d.open)},(0,i.zw)(d.open?"收起":"展开"),1)])])])),_:1}),(0,l.Wm)(I,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{ref:"table",data:d.tableData,height:"520px",staticTotal:d.total,onPaginationChange:u.paginationChange,onPageSizeChange:u.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:u.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(_,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(_,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"申诉项",prop:"appealCount","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"已处理",prop:"processedCount","min-width":"100",align:"center"}),(0,l.Wm)(_,{label:"处理状态",prop:"processedCount","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(v,{type:u.filterStatus(e.row.auditStatus)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(u.filterType(e.row.auditStatus,d.statusList)),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(_,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,{text:"",type:"primary",size:"small",onClick:a=>u.viewPointTable(e.row.auditId)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1})}t(7658);var d={emits:["initData"],name:"PlanUserList",props:{},data(){return{dialog:{save:!1},open:!1,tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{accountManagerName:"",auditStatus:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",sysMarkScorePlanId:this.$route.query.id},size:10},statusList:[{label:"待处理",value:1},{label:"已处理",value:2},{label:"已截止",value:3}]}},watch:{},mounted(){},methods:{filterType(e,a){return a?.find((a=>a.value===e))?.label||"-"},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break;case 3:a="info";break}return a},initData(){this.queryInfo={current:1,paramData:{accountManagerName:"",auditStatus:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",sysMarkScorePlanId:this.$route.query.id},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/appealTable",query:{id:e}})},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanAudit.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{accountManagerName:"",auditStatus:"",businessShopName:"",endScore:"",retailLicenseNumber:"",startScore:"",sysMarkScorePlanId:this.$route.query.id},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},u=t(3744);const m=(0,u.Z)(d,[["render",r],["__scopeId","data-v-6dce23ce"]]);var c=m},2433:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return f}});var l=t(6252),i=t(3577);const s={key:0},o={key:0},n={key:1},r={key:2},d={key:3},u={key:0};function m(e,a,t,m,c,p){const h=(0,l.up)("el-radio"),f=(0,l.up)("el-radio-group"),g=(0,l.up)("el-form-item"),w=(0,l.up)("el-input"),b=(0,l.up)("el-form"),y=(0,l.up)("el-button"),_=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(_,{modelValue:c.visible,"onUpdate:modelValue":a[4]||(a[4]=e=>c.visible=e),title:"申诉",class:"answer","close-on-click-modal":!1,"close-on-press-escape":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[5]||(a[5]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(y,{autoInsertSpace:"",onClick:a[2]||(a[2]=e=>c.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1}),(0,l.Wm)(y,{autoInsertSpace:"",type:"primary",loading:c.isSaveing,onClick:a[3]||(a[3]=e=>p.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(b,{"label-position":"top",ref:"dialogForm",rules:c.rules,model:c.form},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{label:"是否通过审核:",class:"block_item",prop:"auditStatus"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:c.form.auditStatus,"onUpdate:modelValue":a[0]||(a[0]=e=>c.form.auditStatus=e),class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:1,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("通过")])),_:1}),(0,l.Wm)(h,{label:2,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("驳回")])),_:1})])),_:1},8,["modelValue"])])),_:1}),1===c.form.auditStatus?((0,l.wg)(),(0,l.iD)("div",s,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(c.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},[(0,l.Wm)(g,{label:e.name},{default:(0,l.w5)((()=>["BZXZZD_CLASS_07_TOPIC_01"===e.no?((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"陈列数≥40",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数≥40")])),_:1}),(0,l.Wm)(h,{label:"陈列数<40",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数<40")])),_:1}),(0,l.Wm)(h,{label:"无",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("无")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):"BZXZZD_CLASS_07_TOPIC_04"===e.no?((0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"陈列数≥30",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数≥30")])),_:1}),(0,l.Wm)(h,{label:"陈列数<30",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数<30")])),_:1}),(0,l.Wm)(h,{label:"无",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("无")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):1===e.type?((0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4",disabled:"BZXZZD_CLASS_01_TOPIC_01"===e.no},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:e.optionYes,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.optionYes),1)])),_:2},1032,["label"]),(0,l.Wm)(h,{label:e.optionNo,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.optionNo),1)])),_:2},1032,["label"])])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])):2===e.type?((0,l.wg)(),(0,l.iD)("div",d,[(0,l.Wm)(w,{min:"0",type:"number",modelValue:e.count,"onUpdate:modelValue":a=>e.count=a},null,8,["modelValue","onUpdate:modelValue"])])):(0,l.kq)("",!0)])),_:2},1032,["label"])])))),128)),c.queryOptions.length&&"BZXZZD_CLASS_02_TOPIC_01"===c.queryOptions[0].no&&"是"===c.queryOptions[0].selectOption?((0,l.wg)(),(0,l.iD)("div",u,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(c.formList,((e,a)=>((0,l.wg)(),(0,l.j4)(g,{key:a,label:e.label},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:e.whether,"onUpdate:modelValue":a=>e.whether=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"是",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("是")])),_:1}),(0,l.Wm)(h,{label:"否",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("否")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])))),128))])):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,l.Wm)(g,{label:"审核理由:",class:"block_item",prop:"auditRemark"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{type:"textarea",placeholder:"请输入审核理由",maxlength:"200","show-word-limit":"",modelValue:c.form.auditRemark,"onUpdate:modelValue":a[1]||(a[1]=e=>c.form.auditRemark=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","model"])])),_:1},8,["modelValue"])}var c={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:{auditStatus:1,auditRemark:"",resultId:0},queryOptions:[],rules:{auditRemark:[{required:!0,message:"请输入审核理由，字数不超过200",trigger:["change","blur"]}],auditStatus:[{required:!0,message:"请选择是否通过审核",trigger:["change","blur"]}]},loading:!1,formList:[{label:"店招是否被污损",topicNo:"BZXZZD_CLASS_02_TOPIC_02",whether:""},{label:"店招是否被遮挡",topicNo:"BZXZZD_CLASS_02_TOPIC_03",whether:""}]}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add",a){return this.mode=e,this.visible=!0,this.form.resultId=a,this},async submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;{this.isSaveing=!0;let e,{auditStatus:a,auditRemark:t,resultId:l}=this.form,i=this.queryOptions.map((e=>{let a={topicNo:e.no,whether:e.selectOption},t={quantity:e.count,topicNo:e.no};return 1===e.type?a:t}));if(e=i.length&&"BZXZZD_CLASS_02_TOPIC_01"===i[0].topicNo&&"是"===i[0].whether?[...i,...this.form]:i,e.find((e=>""===e.whether)))return this.$message.warning("请检查数据是否填写完整"),void(this.isSaveing=!1);let s={auditRemark:t,auditStatus:a,resultId:l,scoreBoList:e,topicNo:this.queryOptions.map((e=>e.no)).join("-"),topicType:this.combineInfo.combineStatus},o=await this.$API.researchInfo.ResearchCompany.AuditAppeal.post(s);this.isSaveing=!1,200==o.code?(this.$emit("success",o.data),this.visible=!1,this.$message.success("操作成功")):this.$alert(o.message,"提示",{type:"error"})}}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))}}},p=t(3744);const h=(0,p.Z)(c,[["render",m],["__scopeId","data-v-82d37ad4"]]);var f=h},9420:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);const i={class:"box"};function s(e,a,t,s,o,n){const r=(0,l.up)("el-form-item"),d=(0,l.up)("el-image"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"查看",modelValue:o.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>o.visible=e),class:"answer","show-close":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{autoInsertSpace:"",type:"primary",onClick:a[4]||(a[4]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"基础照片",class:"block_item"}),(0,l._)("div",i,[(0,l.Wm)(r,{label:`门头照片（${t.detail.doorheadImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.doorheadImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`许可证照片（${t.detail.licenceImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.licenceImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`室内环境（${t.detail.indoorImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[2]||(a[2]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.indoorImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`其他（${t.detail.otherImage.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[3]||(a[3]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.otherImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1})])])),_:1})])),_:1},8,["modelValue"])}var o={emits:["success","closed"],props:{detail:{type:Object,default:()=>{}}},data(){return{id:this.$route.query.id,visible:!1,isSaveing:!1,queryOptions:[],loading:!1,openPre:!1}},mounted(){},computed:{},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if("el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},open(){return this.visible=!0,this}}},n=t(3744);const r=(0,n.Z)(o,[["render",s],["__scopeId","data-v-ce3d1f9a"]]);var d=r},6769:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),i=t(3577);const s={class:"box"},o={key:0},n={style:{width:"80%","margin-left":"5px"}},r={class:"audit_name"},d={class:"audit_name"},u={class:"audit_name"},m={class:"audit_name"},c={class:"audit_name"},p={class:"audit_name"},h={class:"audit_name"},f={class:"audit_name"};function g(e,a,t,g,w,b){const y=(0,l.up)("el-form-item"),_=(0,l.up)("el-col"),v=(0,l.up)("el-row"),k=(0,l.up)("el-image"),W=(0,l.up)("el-divider"),I=(0,l.up)("el-card"),S=(0,l.up)("el-timeline-item"),D=(0,l.up)("el-timeline"),C=(0,l.up)("el-button"),U=(0,l.up)("el-dialog"),V=(0,l.up)("openAppeal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(U,{title:w.titleMap[w.mode],class:"answer",modelValue:w.visible,"onUpdate:modelValue":a[4]||(a[4]=e=>w.visible=e),width:700,"align-center":"","destroy-on-close":"",onClosed:a[5]||(a[5]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[b.filteShow(b.combineInfo)?((0,l.wg)(),(0,l.j4)(C,{key:0,autoInsertSpace:"",onClick:a[2]||(a[2]=e=>b.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("审核")])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(C,{autoInsertSpace:"",type:"primary",onClick:a[3]||(a[3]=e=>w.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"评分情况"}),(0,l._)("div",s,[(0,l.Wm)(y,{label:"检查要点:",class:"block_item"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},(0,i.zw)(e.name),1)))),128))])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"分值:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(b.isCombine?b.combineInfo.combineScore:b.combineInfo.score),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"得分:"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(b.filterColor(b.combineInfo))},(0,i.zw)(b.isCombine?b.combineInfo.combineHitScore:b.combineInfo.hitScore),5)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(y,{label:"回答:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(b.filterColor(b.combineInfo,!0))},(0,i.zw)(b.answer(w.queryOptions)),5)])),_:1}),(0,l.Wm)(y,{label:`照片（${b.combineInfo.url.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>b.clickImage&&b.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(b.combineInfo.url,((e,a)=>((0,l.wg)(),(0,l.j4)(k,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:b.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(y,{label:"备注:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.combineInfo.userRemark),1)])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"最新修改人账号:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(b.combineInfo.updateAccount||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"最新修改时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(b.combineInfo.updateTime||"-"),1)])),_:1})])),_:1})])),_:1}),w.isShowTime?((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Uk)("申诉情况")])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"申诉人："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.auditUserName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.marketingDepartmentName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.organizationName),1)])),_:1})])),_:1}),(0,l.Wm)(_,{span:24},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"申诉理由："},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(w.auditInfo.auditCircumstances.auditRemark),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(y,{label:`照片（${w.auditInfo.auditCircumstances.auditImageList.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>b.clickImage&&b.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.auditInfo.auditCircumstances.auditImageList,((e,a)=>((0,l.wg)(),(0,l.j4)(k,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:b.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l._)("div",n,[(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.auditInfo.auditList,((e,a)=>((0,l.wg)(),(0,l.j4)(S,{type:"success",key:a,timestamp:b.filterTime(e),placement:"top"},{default:(0,l.w5)((()=>[1===e.auditUserType?((0,l.wg)(),(0,l.j4)(I,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"客户经理:"},{default:(0,l.w5)((()=>[(0,l._)("div",r,(0,i.zw)(e.auditUserName),1),(0,l.Uk)(" 发起申诉 ")])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),[2,3].includes(e.auditUserType)?((0,l.wg)(),(0,l.j4)(I,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"审核结果:"},{default:(0,l.w5)((()=>[(0,l._)("div",{class:"audit_name",style:(0,i.j5)(b.filterStyle(e))},(0,i.zw)(b.filterStatus(e.auditStatus)),5)])),_:2},1024),(0,l.Wm)(y,{label:"审核人:"},{default:(0,l.w5)((()=>[(0,l._)("div",d,(0,i.zw)(e.auditUserName),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核理由:"},{default:(0,l.w5)((()=>[(0,l._)("div",u,(0,i.zw)(e.auditRemark),1)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),4===e.auditUserType?((0,l.wg)(),(0,l.j4)(I,{key:2},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"审核结果:"},{default:(0,l.w5)((()=>[(0,l._)("div",m,(0,i.zw)(b.filterStatus(e.auditStatus)),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核人:"},{default:(0,l.w5)((()=>[(0,l._)("div",c,(0,i.zw)(e.auditUserName),1)])),_:2},1024),(0,l.Wm)(y,{label:"审核理由:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(e.auditRemark),1)])),_:2},1024),(0,l.Wm)(y,{label:"回答更新:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,(0,i.zw)(e.updateResult),1)])),_:2},1024),(0,l.Wm)(y,{label:"得分更新:"},{default:(0,l.w5)((()=>[(0,l._)("div",f,(0,i.zw)(e.updateScore),1)])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0)])),_:2},1032,["timestamp"])))),128))])),_:1})])])):(0,l.kq)("",!0)])])),_:1},8,["title","modelValue"]),w.dialog.appeal?((0,l.wg)(),(0,l.j4)(V,{key:0,ref:"openAppeal",onSuccess:b.handleSaveSuccess,onClose:a[6]||(a[6]=e=>w.dialog.appeal=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var w=t(2433),b={emits:["success","closed"],components:{openAppeal:w["default"]},data(){return{id:this.$route.query.id,resultId:"",mode:"add",titleMap:{add:"查看"},dialog:{appeal:!1},auditInfo:{auditCircumstances:{auditImageList:[]},auditList:[]},visible:!1,isSaveing:!1,form:{},queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1,openPre:!1,isShowTime:!1,statusList:[{label:"未处理",value:0},{label:"通过",value:1},{label:"驳回",value:2},{label:"超时未处理",value:3},{label:"调研公司修改",value:4}]}},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{filterStatus(e){return this.statusList?.find((a=>a.value===e))?.label||"-"},filterStyle(e){let a="";switch(e.auditUserType){case 2:case 3:a="color:"+([2,3].includes(e.auditStatus)?"red":"#399C4E");break}return a},filterTime(e){let a="";switch(e.auditUserType){case 1:a=`已发起申诉，待公布结果 ${e.auditTime}`;break;case 2:a=`区市场部审核结果 ${e.auditTime}`;break;case 3:a=`区营销部审核结果 ${e.auditTime}`;break;case 4:a=`调研公司审核结果 ${e.auditTime}`;break}return a},answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if(console.log(e),"el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0]?.appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},filteShow(e){let a=!1;return 1===e.combineStatus?e.combineHitScore<e.combineScore&&!e.status&&(a=!0):e.hitScore<e.score&&!e.status&&(a=!0),a},open(e="add",a){return this.mode=e,this.visible=!0,this.resultId=a,this},async getAuditDetail(){let e={topic:this.queryOptions.map((e=>e.no)).join("-")},a=await this.$API.researchInfo.DistrictMarketBranch.GetAppealDetail.get(this.resultId,e);200===a.code?(this.auditInfo=a.data,this.isShowTime=!0):this.isShowTime=!1},submit(){this.dialog.appeal=!0,this.$nextTick((()=>{this.$refs.openAppeal.open("add",this.resultId).setData(this.queryOptions)}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e)),this.getAuditDetail()},appealSuccess(){this.$parent.getDetail(this.id)},handleSaveSuccess(){this.combineInfo.status=1,this.getAuditDetail(),this.$parent.getDetail(this.id)}}},y=t(3744);const _=(0,y.Z)(b,[["render",g],["__scopeId","data-v-41797bb9"]]);var v=_},2493:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-date-picker"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-col"),u=(0,l.up)("el-row"),m=(0,l.up)("el-input"),c=(0,l.up)("el-form"),p=(0,l.up)("el-button"),h=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(h,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[8]||(a[8]=e=>s.visible=e),"align-center":"",width:800,"destroy-on-close":"",onClosed:a[9]||(a[9]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(p,{onClick:a[5]||(a[5]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),["add"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(p,{key:0,type:"primary",loading:s.isSaveing,onClick:a[6]||(a[6]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0),["edit"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(p,{key:1,type:"primary",loading:s.isSaveing,onClick:a[7]||(a[7]=e=>o.editData())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(c,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"180px"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"客户经理申诉起止时间:",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"accountManagerAppealStartTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{style:{width:"calc(100% - 10px)"},"value-format":"YYYY-MM-DD HH:mm:ss",disabled:"edit"===s.mode&&s.form.accountManagerAppealStartTime<new Date,modelValue:s.form.accountManagerAppealStartTime,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.accountManagerAppealStartTime=e),type:"datetime",placeholder:"开始时间"},null,8,["disabled","modelValue"])])),_:1})])),_:1}),(0,l.Wm)(d,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"accountManagerAppealEndTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm:ss",modelValue:s.form.accountManagerAppealEndTime,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.accountManagerAppealEndTime=e),type:"datetime",placeholder:"截止时间"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,{label:"区市场部审核截止时间:",prop:"districtMarketDeptAuditEndTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{style:{width:"calc(50% - 10px)"},"value-format":"YYYY-MM-DD HH:mm:ss",modelValue:s.form.districtMarketDeptAuditEndTime,"onUpdate:modelValue":a[2]||(a[2]=e=>s.form.districtMarketDeptAuditEndTime=e),type:"datetime",placeholder:"截止时间"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"区营销部审核截止时间:",prop:"districtMarketingDeptAuditEndTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{style:{width:"calc(50% - 10px)"},"value-format":"YYYY-MM-DD HH:mm:ss",modelValue:s.form.districtMarketingDeptAuditEndTime,"onUpdate:modelValue":a[3]||(a[3]=e=>s.form.districtMarketingDeptAuditEndTime=e),type:"datetime",placeholder:"截止时间"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"免申诉分数:",prop:"appealFreeScore"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{style:{width:"calc(50% - 10px)"},placeholder:"请输入免申请分数",modelValue:s.form.appealFreeScore,"onUpdate:modelValue":a[4]||(a[4]=e=>s.form.appealFreeScore=e)},{prefix:(0,l.w5)((()=>[(0,l.Uk)(" ≥ ")])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s=t(2787),o={emits:["success","closed"],props:{},data(){return{mode:"add",titleMap:{add:"开启申诉",edit:"编辑"},visible:!1,isSaveing:!1,id:"",form:{accountManagerAppealStartTime:"",accountManagerAppealEndTime:"",districtMarketDeptAuditEndTime:"",districtMarketingDeptAuditEndTime:"",appealFreeScore:""},rules:{accountManagerAppealStartTime:[{required:!0,message:"请选择开始时间"}],accountManagerAppealEndTime:[{required:!0,message:"请选择截止时间"},{validator:(e,a,t)=>{a<=this.form.accountManagerAppealStartTime?t(new Error("截止时间不能小于开始时间")):a<(new Date).format("yyyy-MM-dd hh:mm:ss")&&t(new Error("截止时间不能小于当前时间")),t()},trigger:["change","blur"]}],districtMarketDeptAuditEndTime:[{required:!0,message:"请选择截止时间"},{validator:(e,a,t)=>{a<=this.form.accountManagerAppealEndTime&&t(new Error("区市场部审核截止时间，不得小于客户经理申诉截止时间")),t()},trigger:["change","blur"]}],districtMarketingDeptAuditEndTime:[{required:!0,message:"请选择截止时间"},{validator:(e,a,t)=>{a<=this.form.districtMarketDeptAuditEndTime&&t(new Error("区营销部审核截止时间，不得小于区市场部审核截止时间")),t()},trigger:["change","blur"]}],appealFreeScore:[{required:!0,message:"请输入免申请分数"},{validator:s.C$,trigger:["change","blur"]},{validator:(e,a,t)=>{"edit"===this.mode&&Number(a)<Number(this.form.appealFreeScoreYou)&&t(new Error("免申诉分数只能大于等于之前的值")),t()}}]},loading:!1}},mounted(){},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.OpenAppeal.post(this.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}}))},editData(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.UpdateAppeal.post(this.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}}))},async setData(e,a){this.id=e,this.form=Object.assign({},a)}}},n=t(3744);const r=(0,n.Z)(o,[["render",i],["__scopeId","data-v-2635085c"]]);var d=r},1388:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return g}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-70719a3b"),e=e(),(0,l.Cn)(),e),o={class:"left-panel"},n={class:"right-panel"},r={class:"right-panel-search",style:{margin:"5px 0"}},d={class:"left-panel"},u=s((()=>(0,l._)("div",{class:"right-panel"},null,-1)));function m(e,a,t,s,m,c){const p=(0,l.up)("el-input"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-col"),g=(0,l.up)("el-radio-button"),w=(0,l.up)("el-radio-group"),b=(0,l.up)("el-row"),y=(0,l.up)("el-button"),_=(0,l.up)("el-header"),v=(0,l.up)("el-table-column"),k=(0,l.up)("el-switch"),W=(0,l.up)("scTable"),I=(0,l.up)("el-main"),S=(0,l.up)("el-container"),D=(0,l.up)("user-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(b,{gutter:20},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"调研人员："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.surveyUserName,"onUpdate:modelValue":a[0]||(a[0]=e=>m.queryInfo.paramData.surveyUserName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"联系方式："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.surveyUserPhone,"onUpdate:modelValue":a[1]||(a[1]=e=>m.queryInfo.paramData.surveyUserPhone=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"参与权："},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{modelValue:m.queryInfo.paramData.status,"onUpdate:modelValue":a[2]||(a[2]=e=>m.queryInfo.paramData.status=e),onChange:c.changeData},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{label:""},{default:(0,l.w5)((()=>[(0,l.Uk)("全部")])),_:1}),(0,l.Wm)(g,{label:1},{default:(0,l.w5)((()=>[(0,l.Uk)("启用")])),_:1}),(0,l.Wm)(g,{label:2},{default:(0,l.w5)((()=>[(0,l.Uk)("禁用")])),_:1})])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1})])),_:1})]),(0,l._)("div",n,[(0,l._)("div",r,[(0,l.Wm)(y,{type:"default",onClick:a[3]||(a[3]=e=>c.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(y,{type:"primary",onClick:a[4]||(a[4]=e=>c.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l.Wm)(y,{type:"primary",size:"default",onClick:c.add},{default:(0,l.w5)((()=>[(0,l.Uk)(" 新增人员 ")])),_:1},8,["onClick"])]),u])),_:1}),(0,l.Wm)(I,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{ref:"table",data:m.tableData,height:"520px",staticTotal:m.total,onPaginationChange:c.paginationChange,onPageSizeChange:c.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:c.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{label:"人员名称",prop:"surveyUserName","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"联系方式",prop:"surveyUserPhone","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"账号",prop:"surveyUserAccount","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"已完成调研数",prop:"surveysCount","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"状态",prop:"surveysUserIsDelete","min-width":"200",align:"center"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,i.zw)(e.row.surveysUserIsDelete?"已删除":"正常"),1)])),_:1}),(0,l.Wm)(v,{label:"添加人",prop:"createUserAccount","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"添加时间",prop:"createTime","min-width":"200",align:"center"}),(0,l.Wm)(v,{label:"参与权",prop:"disable","min-width":"100",align:"center",fixed:"right"},{default:(0,l.w5)((e=>[(0,l.Wm)(k,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,"inline-prompt":"","active-text":"启用","inactive-text":"禁用",onChange:a=>c.disableUser(a,e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),m.dialog.save?((0,l.wg)(),(0,l.j4)(D,{key:0,ref:"userDialog",onClosed:a[5]||(a[5]=e=>m.dialog.save=!1),onSuccess:c.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var c=t(5833),p={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{userDialog:c["default"]},data(){return{dialog:{save:!1},tableData:[],total:0,queryInfo:{current:1,paramData:{marketScorePlanId:"",surveyUserName:"",surveyUserPhone:"",status:""},size:10},statusList:[{label:"正常",value:1},{label:"禁用",value:2},{label:"已删除",value:3}]}},watch:{},mounted(){},methods:{initData(){this.queryInfo={current:1,paramData:{marketScorePlanId:this.marketScorePlanId,surveyUserName:"",surveyUserPhone:"",status:""},size:10},this.getDataList()},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.userDialog.open(this.marketScorePlanId)}))},filterType(e,a){return a.find((a=>a.value===e))?.label||"-"},changeData(e){this.queryInfo.paramData.status=e},async disableUser(e,a){this.$confirm(`确定${2===e?"禁用":"启用"}${a.surveyUserName}吗？`,"提示",{type:"warning"}).then((async()=>{const t=this.$loading();let l=await this.$API.researchInfo.ResearchCompany.UpdatePlanUserStatus.put(a.id,{status:e});200===l.code?(this.$message.success("操作成功"),this.getDataList()):this.$message.error(l.message),t.close()})).catch((()=>{this.$message.info("用户取消禁用"),a.status=2===e?1:2}))},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetJoinUserList.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo.paramData.surveyUserName="",this.queryInfo.paramData.surveyUserPhone="",this.queryInfo.paramData.status=""),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},h=t(3744);const f=(0,h.Z)(p,[["render",m],["__scopeId","data-v-70719a3b"]]);var g=f},9288:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var l=t(6252);const i={class:"left-panel"},s={class:"right-panel"},o={class:"right-panel-search",style:{margin:"5px 0"}};function n(e,a,t,n,r,d){const u=(0,l.up)("el-input"),m=(0,l.up)("el-form-item"),c=(0,l.up)("el-col"),p=(0,l.up)("el-row"),h=(0,l.up)("el-form"),f=(0,l.up)("el-button"),g=(0,l.up)("el-header"),w=(0,l.up)("el-table-column"),b=(0,l.up)("el-button-group"),y=(0,l.up)("scTable"),_=(0,l.up)("el-main"),v=(0,l.up)("el-container"),k=(0,l.up)("storeDialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(h,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{gutter:20,style:{width:"70%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>r.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>r.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[2]||(a[2]=e=>r.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[3]||(a[3]=e=>r.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[4]||(a[4]=e=>r.queryInfo.paramData.accountManagerName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(c,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{label:"调研人员："},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{modelValue:r.queryInfo.paramData.surveyUserName,"onUpdate:modelValue":a[5]||(a[5]=e=>r.queryInfo.paramData.surveyUserName=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",s,[(0,l._)("div",o,[(0,l.Wm)(f,{type:"default",onClick:a[6]||(a[6]=e=>d.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(f,{type:"primary",onClick:a[7]||(a[7]=e=>d.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(_,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{ref:"table",data:r.tableData,height:"520px",staticTotal:r.total,onPaginationChange:d.paginationChange,onPageSizeChange:d.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:d.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"客户经理",prop:"accountManagerName","min-width":"150",align:"center"}),(0,l.Wm)(w,{label:"分数",prop:"totalScore","min-width":"100",align:"center"}),(0,l.Wm)(w,{label:"调研人员",prop:"surveyUserName","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"完成时间",prop:"completionTime","min-width":"200",align:"center"}),(0,l.Wm)(w,{label:"操作",fixed:"right",align:"center","min-width":"155"},{default:(0,l.w5)((e=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{text:"",type:"primary",size:"small",onClick:a=>d.viewPointTable(e.row.id)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看评分表")])),_:2},1032,["onClick"]),(0,l.Wm)(f,{text:"",type:"primary",size:"small",onClick:a=>d.table_del(e.row,e.$index)},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),r.dialog.save?((0,l.wg)(),(0,l.j4)(k,{key:0,ref:"storeDialog",onClosed:a[8]||(a[8]=e=>r.dialog.save=!1),onSuccess:d.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}t(7658);var r=t(9177),d={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{storeDialog:r["default"]},data(){return{dialog:{save:!1},tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{businessShopName:"",accountManagerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:2,sysMarkScorePlanId:this.marketScorePlanId},size:10}}},watch:{},mounted(){},methods:{initData(){this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:2,sysMarkScorePlanId:this.marketScorePlanId},size:10},this.getDataList(),this.queryInfo.current=1,this.$refs.table.currentPage=1},viewPointTable(e){this.$router.push({path:"/researchInfo/pointTable/index",query:{id:e}})},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.storeDialog.open(this.marketScorePlanId)}))},async table_del(e){this.$confirm("是否删除当前打分记录？","删除提示",{type:"warning"}).then((async()=>{let a=await this.$API.researchInfo.ResearchCompany.DeletePlanSheet.delete(e.id);200==a.code?(this.getDataList(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanBusiness.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:2,sysMarkScorePlanId:this.marketScorePlanId},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},u=t(3744);const m=(0,u.Z)(d,[["render",n],["__scopeId","data-v-6273a856"]]);var c=m},634:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return w}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-e6022ede"),e=e(),(0,l.Cn)(),e),o={class:"left-panel"},n={class:"right-panel"},r={class:"right-panel-search",style:{margin:"5px 0"}},d={class:"left-panel"},u=s((()=>(0,l._)("div",{class:"right-panel"},null,-1)));function m(e,a,t,s,m,c){const p=(0,l.up)("el-input"),h=(0,l.up)("el-form-item"),f=(0,l.up)("el-col"),g=(0,l.up)("el-option"),w=(0,l.up)("el-select"),b=(0,l.up)("el-row"),y=(0,l.up)("el-form"),_=(0,l.up)("el-button"),v=(0,l.up)("el-header"),k=(0,l.up)("el-table-column"),W=(0,l.up)("el-tag"),I=(0,l.up)("el-popconfirm"),S=(0,l.up)("el-button-group"),D=(0,l.up)("scTable"),C=(0,l.up)("el-main"),U=(0,l.up)("el-container"),V=(0,l.up)("storeDialog"),q=(0,l.up)("upload-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,{class:"search"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(y,{"label-width":"110px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{gutter:20,style:{width:"70%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"店铺名称："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>m.queryInfo.paramData.businessShopName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"专卖许可证号："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>m.queryInfo.paramData.retailLicenseNumber=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"调研状态："},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{style:{width:"100%"},modelValue:m.queryInfo.paramData.status,"onUpdate:modelValue":a[2]||(a[2]=e=>m.queryInfo.paramData.status=e)},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{label:"全部",value:""}),(0,l.Wm)(g,{label:"未打分",value:1}),(0,l.Wm)(g,{label:"已完成",value:2})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属营销部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[3]||(a[3]=e=>m.queryInfo.paramData.marketingDepartmentName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"所属市场部："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[4]||(a[4]=e=>m.queryInfo.paramData.organizationName=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(f,{xs:24,sm:24,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户经理："},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:m.queryInfo.paramData.customerName,"onUpdate:modelValue":a[5]||(a[5]=e=>m.queryInfo.paramData.customerName=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})]),(0,l._)("div",n,[(0,l._)("div",r,[(0,l.Wm)(_,{type:"default",onClick:a[6]||(a[6]=e=>c.upsearch(!0))},{default:(0,l.w5)((()=>[(0,l.Uk)("重置")])),_:1}),(0,l.Wm)(_,{type:"primary",onClick:a[7]||(a[7]=e=>c.upsearch(!1))},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1})])])])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l.Wm)(_,{type:"primary",size:"default",onClick:c.add},{default:(0,l.w5)((()=>[(0,l.Uk)(" 添加店铺 ")])),_:1},8,["onClick"]),(0,l.Wm)(_,{type:"primary",size:"default",onClick:c.uploadImport},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量导入 ")])),_:1},8,["onClick"]),(0,l.Wm)(_,{type:"primary",disabled:0===m.selection.length,size:"default",onClick:c.batch_del},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量删除 ")])),_:1},8,["disabled","onClick"])]),u])),_:1}),(0,l.Wm)(C,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{ref:"table",data:m.tableData,height:"520px",staticTotal:m.total,onPaginationChange:c.paginationChange,onSelectionChange:c.selectionChange,onPageSizeChange:c.pageSizeChange,stripe:"",hideRefresh:"",onRefresh:c.getDataList},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{type:"selection","min-width":"50"}),(0,l.Wm)(k,{label:"店铺名称",prop:"businessShopName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"专卖许可证号",prop:"retailLicenseNumber","min-width":"150",align:"center"}),(0,l.Wm)(k,{label:"所属营销部",prop:"marketingDepartmentName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"所属市场部",prop:"organizationName","min-width":"200",align:"center"}),(0,l.Wm)(k,{label:"调研状态",prop:"status","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(W,{type:c.filterStatus(e.row.status)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(c.filterType(e.row.status,m.statusList)),1)])),_:2},1032,["type"])])),_:1}),(0,l.Wm)(k,{label:"店铺状态",prop:"businessStatus","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,i.zw)(c.filterType(e.row.businessStatus,m.businessStatusList)),1)])),_:1}),(0,l.Wm)(k,{label:"添加时间",prop:"createTime","min-width":"150",align:"center"}),(0,l.Wm)(k,{label:"操作",fixed:"right",align:"center","min-width":"100"},{default:(0,l.w5)((e=>[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(I,{title:"确定删除吗？",onConfirm:a=>c.table_del(e.row,e.$index)},{reference:(0,l.w5)((()=>[(0,l.Wm)(_,{text:"",type:"primary",size:"small"},{default:(0,l.w5)((()=>[(0,l.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})])),_:1},8,["data","staticTotal","onPaginationChange","onSelectionChange","onPageSizeChange","onRefresh"])])),_:1})])),_:1}),m.dialog.save?((0,l.wg)(),(0,l.j4)(V,{key:0,ref:"storeDialog",onClosed:a[8]||(a[8]=e=>m.dialog.save=!1),onSuccess:c.handleSuccess},null,8,["onSuccess"])):(0,l.kq)("",!0),m.dialog.upload?((0,l.wg)(),(0,l.j4)(q,{key:1,ref:"uploadDialog",onSuccess:c.handleSuccess,onClosed:a[9]||(a[9]=e=>m.dialog.upload=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var c=t(9177),p=t(1960),h={emits:["initData"],name:"PlanUserList",props:{marketScorePlanId:{type:String,default:""}},components:{storeDialog:c["default"],uploadDialog:p["default"]},data(){return{dialog:{save:!1,upload:!1},tableData:[],total:0,selection:[],queryInfo:{current:1,paramData:{businessShopName:"",customerName:"",customerPhone:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10},statusList:[{label:"未打分",value:1},{label:"已完成",value:2}],businessStatusList:[{label:"禁用",value:0},{label:"启用",value:1}]}},watch:{},mounted(){},methods:{uploadImport(){this.dialog.upload=!0,this.$nextTick((()=>{this.$refs.uploadDialog.open()}))},initData(){this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10},this.getDataList()},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.storeDialog.open(this.marketScorePlanId)}))},filterStatus(e){let a="";switch(e){case 1:a="warning";break;case 2:a="success";break}return a},filterType(e,a){return a.find((a=>a.value===e))?.label||"-"},paginationChange(e){this.queryInfo.current=e,this.getDataList()},pageSizeChange(e){this.queryInfo.size=e,this.getDataList()},selectionChange(e){this.selection=e},async table_del(e){this.$confirm("是否删除当前店铺？删除后该店铺会退出当前计划，本次计划相关打分记录将会同步删除；","删除提示",{type:"warning"}).then((async()=>{let a=await this.$API.researchInfo.ResearchCompany.DeletePlanBusiness.delete(e.id);200==a.code?(this.getDataList(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},async batch_del(){this.$confirm(`确定删除选中的 ${this.selection.length} 项吗？删除后 ${this.selection.length} 家店铺会退出当前计划，本次计划相关打分记录将会同步删除；`,"提示",{type:"warning"}).then((async()=>{const e=this.$loading();let a=await this.$API.researchInfo.ResearchCompany.BatchDeletePlanBusiness.delete(this.selection.map((e=>e.id)));200===a.code?(this.getDataList(),e.close(),this.$message.success("操作成功")):e.close()})).catch((e=>{console.log(e)}))},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.researchInfo.ResearchCompany.GetPlanBusiness.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},upsearch(e){e&&(this.queryInfo={current:1,paramData:{businessShopName:"",customerName:"",marketingDepartmentName:"",organizationName:"",retailLicenseNumber:"",surveyUserName:"",status:"",sysMarkScorePlanId:this.marketScorePlanId},size:10}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},handleSuccess(){this.getDataList()}}},f=t(3744);const g=(0,f.Z)(h,[["render",m],["__scopeId","data-v-e6022ede"]]);var w=g},9177:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-input"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-form"),u=(0,l.up)("el-button"),m=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(m,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>s.visible=e),width:500,"destroy-on-close":"",onClosed:a[4]||(a[4]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(u,{onClick:a[2]||(a[2]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(u,{type:"primary",loading:s.isSaveing,onClick:o.submit},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading","onClick"])])),default:(0,l.w5)((()=>[(0,l.Wm)(d,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"120px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"店铺名称",prop:"businessShopName"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.businessShopName,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.businessShopName=e),placeholder:"请输入店铺名称",clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(r,{label:"专卖许可证号",prop:"retailLicenseNumber"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.retailLicenseNumber=e),placeholder:"请输入专卖许可证号",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s={emits:["success","closed"],data(){return{mode:"add",titleMap:{add:"添加店铺"},visible:!1,isSaveing:!1,form:{sysMarkScorePlanId:"",businessShopName:"",retailLicenseNumber:""},rules:{businessShopName:[{required:!0,message:"请输入店铺名称"}],retailLicenseNumber:[{required:!0,message:"请输入专卖许可证号"}]}}},methods:{open(e){return this.form.sysMarkScorePlanId=e,this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.AddPlanBusiness.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},setData(e){Object.assign(this.form,e)}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-64823478"]]);var r=n},1960:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),i=t(3577);const s=e=>((0,l.dD)("data-v-6124fdd7"),e=e(),(0,l.Cn)(),e),o=s((()=>(0,l._)("div",{class:"ball"},"1",-1))),n=s((()=>(0,l._)("div",{class:"text"},"上传文件",-1))),r=s((()=>(0,l._)("div",{class:"ball"},"2",-1))),d=s((()=>(0,l._)("div",{class:"text"},"确认结果",-1))),u={key:0,class:"center"},m=s((()=>(0,l._)("div",{class:"el-upload__text"}," 点击或将文件拖拽到这里上传 ",-1))),c={key:1,class:"center"},p={class:"successText"},h={class:"errText"},f={key:0},g={key:1};function w(e,a,t,s,w,b){const y=(0,l.up)("el-col"),_=(0,l.up)("el-row"),v=(0,l.up)("el-icon-message-box"),k=(0,l.up)("el-icon"),W=(0,l.up)("sc-upload-file"),I=(0,l.up)("el-form-item"),S=(0,l.up)("el-form"),D=(0,l.up)("el-button"),C=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(C,{title:w.titleMap[w.mode],modelValue:w.visible,"onUpdate:modelValue":a[7]||(a[7]=e=>w.visible=e),width:700,"destroy-on-close":"",onClosed:a[8]||(a[8]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[1===w.active?((0,l.wg)(),(0,l.iD)("div",f,[(0,l.Wm)(D,{onClick:a[3]||(a[3]=e=>w.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(D,{type:"primary",disabled:!b.uploadStatus,onClick:a[4]||(a[4]=e=>b.changePage(2))},{default:(0,l.w5)((()=>[(0,l.Uk)("下一步")])),_:1},8,["disabled"])])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",g,[(0,l.Wm)(D,{onClick:a[5]||(a[5]=e=>b.changePage(1))},{default:(0,l.w5)((()=>[(0,l.Uk)("上一步")])),_:1}),(0,l.Wm)(D,{type:"primary",loading:w.isSaveing,onClick:a[6]||(a[6]=e=>b.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("提交结果")])),_:1},8,["loading"])])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:18,offset:3},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{style:{"margin-bottom":"24px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>0?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[o,n])),_:1},8,["style"]),(0,l.Wm)(y,{span:12,class:"line"}),(0,l.Wm)(y,{span:6,class:"title",style:(0,i.j5)(w.active>1?"opacity: 1":"opacity: 0.5")},{default:(0,l.w5)((()=>[r,d])),_:1},8,["style"])])),_:1}),1===w.active?((0,l.wg)(),(0,l.iD)("div",u,[(0,l.Wm)(S,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"上传文件：",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:(0,i.C_)({disUoloadSty:b.uploadStatus}),id:w.id,tip:"支持拓展名: .xls .xlsx",accept:".xls,.xlsx",modelValue:w.file,"onUpdate:modelValue":a[0]||(a[0]=e=>w.file=e),apiObj:w.apiObj,limit:1,drag:"",onRemove:b.onRemove,onSuccess:b.uploadSuccess},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{class:"el-icon--upload",style:{color:"rgb(24, 144, 255)"}},{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}),m])),_:1},8,["class","id","modelValue","apiObj","onRemove","onSuccess"])])),_:1})])),_:1}),(0,l.Wm)(S,{"label-position":"right"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"模板文件："},{default:(0,l.w5)((()=>[(0,l.Uk)(" 批量上传模版.xls "),(0,l._)("div",{class:"downLoad",onClick:a[1]||(a[1]=(...e)=>b.downLoadTemplate&&b.downLoadTemplate(...e))},"下载")])),_:1})])),_:1})])):(0,l.kq)("",!0),2===w.active?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(S,{"label-width":"150px"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{span:14,offset:5},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"可导入店铺数:"},{default:(0,l.w5)((()=>[(0,l._)("div",p,(0,i.zw)(w.uploadInfo.sureAddBusinessCount),1)])),_:1}),(0,l.Wm)(I,{label:"无法导入数:"},{default:(0,l.w5)((()=>[(0,l._)("div",h,[(0,l.Uk)((0,i.zw)(w.uploadInfo.failAddBusinessCount)+" ",1),w.uploadInfo.failAddBusinessCount?((0,l.wg)(),(0,l.iD)("div",{key:0,class:"downLoad",onClick:a[2]||(a[2]=(...e)=>b.downLoadErr&&b.downLoadErr(...e))},"下载失败信息")):(0,l.kq)("",!0)])])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["title","modelValue"])}var b={emits:["success","closed"],props:{marketList:{type:Array,default:()=>[]},businessList:{type:Array,default:()=>[]}},data(){return{id:this.$route.query.id,apiObj:this.$API.researchInfo.ResearchCompany.UploadImport,active:1,mode:"import",titleMap:{import:"批量添加店铺"},visible:!1,isSaveing:!1,file:[],uploadInfo:{fileName:"",importId:"",sureAddBusinessCount:0,failAddBusinessCount:0}}},mounted(){},computed:{uploadStatus({file:e}){return e.length>0}},methods:{open(e="import"){return this.mode=e,this.visible=!0,this},changePage(e){this.active=e},onRemove(){return this.uploadInfo={fileName:"",importId:"",sureAddBusinessCount:0,failAddBusinessCount:0},this.file=[],!0},uploadSuccess(e){const{fileName:a,importId:t}=e.data;return this.uploadInfo=e.data,this.file=[{name:a,url:t}],!1},async submit(){let e=await this.$API.researchInfo.ResearchCompany.ImportBusiness.get(this.id,{importId:this.uploadInfo.importId});200==e.code?(this.$emit("success",{},"import"),this.visible=!1,this.$message.success("导入成功")):this.$alert(e.message,"提示",{type:"error"})},async setData(e){Object.assign(this.form,e)},async downLoadTemplate(){let e=await this.$API.researchInfo.ResearchCompany.DownloadImportTemplate.get();const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","批量上传模版.xlsx"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},async downLoadErr(){let e=await this.$API.researchInfo.ResearchCompany.DownloadImportRES.get(this.uploadInfo.importId);const a=document.createElement("a");let t=new Blob([e],{type:"application/vnd.ms-excel"});a.style.display="none",a.href=URL.createObjectURL(t),a.setAttribute("download","失败信息.xlsx"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}},y=t(3744);const _=(0,y.Z)(b,[["render",w],["__scopeId","data-v-6124fdd7"]]);var v=_},5833:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-transfer"),r=(0,l.up)("el-button"),d=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(d,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>s.visible=e),width:605,"destroy-on-close":"",onClosed:a[4]||(a[4]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(r,{onClick:a[1]||(a[1]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(r,{type:"primary",loading:s.isSaveing,onClick:a[2]||(a[2]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(n,{modelValue:s.joinList,"onUpdate:modelValue":a[0]||(a[0]=e=>s.joinList=e),data:s.list,props:{key:"id",label:"name"}},null,8,["modelValue","data"])])])),_:1},8,["title","modelValue"])}t(7658);var s={emits:["success","closed"],data(){return{id:"",mode:"add",titleMap:{add:"选择参与人员",edit:"编辑店铺"},visible:!1,isSaveing:!1,loading:!1,list:[],joinList:[]}},mounted(){},methods:{open(e){return this.id=e,this.visible=!0,this.getDataList(),this},async submit(){this.isSaveing=!0;let e=[];this.joinList.forEach((a=>{let t={...this.list.find((e=>e.id===a)),sysMarkScorePlanId:this.id};e.push(t)}));var a=await this.$API.researchInfo.ResearchCompany.BatchAddJoinUser.post(e.map((e=>{let a={surveyUserAccount:e.account,surveyUserDisable:e.disable,surveyUserId:e.id,surveyUserName:e.name,surveyUserPhone:e.phone,sysMarkScorePlanId:e.sysMarkScorePlanId};return a})));this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})},async getDataList(){let e=await this.$API.researchInfo.ResearchCompany.GetUserCList.get(),a=await this.$API.researchInfo.ResearchCompany.GetJoinUserListNo.post({marketScorePlanId:this.id});this.list=e.data.filter((e=>-1===a.data.findIndex((a=>a.surveyUserId===e.id))))},filterMethod(e,a){return a.name.toLowerCase().includes(e.toLowerCase())},async setData(e){Object.assign(this.form,e)}}},o=t(3744);const n=(0,o.Z)(s,[["render",i],["__scopeId","data-v-67eee850"]]);var r=n},9471:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-input"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-option"),u=(0,l.up)("el-select"),m=(0,l.up)("el-col"),c=(0,l.up)("el-row"),p=(0,l.up)("el-date-picker"),h=(0,l.up)("el-radio"),f=(0,l.up)("el-radio-group"),g=(0,l.up)("el-form"),w=(0,l.up)("el-button"),b=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(b,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[13]||(a[13]=e=>s.visible=e),width:700,"destroy-on-close":"",onClosed:a[14]||(a[14]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(w,{onClick:a[10]||(a[10]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),["add"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(w,{key:0,type:"primary",loading:s.isSaveing,onClick:a[11]||(a[11]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0),["edit"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(w,{key:1,type:"primary",loading:s.isSaveing,onClick:a[12]||(a[12]=e=>o.editData())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(g,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"140px"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"计划名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.name=e),placeholder:"请输入计划名称",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1}),(0,l.Wm)(r,{label:"选择评分表",prop:"sysAppraiseSheetNo"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},modelValue:s.form.sysAppraiseSheetNo,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.sysAppraiseSheetNo=e),onChange:o.change,filterable:"",remote:"",clearable:"","reserve-keyword":"",placeholder:"请输入关键词",loading:s.loading,disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.sysAppraiseList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.name,value:e.no},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange","loading","disabled"])])),_:1}),(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"回收目标数",prop:"recoveryTargetCount"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.recoveryTargetCount,"onUpdate:modelValue":a[2]||(a[2]=e=>s.form.recoveryTargetCount=e),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"请输入回收目标数",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"回收阀数值",prop:"recoveryDoorsillCount"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{modelValue:s.form.recoveryDoorsillCount,"onUpdate:modelValue":a[3]||(a[3]=e=>s.form.recoveryDoorsillCount=e),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"请输入回收阀值",clearable:"",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"调研对象",prop:"researchObjectType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.researchObjectType,"onUpdate:modelValue":a[4]||(a[4]=e=>s.form.researchObjectType=e),filterable:"",placeholder:"请选择调研对象",disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.researchObjectList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"所属部门",prop:"deptType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.deptType,"onUpdate:modelValue":a[5]||(a[5]=e=>s.form.deptType=e),filterable:"",placeholder:"请选择所属部门",disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.deptList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"调研周期",prop:"researchPeriodType"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{style:{width:"100%"},clearable:"",modelValue:s.form.researchPeriodType,"onUpdate:modelValue":a[6]||(a[6]=e=>s.form.researchPeriodType=e),filterable:"",placeholder:"请选择调研周期",disabled:[4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.researchPeriodList,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,{label:"调研起止时间",required:""},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{style:{width:"100% !important"},gutter:10},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"startTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{style:{width:"100%"},modelValue:s.form.startTime,"onUpdate:modelValue":a[7]||(a[7]=e=>s.form.startTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"开始时间",disabled:[2,3,4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1}),(0,l.Wm)(m,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{prop:"endTime"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{style:{width:"100%"},modelValue:s.form.endTime,"onUpdate:modelValue":a[8]||(a[8]=e=>s.form.endTime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"结束时间",disabled:[4,5,6].includes(s.form.status)},null,8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(r,{label:"是否开启店铺限制",prop:"businessShopType"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:s.form.businessShopType,"onUpdate:modelValue":a[9]||(a[9]=e=>s.form.businessShopType=e),disabled:[2,3,4,5,6].includes(s.form.status)},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:2},{default:(0,l.w5)((()=>[(0,l.Uk)("是")])),_:1}),(0,l.Wm)(h,{label:1},{default:(0,l.w5)((()=>[(0,l.Uk)("否")])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s=t(2787),o={emits:["success","closed"],props:{deptList:{type:Array,default:()=>[]},researchObjectList:{type:Array,default:()=>[]},researchPeriodList:{type:Array,default:()=>[]}},data(){return{mode:"add",titleMap:{add:"新建打分计划",edit:"编辑店铺"},visible:!1,isSaveing:!1,apiObj:this.$API.researchInfo.ResearchCompany.GetAppraiseSheetList,form:{name:"",sysAppraiseSheetName:"",sysAppraiseSheetNo:"",recoveryTargetCount:"",recoveryDoorsillCount:"",researchObjectType:"",deptType:"",researchPeriodType:"",startTime:"",endTime:"",businessShopType:""},rules:{name:[{required:!0,message:"请输入店铺名称"}],sysAppraiseSheetNo:[{required:!0,message:"请选择评分表"}],recoveryTargetCount:[{required:!0,message:"请输入回收目标数"},{validator:s.C$,trigger:["change","blur"]}],recoveryDoorsillCount:[{required:!0,message:"请输入回收阀值"},{validator:s.C$,trigger:["change","blur"]},{validator:(e,a,t)=>{"add"===this.mode?a>=this.form.recoveryTargetCount?t():t(new Error("回收阀值不得低于回收目标数")):"edit"===this.mode&&(a<this.form.recoveryTargetCount?t(new Error("回收阀值不得低于回收目标数")):a<this.form.completeCount?t(new Error("回收阀值不得低于当前已收集数")):t())},trigger:["change","blur"]}],researchObjectType:[{required:!0,message:"请选择调研对象"}],deptType:[{required:!0,message:"请选择所属部门"}],researchPeriodType:[{required:!0,message:"请选择调研周期"}],startTime:[{required:!0,message:"请选择调研开始时间"}],endTime:[{required:!0,message:"请选择调研结束时间"}],businessShopType:[{required:!0,message:"请选择是否开启店铺限制"}]},sysAppraiseList:[],loading:!1}},mounted(){this.getSysAppraiseList()},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},async getSysAppraiseList(){this.loading=!0;let e={current:1,paramData:{},size:10},a=await this.$API.researchInfo.ResearchCompany.GetAppraiseSheetList.post(e);this.loading=!1,200==a.code?this.sysAppraiseList=a.data.list:this.$alert(a.message,"提示",{type:"error"})},change(e){this.form.sysAppraiseSheetName=this.sysAppraiseList.find((a=>a.no===e))?.name||""},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.CreatePlan.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}}))},editData(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.researchInfo.ResearchCompany.UpdatePlan.put(this.form.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},async setData(e){this.sysAppraiseList=[{no:e.sysAppraiseSheetNo,name:e.sysAppraiseSheetName}],Object.assign(this.form,e)}}},n=t(3744);const r=(0,n.Z)(o,[["render",i],["__scopeId","data-v-73b23eac"]]);var d=r},6578:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var l=t(6252),i=t(3577);const s={key:0},o={key:1},n={key:2},r={key:3},d={key:0};function u(e,a,t,u,m,c){const p=(0,l.up)("el-form-item"),h=(0,l.up)("el-radio"),f=(0,l.up)("el-radio-group"),g=(0,l.up)("el-input"),w=(0,l.up)("el-form"),b=(0,l.up)("el-button"),y=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(y,{modelValue:m.visible,"onUpdate:modelValue":a[2]||(a[2]=e=>m.visible=e),class:"answer","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[3]||(a[3]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(b,{autoInsertSpace:"",type:"primary",onClick:a[0]||(a[0]=e=>m.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1}),(0,l.Wm)(b,{autoInsertSpace:"",type:"primary",loading:m.isSaveing,onClick:a[1]||(a[1]=e=>c.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(w,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{label:"检查要点:",class:"block_item"}),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},[(0,l.Wm)(p,{label:e.name},{default:(0,l.w5)((()=>["BZXZZD_CLASS_07_TOPIC_01"===e.no?((0,l.wg)(),(0,l.iD)("div",s,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"陈列数≥40",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数≥40")])),_:1}),(0,l.Wm)(h,{label:"陈列数<40",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数<40")])),_:1}),(0,l.Wm)(h,{label:"无",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("无")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):"BZXZZD_CLASS_07_TOPIC_04"===e.no?((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"陈列数≥30",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数≥30")])),_:1}),(0,l.Wm)(h,{label:"陈列数<30",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("陈列数<30")])),_:1}),(0,l.Wm)(h,{label:"无",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("无")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])):1===e.type?((0,l.wg)(),(0,l.iD)("div",n,[(0,l.Wm)(f,{modelValue:e.selectOption,"onUpdate:modelValue":a=>e.selectOption=a,class:"ml-4",disabled:"BZXZZD_CLASS_01_TOPIC_01"===e.no},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:e.optionYes,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.optionYes),1)])),_:2},1032,["label"]),(0,l.Wm)(h,{label:e.optionNo,size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(e.optionNo),1)])),_:2},1032,["label"])])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])])):2===e.type?((0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(g,{min:"0",type:"number",modelValue:e.count,"onUpdate:modelValue":a=>e.count=a},null,8,["modelValue","onUpdate:modelValue"])])):(0,l.kq)("",!0)])),_:2},1032,["label"])])))),128)),m.queryOptions.length&&"BZXZZD_CLASS_02_TOPIC_01"===m.queryOptions[0].no&&"是"===m.queryOptions[0].selectOption?((0,l.wg)(),(0,l.iD)("div",d,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(m.form,((e,a)=>((0,l.wg)(),(0,l.j4)(p,{key:a,label:e.label},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{modelValue:e.whether,"onUpdate:modelValue":a=>e.whether=a,class:"ml-4"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"是",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("是")])),_:1}),(0,l.Wm)(h,{label:"否",size:"large"},{default:(0,l.w5)((()=>[(0,l.Uk)("否")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["label"])))),128))])):(0,l.kq)("",!0)])),_:1})])),_:1},8,["modelValue"])}var m={emits:["success","closed"],data(){return{id:this.$route.query.id,mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:[{label:"店招是否被污损",topicNo:"BZXZZD_CLASS_02_TOPIC_02",whether:""},{label:"店招是否被遮挡",topicNo:"BZXZZD_CLASS_02_TOPIC_03",whether:""}],queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{answer(e){const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add"){return this.mode=e,this.visible=!0,this},async submit(){this.isSaveing=!0;let e,a=this.queryOptions.map((e=>{let a={topicNo:e.no,whether:e.selectOption},t={quantity:e.count,topicNo:e.no};return 1===e.type?a:t}));if(e=a.length&&"BZXZZD_CLASS_02_TOPIC_01"===a[0].topicNo&&"是"===a[0].whether?[...a,...this.form]:a,e.find((e=>""===e.whether)))return this.$message.warning("请检查数据是否填写完整"),void(this.isSaveing=!1);let t=await this.$API.researchInfo.ResearchCompany.UpdatePlanOption.post(this.id,e);this.isSaveing=!1,200==t.code?(this.$emit("success",t.data),this.visible=!1,this.$message.success("操作成功")):this.$alert(t.message,"提示",{type:"error"})},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))}}},c=t(3744);const p=(0,c.Z)(m,[["render",u],["__scopeId","data-v-94eadce8"]]);var h=p},8457:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);const i={class:"box"};function s(e,a,t,s,o,n){const r=(0,l.up)("el-form-item"),d=(0,l.up)("el-image"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"查看",modelValue:o.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>o.visible=e),class:"answer","show-close":!1,"align-center":"",width:700,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{autoInsertSpace:"",type:"primary",onClick:a[4]||(a[4]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"基础照片",class:"block_item"}),(0,l._)("div",i,[(0,l.Wm)(r,{label:`门头照片（${t.detail.doorheadImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.doorheadImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`许可证照片（${t.detail.licenceImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[1]||(a[1]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.licenceImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`室内环境（${t.detail.indoorImage.length}/9）:`,class:"block_item",required:""},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[2]||(a[2]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.indoorImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(r,{label:`其他（${t.detail.otherImage.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(r,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[3]||(a[3]=(...e)=>n.clickImage&&n.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(t.detail.otherImage,((e,a)=>((0,l.wg)(),(0,l.j4)(d,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:n.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1})])])),_:1})])),_:1},8,["modelValue"])}var o={emits:["success","closed"],props:{detail:{type:Object,default:()=>{}}},data(){return{id:this.$route.query.id,visible:!1,isSaveing:!1,queryOptions:[],loading:!1,openPre:!1}},mounted(){},computed:{},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if("el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},open(){return this.visible=!0,this}}},n=t(3744);const r=(0,n.Z)(o,[["render",s],["__scopeId","data-v-0decde9c"]]);var d=r},9438:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return m}});var l=t(6252),i=t(3577);const s={class:"box"};function o(e,a,t,o,n,r){const d=(0,l.up)("el-form-item"),u=(0,l.up)("el-col"),m=(0,l.up)("el-row"),c=(0,l.up)("el-image"),p=(0,l.up)("el-button"),h=(0,l.up)("el-dialog"),f=(0,l.up)("answerDialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(h,{title:n.titleMap[n.mode],class:"answer",modelValue:n.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>n.visible=e),width:700,"align-center":"","destroy-on-close":"",onClosed:a[4]||(a[4]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(p,{autoInsertSpace:"",onClick:a[1]||(a[1]=e=>r.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("修改选项")])),_:1}),(0,l.Wm)(p,{autoInsertSpace:"",type:"primary",onClick:a[2]||(a[2]=e=>n.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1})])),default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"评分情况"}),(0,l._)("div",s,[(0,l.Wm)(d,{label:"检查要点:",class:"block_item"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.queryOptions,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a},(0,i.zw)(e.name),1)))),128))])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"分值:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(r.isCombine?r.combineInfo.combineScore:r.combineInfo.score),1)])),_:1})])),_:1}),(0,l.Wm)(u,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"得分:"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(r.filterColor(r.combineInfo))},(0,i.zw)(r.isCombine?r.combineInfo.combineHitScore:r.combineInfo.hitScore),5)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(d,{label:"回答:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l._)("div",{style:(0,i.j5)(r.filterColor(r.combineInfo,!0))},(0,i.zw)(r.answer(n.queryOptions)),5)])),_:1}),(0,l.Wm)(d,{label:`照片（${r.combineInfo.url.length}/9）:`,class:"block_item"},null,8,["label"]),(0,l.Wm)(d,null,{default:(0,l.w5)((()=>[(0,l._)("div",{class:"imageBox",onClick:a[0]||(a[0]=(...e)=>r.clickImage&&r.clickImage(...e))},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.combineInfo.url,((e,a)=>((0,l.wg)(),(0,l.j4)(c,{class:"image",fit:"cover",key:a,"initial-index":a,"preview-src-list":[e],src:e,onClose:r.close},null,8,["initial-index","preview-src-list","src","onClose"])))),128))])])),_:1}),(0,l.Wm)(d,{label:"备注:",class:"block_item"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(r.combineInfo.userRemark),1)])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(u,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"最新修改人账号:"},{default:(0,l.w5)((()=>[(0,l._)("div",null,(0,i.zw)(r.combineInfo.updateAccount||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(u,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"最新修改时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(r.combineInfo.updateTime||"-"),1)])),_:1})])),_:1})])),_:1})])])),_:1},8,["title","modelValue"]),n.dialog.save?((0,l.wg)(),(0,l.j4)(f,{key:0,ref:"answerDialog",onSuccess:r.handleSaveSuccess,onClosed:a[5]||(a[5]=e=>n.dialog.save=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var n=t(6578),r={emits:["success","closed"],components:{answerDialog:n["default"]},data(){return{id:this.$route.query.id,dialog:{save:!1},mode:"add",titleMap:{add:"查看"},visible:!1,isSaveing:!1,form:{},queryOptions:[],rules:{name:[{required:!0,message:"请输入店铺名称"}]},loading:!1,openPre:!1}},mounted(){},computed:{combineInfo({queryOptions:e}){return e?.[0]||{}},isCombine({queryOptions:e}){return 1===e?.[0].combineStatus}},methods:{close(){this.openPre=!1},clickImage(){this.openPre||this.$nextTick((()=>{let e=document.getElementsByClassName("el-image-viewer__actions__inner"),a=document.createElement("div");a.innerText="↓",a.setAttribute("class","el-icon-download"),a.addEventListener("click",(e=>{let a=e.target.className;if(console.log(e),"el-icon-download"===a){let e=document.getElementsByClassName("el-image-viewer__canvas")[0].children[0].src;e=e.replace(/http:\/\//g,"https://"),this.downloadImage(e)}})),e[0].appendChild(a),this.openPre=!0}))},downloadImage(e){let a=e.split("/"),t=a[a.length-1];window.URL=window.URL||window.webkitURL;let l=new XMLHttpRequest;l.open("get",e,!0),l.responseType="blob",l.onload=function(){if(200==this.status){let e=this.response,a=window.URL.createObjectURL(e),l=document.createElement("a");(document.body||document.documentElement).appendChild(l),l.href=a,"download"in l?l.download=t:l.setAttribute("download",t),l.target="_self",l.click(),l.remove()}},l.send()},answer(e){if("BZXZZD_CLASS_02_TOPIC_01"===this.combineInfo.no)return this.combineInfo.selectOption;const a=e.map((e=>{let a="";return a=1===e.type?e.selectOption:e.count,a}));return a.join(", ")},filterColor(e,a){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),a&&!t?"color: green;":t},open(e="add"){return this.mode=e,this.visible=!0,this},submit(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.answerDialog.open().setData(this.queryOptions)}))},async setData(e){this.queryOptions=JSON.parse(JSON.stringify(e))},handleSaveSuccess(e){"BZXZZD_CLASS_02_TOPIC_01"===e[0].no?this.queryOptions=JSON.parse(JSON.stringify([e[0]])):this.queryOptions=JSON.parse(JSON.stringify(e)),this.$parent.getDetail(this.id)}}},d=t(3744);const u=(0,d.Z)(r,[["render",o],["__scopeId","data-v-c8e6bd5a"]]);var m=u},7690:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return m}});var l=t(6252);const i=(0,l._)("div",{class:"el-form-item-msg"},"请输入6-20位字母、数字或标点符号组合的密码、允许8个特殊符号【~, !, @, #, $, %, &, *】",-1);function s(e,a,t,s,o,n){const r=(0,l.up)("el-input"),d=(0,l.up)("sc-password-strength"),u=(0,l.up)("el-form-item"),m=(0,l.up)("el-form"),c=(0,l.up)("el-button"),p=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(p,{title:"重置密码",modelValue:o.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(c,{onClick:a[3]||(a[3]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(c,{type:"primary",loading:o.isSaveing,onClick:a[4]||(a[4]=e=>n.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("确 定")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(m,{model:o.form,rules:o.rules,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{label:"新密码",prop:"password"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{modelValue:o.form.password,"onUpdate:modelValue":a[0]||(a[0]=e=>o.form.password=e),type:"password","show-password":"",maxlength:"20",placeholder:"请输入新密码"},null,8,["modelValue"]),(0,l.Wm)(d,{modelValue:o.form.password,"onUpdate:modelValue":a[1]||(a[1]=e=>o.form.password=e)},null,8,["modelValue"]),i])),_:1}),(0,l.Wm)(u,{label:"确认新密码",prop:"confirmNewPassword"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{modelValue:o.form.confirmNewPassword,"onUpdate:modelValue":a[2]||(a[2]=e=>o.form.confirmNewPassword=e),type:"password","show-password":"",placeholder:"请再次输入新密码"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}var o=t(1158),n=t(2787),r={emits:["success","closed"],components:{scPasswordStrength:o.Z},data(){return{id:"",visible:!1,isSaveing:!1,form:{id:"",password:"",confirmNewPassword:""},rules:{password:[{required:!0,message:"请输入新密码"},{validator:n.Gv,trigger:["change","blur"]}],confirmNewPassword:[{required:!0,message:"请再次输入新密码"},{validator:(e,a,t)=>{a!==this.form.password?t(new Error("两次输入密码不一致")):t()}}]}}},mounted(){},methods:{open(){return this.visible=!0,this},submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.user.ResetPassword.put(this.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},setData(e){this.id=e.id}}},d=t(3744);const u=(0,d.Z)(r,[["render",s]]);var m=u},5875:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return u}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-cascader"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-option"),u=(0,l.up)("el-select"),m=(0,l.up)("el-input"),c=(0,l.up)("el-form"),p=(0,l.up)("el-button"),h=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(h,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[8]||(a[8]=e=>s.visible=e),width:500,"destroy-on-close":"",onClosed:a[9]||(a[9]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>["show"!==s.mode?((0,l.wg)(),(0,l.j4)(p,{key:0,onClick:a[5]||(a[5]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1})):(0,l.kq)("",!0),"add"===s.mode?((0,l.wg)(),(0,l.j4)(p,{key:1,type:"primary",loading:s.isSaveing,onClick:a[6]||(a[6]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0),"edit"===s.mode?((0,l.wg)(),(0,l.j4)(p,{key:2,type:"primary",loading:s.isSaveing,onClick:a[7]||(a[7]=e=>o.editData())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(c,{model:s.form,rules:s.rules,disabled:"show"==s.mode,ref:"dialogForm","label-width":"100px","label-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"所属组织",prop:"organizationId"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{ref:"orgRef",onChange:o.changeNode,modelValue:s.form.organizationId,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.organizationId=e),disabled:"edit"===s.mode&&"9"!==s.form.roleId,options:s.depts,props:s.deptsProps,clearable:"",style:{width:"100%"}},null,8,["onChange","modelValue","disabled","options","props"])])),_:1}),(0,l.Wm)(r,{label:"绑定角色",prop:"roleId"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{disabled:"edit"===s.mode,modelValue:s.form.roleId,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.roleId=e),filterable:"",style:{width:"100%"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.filterOptionsData,(e=>((0,l.wg)(),(0,l.j4)(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["disabled","modelValue"])])),_:1}),(0,l.Wm)(r,{label:"用户账号",prop:"account"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{disabled:"edit"===s.mode,maxlength:"16","show-word-limit":"",modelValue:s.form.account,"onUpdate:modelValue":a[2]||(a[2]=e=>s.form.account=e),placeholder:"用于登录系统",clearable:""},null,8,["disabled","modelValue"])])),_:1}),(0,l.Wm)(r,{label:"姓名",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{disabled:"edit"===s.mode,maxlength:"10","show-word-limit":"",modelValue:s.form.name,"onUpdate:modelValue":a[3]||(a[3]=e=>s.form.name=e),placeholder:"请输入完整的真实姓名",clearable:""},null,8,["disabled","modelValue"])])),_:1}),(0,l.Wm)(r,{label:"手机号",prop:"phone"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:s.form.phone,"onUpdate:modelValue":a[4]||(a[4]=e=>s.form.phone=e),maxlength:"50",placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules","disabled"])])),_:1},8,["title","modelValue"])}var s=t(9123),o=t(2787),n={emits:["success","closed"],data(){const e=(e,a,t)=>{let l=/^[a-zA-Z0-9@]{1,16}$/;l.test(a)?t():t(new Error("请输入1-16位账号"))};return{mode:"add",titleMap:{add:"新增用户",edit:"编辑用户",show:"查看"},visible:!1,isSaveing:!1,form:{phone:"",account:"",name:"",organizationId:"",roleId:""},rules:{account:[{required:!0,message:"请输入登录账号"},{validator:e,trigger:["change","blur"]}],name:[{required:!0,message:"请输入真实姓名"}],organizationId:[{required:!0,message:"请选择所属组织",trigger:"change"},{validator:(e,a,t)=>{"edit"===this.mode&&4!==this.level?t(new Error("客户经理只可选择4级组织")):t()},trigger:"change"}],roleId:[{required:!0,message:"请选择绑定角色",trigger:"change"}],phone:[{validator:o.C$,trigger:["change","blur"]}]},groups:[],groupsProps:{value:"id",multiple:!0,checkStrictly:!0},depts:[],deptsProps:{label:"name",value:"id",children:"subset",checkStrictly:!0,emitPath:!1},level:""}},computed:{permissions:()=>s.Z.state.user.PERMISSIONS,filterOptionsData:({groups:e,level:a})=>e.filter((e=>!a||e.level===a))},mounted(){this.getGroup(),this.getDept()},methods:{open(e="add"){return this.mode=e,this.visible=!0,this},async getGroup(){let e=await this.$API.system.role.list.get();this.groups=e.data},async getDept(){let e=await this.$API.user.GetOrgList.get();this.depts=[e.data]},submit(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.user.CreateUser.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},editData(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.user.UpdateUser.put(this.form.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},changeNode(){if(this.$refs.orgRef.getCheckedNodes().length){const{level:e}=this.$refs.orgRef.getCheckedNodes()[0];this.level=e}"add"===this.mode&&(this.form.roleId="")},setData(e){Object.assign(this.form,e)}}},r=t(3744);const d=(0,r.Z)(n,[["render",i]]);var u=d},9551:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);function i(e,a,t,i,s,o){const n=(0,l.up)("el-cascader"),r=(0,l.up)("el-form-item"),d=(0,l.up)("el-input"),u=(0,l.up)("el-form"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:s.titleMap[s.mode],modelValue:s.visible,"onUpdate:modelValue":a[5]||(a[5]=e=>s.visible=e),width:500,"destroy-on-close":"",onClosed:a[6]||(a[6]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{onClick:a[2]||(a[2]=e=>s.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),["children","add"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(m,{key:0,type:"primary",loading:s.isSaveing,onClick:a[3]||(a[3]=e=>o.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0),["edit"].includes(s.mode)?((0,l.wg)(),(0,l.j4)(m,{key:1,type:"primary",loading:s.isSaveing,onClick:a[4]||(a[4]=e=>o.editData())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])):(0,l.kq)("",!0)])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{model:s.form,rules:s.rules,ref:"dialogForm","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{label:"上级组织",prop:"parentId"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{ref:"orgRef",modelValue:s.form.parentId,"onUpdate:modelValue":a[0]||(a[0]=e=>s.form.parentId=e),disabled:["children","edit"].includes(s.mode),options:t.groups,onChange:o.changeNode,props:s.groupsProps,"show-all-levels":!1,clearable:"",style:{width:"100%"}},null,8,["modelValue","disabled","options","onChange","props"])])),_:1}),(0,l.Wm)(r,{label:"组织名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{modelValue:s.form.name,"onUpdate:modelValue":a[1]||(a[1]=e=>s.form.name=e),maxlength:"35","show-word-limit":"",placeholder:"请输入组织名称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}var s=t(9123),o={emits:["success","closed"],props:{groups:{type:Array,default:()=>[]}},data(){const e=(e,a,t)=>{this.form.level>4?t(new Error("最多只可添加4级组织")):t()};return{mode:"add",titleMap:{add:"新建组织",edit:"修改",children:"新建组织"},visible:!1,isSaveing:!1,form:{id:"",parentId:"",name:"",level:0},rules:{parentId:[{required:!0,message:"请选择上级组织",trigger:"change"},{validator:e,trigger:"change"}],name:[{required:!0,message:"请输入组织名称，最多支持35位字符"}]},groupsProps:{label:"name",value:"id",children:"subset",checkStrictly:!0,emitPath:!1}}},computed:{user:()=>s.Z.state.user.USER_INFO},methods:{open(e="add"){return this.mode=e,this.visible=!0,"add"===e&&(this.form.parentId=this.user.organizationId,this.$nextTick((()=>{this.changeNode()}))),this},submit(){this.$refs.dialogForm.validate((async e=>{if(e){this.isSaveing=!0;var a=await this.$API.org.CreateOrg.post(this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}}))},editData(){this.$refs.dialogForm.validate((async e=>{if(!e)return!1;this.isSaveing=!0;var a=await this.$API.org.UpdateOrg.put(this.form.id,this.form);this.isSaveing=!1,200==a.code?(this.$emit("success",this.form,this.mode),this.visible=!1,this.$message.success("操作成功")):this.$alert(a.message,"提示",{type:"error"})}))},changeNode(){if(this.$refs.orgRef.getCheckedNodes().length){const{level:e}=this.$refs.orgRef.getCheckedNodes()[0];this.form.level=e+1}},setData(e){Object.assign(this.form,e)}}},n=t(3744);const r=(0,n.Z)(o,[["render",i]]);var d=r},9693:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var l=t(6252);const i={class:"treeMain"};function s(e,a,t,s,o,n){const r=(0,l.up)("el-tree"),d=(0,l.up)("el-tab-pane"),u=(0,l.up)("el-tabs"),m=(0,l.up)("el-button"),c=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.j4)(c,{title:"角色权限设置",modelValue:o.visible,"onUpdate:modelValue":a[2]||(a[2]=e=>o.visible=e),width:500,"destroy-on-close":"",onClosed:a[3]||(a[3]=a=>e.$emit("closed"))},{footer:(0,l.w5)((()=>[(0,l.Wm)(m,{onClick:a[0]||(a[0]=e=>o.visible=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("取 消")])),_:1}),(0,l.Wm)(m,{type:"primary",loading:o.isSaveing,onClick:a[1]||(a[1]=e=>n.submit())},{default:(0,l.w5)((()=>[(0,l.Uk)("保 存")])),_:1},8,["loading"])])),default:(0,l.w5)((()=>[(0,l.Wm)(u,{"tab-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{label:"接口权限"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(r,{ref:"menu","node-key":"id",data:o.menu.list,props:o.menu.props,"show-checkbox":""},null,8,["data","props"])])])),_:1})])),_:1})])),_:1},8,["modelValue"])}t(7658);var o={emits:["success","closed"],data(){return{visible:!1,isSaveing:!1,id:"",menu:{list:[],checked:[],props:{label:e=>e.path,children:"subordinate"}}}},mounted(){},methods:{open(){return this.visible=!0,this},async submit(){this.isSaveing=!0;var e=this.$refs.menu.getCheckedKeys().concat(this.$refs.menu.getHalfCheckedKeys());let a={roleId:this.id,resourceIds:e},t=await this.$API.role.SettingResource.post(a);200===t.code?(this.$emit("success",this.form,this.mode),this.isSaveing=!1,this.visible=!1,this.$message.success("操作成功")):(this.isSaveing=!1,this.$alert(t.message,"提示",{type:"error"}))},async getMenu(e){var a=await this.$API.role.GetResourceList.get(e);this.menu.list=a.data,this.menu.checked=this.getCheckd(a.data),this.$nextTick((()=>{let e=this.menu.checked.filter((e=>this.$refs.menu.getNode(e).isLeaf));this.$refs.menu.setCheckedKeys(e,!0)}))},getCheckd(e){let a=[];return e.forEach((e=>{e.isContain&&a.push(e.id),e.subordinate.length>0&&a.push(...this.getCheckd(e.subordinate))})),a},setData(e){this.id=e.id,this.getMenu(this.id)}}},n=t(3744);const r=(0,n.Z)(o,[["render",s],["__scopeId","data-v-5585e72a"]]);var d=r},1783:function(e,a,t){var l={"./about.vue":7798,"./echarts.vue":390,"./progress.vue":8259,"./time.vue":7568,"./ver.vue":4511};function i(e){var a=s(e);return t(a)}function s(e){if(!t.o(l,e)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return l[e]}i.keys=function(){return Object.keys(l)},i.resolve=s,e.exports=i,i.id=1783}}]);