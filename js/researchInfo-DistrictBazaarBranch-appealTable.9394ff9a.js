"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[8763],{7816:function(e,t,a){a.r(t),a.d(t,{default:function(){return x}});var l=a(6252),i=a(3577);const s=e=>((0,l.dD)("data-v-23f10023"),e=e(),(0,l.Cn)(),e),o={class:"left-panel"},c={class:"title"},n={class:"right-panel"},r={class:"longText"},d={class:"label"},u={class:"sheetBox"},m={class:"appraiseSheetName"},p={class:"colorPanel"},h=s((()=>(0,l._)("div",{class:"color-item"},[(0,l._)("div",{class:"block",style:{"--background":"#ffc327"}}),(0,l.Uk)(" 代表-该项申诉未处理 ")],-1))),f=s((()=>(0,l._)("div",{class:"color-item"},[(0,l._)("div",{class:"block",style:{"--background":"#23994a"}}),(0,l.Uk)(" 代表-该项申诉已通过 ")],-1))),w=s((()=>(0,l._)("div",{class:"color-item"},[(0,l._)("div",{class:"block",style:{"--background":"#ff2727"}}),(0,l.Uk)(" 代表-该项申诉已驳回 ")],-1))),b=s((()=>(0,l._)("div",{class:"color-item"},[(0,l._)("div",{class:"block",style:{"--background":"#2780ff"}}),(0,l.Uk)(" 代表-该项申诉超时未处理 ")],-1))),_={key:0},g={key:1},k={key:0};function S(e,t,a,s,S,v){const W=(0,l.up)("el-icon-list"),y=(0,l.up)("el-icon"),C=(0,l.up)("el-button"),L=(0,l.up)("el-header"),D=(0,l.up)("el-form-item"),N=(0,l.up)("el-col"),x=(0,l.up)("el-row"),Z=(0,l.up)("el-table-column"),A=(0,l.up)("el-button-group"),z=(0,l.up)("scTable"),P=(0,l.up)("el-main"),U=(0,l.up)("el-container"),I=(0,l.up)("save-dialog"),$=(0,l.up)("simplePhoto"),T=(0,l.up)("openAppeal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(L,{class:"info"},{default:(0,l.w5)((()=>[(0,l._)("div",o,[(0,l.Wm)(y,{size:20,color:"var(--el-color-primary)"},{default:(0,l.w5)((()=>[(0,l.Wm)(W)])),_:1}),(0,l._)("div",c,(0,i.zw)(S.detail.businessShopName),1)]),(0,l._)("div",n,[(0,l.Wm)(C,{size:"default",onClick:v.back},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1},8,["onClick"]),(0,l.Wm)(C,{type:"primary",size:"default",onClick:v.showPhoto},{default:(0,l.w5)((()=>[(0,l.Uk)("基础照片")])),_:1},8,["onClick"])])])),_:1}),(0,l.Wm)(P,{style:{background:"#fff"}},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{class:"infoHead"},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{span:16},{default:(0,l.w5)((()=>[(0,l.Wm)(x,null,{default:(0,l.w5)((()=>[(0,l.Wm)(N,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:"客户经理:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(S.detail.accountManagerName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(N,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:"区营销部:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(S.detail.marketingDepartmentName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(N,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:"区市场部:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(S.detail.organizationName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(N,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:"客户名称:"},{default:(0,l.w5)((()=>[(0,l._)("div",r,(0,i.zw)(S.detail.customerName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(N,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:"专卖证号:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(S.detail.retailLicenseNumber||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(N,{xs:12,sm:12,md:8,lg:8,xl:8},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:"客户电话:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(S.detail.customerPhone||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(N,{xs:24,sm:24,md:16,lg:16,xl:16},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{label:"调研时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,i.zw)(S.detail.completionTime||"-"),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)(N,{span:8,class:"successBox"},{default:(0,l.w5)((()=>[(0,l._)("div",d,"总分："+(0,i.zw)(S.detail.totalScore||0),1)])),_:1})])),_:1}),(0,l._)("div",u,[(0,l._)("div",m,[(0,l.Uk)((0,i.zw)(S.detail.sheetName||"-")+" ",1),(0,l._)("div",p,[(0,l.Wm)(x,{style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{span:6},{default:(0,l.w5)((()=>[h])),_:1}),(0,l.Wm)(N,{span:6},{default:(0,l.w5)((()=>[f])),_:1}),(0,l.Wm)(N,{span:6},{default:(0,l.w5)((()=>[w])),_:1}),(0,l.Wm)(N,{span:6},{default:(0,l.w5)((()=>[b])),_:1})])),_:1})])]),(0,l.Wm)(z,{ref:"table",data:S.detail.topicListList,"span-method":v.objectSpanMethod,"table-layout":"auto",border:"",hiddenMin:"","highlight-current-row":!1,"row-key":"id",hideRefresh:"",hidePagination:"",hideDo:"","cell-style":v.changeCellStyle},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{label:"检查项目",prop:"className","min-width":"150",align:"center"}),(0,l.Wm)(Z,{label:"基本分",prop:"classBaseScore","min-width":"150",align:"center"}),(0,l.Wm)(Z,{label:"检查要点",prop:"name","min-width":"500",align:"center"}),(0,l.Wm)(Z,{label:"分值",prop:"score","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[S.strShow.includes(e.row.no)?((0,l.wg)(),(0,l.iD)("div",_,"否决项")):((0,l.wg)(),(0,l.iD)("div",g,(0,i.zw)(1===e.row.combineStatus?e.row.combineScore:e.row.score),1))])),_:1}),(0,l.Wm)(Z,{label:"得分",prop:"hitScore","min-width":"150",align:"center"},{default:(0,l.w5)((e=>[S.strShow.includes(e.row.no)?((0,l.wg)(),(0,l.iD)("div",k,"-")):((0,l.wg)(),(0,l.iD)("div",{key:1,style:(0,i.j5)(v.filterColor(e.row))},(0,i.zw)(1===e.row.combineStatus?e.row.combineHitScore:e.row.hitScore),5))])),_:1}),(0,l.Wm)(Z,{label:"操作","min-width":"100",fixed:"right",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Wm)(C,{text:"",type:"primary",size:"small",onClick:t=>v.getData(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看")])),_:2},1032,["onClick"]),v.filteShow(e.row)?((0,l.wg)(),(0,l.j4)(C,{key:0,text:"",type:"primary",size:"small",onClick:t=>v.getAppeal(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("审核")])),_:2},1032,["onClick"])):(0,l.kq)("",!0)])),_:2},1024)])),_:1})])),_:1},8,["data","span-method","cell-style"])])])),_:1})])),_:1}),S.dialog.save?((0,l.wg)(),(0,l.j4)(I,{key:0,ref:"saveDialog",onSuccess:v.handleSaveSuccess,onClosed:t[0]||(t[0]=e=>S.dialog.save=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0),S.dialog.photo?((0,l.wg)(),(0,l.j4)($,{key:1,detail:S.detail,ref:"simplePhoto",onClosed:t[1]||(t[1]=e=>S.dialog.photo=!1)},null,8,["detail"])):(0,l.kq)("",!0),S.dialog.appeal?((0,l.wg)(),(0,l.j4)(T,{key:2,ref:"openAppeal",onSuccess:v.handleSaveSuccess,onClose:t[2]||(t[2]=e=>S.dialog.appeal=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}a(7658);var v=a(2540),W=a(6858),y=a(4410),C=a(8201),L={name:"plan-detail",components:{saveDialog:v["default"],simplePhoto:W["default"],openAppeal:y["default"]},data(){return{id:this.$route.query.id,input:"",dialog:{save:!1,photo:!1,appeal:!1},strShow:["BZXZZD_CLASS_01_TOPIC_01","BZXZZD_CLASS_02_TOPIC_01"],detail:{business:{},images:[],result:{},topicClass:[],topicListList:[]},spanArr:[]}},created(){},mounted(){this.getDetail(this.$route.query.id)},methods:{changeCellStyle({row:e,column:t,columnIndex:a}){return 4===a&&0===e.status?{background:"#ffc327"}:4===a&&1===e.status?{background:"#b6f3ca"}:4===a&&2===e.status?{background:"#fbcbcb"}:4===a&&3===e.status?{background:"#91d5ff"}:"操作"===t.label?{background:"#fff"}:{background:"revert"}},filteShow(e){if("BZXZZD_CLASS_02_TOPIC_01"===e.no&&0===e.status&&"否"===e.selectOption)return!0;let t=!1;return 1===e.combineStatus?e.combineHitScore<e.combineScore&&0===e.status&&(t=!0):e.hitScore<e.score&&0===e.status&&(t=!0),t},filterColor(e){let t="";return 1===e.combineStatus?e.combineHitScore<e.combineScore&&(t="color: red;"):e.hitScore<e.score&&(t="color: red;"),t},getSpanArr(e){let t=[];for(var a=0;a<e.length;a++)0===a?(t.push(1),this.pos=0):e[a].classNo===e[a-1].classNo?(t[this.pos]+=1,t.push(0)):(t.push(1),this.pos=a);return t},objectSpanMethod({rowIndex:e,columnIndex:t}){if(0===t||1===t){const t=this.spanArr[e],a=t>0?1:0;return{rowspan:t,colspan:a}}if([3,4].includes(t)){const t=this.detail.topicListList[e-1],a=this.detail.topicListList[e],l=this.detail.topicListList[e+1];if(!l||a.classNo!==l.classNo)return[1,1];if(1===a.combineStatus&&a.combineNo===t.combineNo)return[0,1];if(1===a.combineStatus&&a.combineNo===l.combineNo)return[2,1]}else if([5].includes(t)){const a=this.detail.topicListList[e-2]||{},l=this.detail.topicListList[e-1]||{},i=this.detail.topicListList[e]||{},s=this.detail.topicListList[e+1];if(0===t&&0===e)return[1,1];if("BZXZZD_CLASS_02_TOPIC_01"===i.no&&"否"===i.selectOption)return[3,1];if("BZXZZD_CLASS_02_TOPIC_01"===a.no&&"否"===a.selectOption||"BZXZZD_CLASS_02_TOPIC_01"===l.no&&"否"===l.selectOption)return[0,1];if(!s||i.classNo!==s.classNo)return[1,1];if(1===i.combineStatus&&i.combineNo===l.combineNo)return[0,1];if(1===i.combineStatus&&i.combineNo===s.combineNo)return[2,1]}},getData(e){let t=[];const{combineStatus:a,combineNo:l}=e;switch(a){case 1:t=this.detail.topicListList.filter((e=>e.combineNo===l));break;case 2:t.push(e);break}this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("add",this.detail.resultId).setData(t)}))},getAppeal(e){let t=[];const{combineStatus:a,combineNo:l}=e;switch(a){case 1:t=this.detail.topicListList.filter((e=>e.combineNo===l));break;case 2:t.push(e);break}this.dialog.appeal=!0,this.$nextTick((()=>{this.$refs.openAppeal.open("add",this.detail.resultId).setData(t)}))},filterType(e,t=[]){return t.find((t=>t.value===e))?.label||"-"},async getDetail(e){let t=await this.$API.researchInfo.ResearchCompany.GetAuditSheetDetail.get(e);200===t.code?(this.detail=t.data||{},this.spanArr=this.getSpanArr(t.data.topicListList)):C.Z.closeNext((()=>{this.$router.back()}))},back(){C.Z.closeNext((()=>{this.$router.back()}))},showPhoto(){this.dialog.photo=!0,this.$nextTick((()=>{this.$refs.simplePhoto.open()}))},handleClick(e){switch(e.props.name){case"1":this.$refs.RecycleDetail.initData();break;case"2":this.$refs.PlanUserList.initData();break;case"3":this.$refs.StoreList.initData();break}},handleSaveSuccess(){this.getDetail(this.id)}}},D=a(3744);const N=(0,D.Z)(L,[["render",S],["__scopeId","data-v-23f10023"]]);var x=N}}]);