"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[6597,7779,8062,9287],{78667:function(e,a,l){l.r(a),l.d(a,{default:function(){return K}});var t=l(66252),s=l(3577);const i=e=>((0,t.dD)("data-v-4b4cdc07"),e=e(),(0,t.Cn)(),e),u={class:"left-panel"},r={class:"query"},o={class:"query_item"},n=i((()=>(0,t._)("div",{class:"query_label"},"店铺名称：",-1))),d={class:"query_item"},m=i((()=>(0,t._)("div",{class:"query_label"},"专卖许可证号：",-1))),p={class:"query_item"},c=i((()=>(0,t._)("div",{class:"query_label"},"客户名称：",-1))),y={class:"query_item"},h=i((()=>(0,t._)("div",{class:"query_label"},"客户电话：",-1))),b={class:"query_item"},f=i((()=>(0,t._)("div",{class:"query_label"},"地址：",-1))),g={class:"query_item"},_=i((()=>(0,t._)("div",{class:"query_label"},"所属营销部：",-1))),v={key:0,class:"query_item"},q=i((()=>(0,t._)("div",{class:"query_label"},"所属市场部：",-1))),w={key:1,class:"query_item"},k=i((()=>(0,t._)("div",{class:"query_label"},"客户经理：",-1))),D={key:2,class:"query_item"},W=i((()=>(0,t._)("div",{class:"query_label"},"市场类型：",-1))),V={key:3,class:"query_item"},I=i((()=>(0,t._)("div",{class:"query_label"},"业态类型：",-1))),$={key:4,class:"query_item"},U=i((()=>(0,t._)("div",{class:"query_label"},"所属线路：",-1))),N={key:5,class:"query_item"},C=i((()=>(0,t._)("div",{class:"query_label"},"档位：",-1))),L={key:6,class:"query_item"},S=i((()=>(0,t._)("div",{class:"query_label"},"账号状态：",-1))),T={class:"right-panel"},z={class:"right-panel-search",style:{margin:"5px 0"}},x={class:"left-panel"},P=i((()=>(0,t._)("div",{class:"right-panel"},null,-1)));function A(e,a,l,i,A,E){const j=(0,t.up)("el-input"),R=(0,t.up)("el-option"),M=(0,t.up)("el-select"),H=(0,t.up)("el-radio-button"),Y=(0,t.up)("el-radio-group"),F=(0,t.up)("el-button"),K=(0,t.up)("el-header"),Z=(0,t.up)("el-table-column"),B=(0,t.up)("el-switch"),G=(0,t.up)("el-popconfirm"),O=(0,t.up)("el-button-group"),Q=(0,t.up)("scTable"),J=(0,t.up)("el-main"),X=(0,t.up)("el-container"),ee=(0,t.up)("save-dialog"),ae=(0,t.up)("upload-dialog"),le=(0,t.up)("edit-dialog"),te=(0,t.Q2)("role");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(X,null,{default:(0,t.w5)((()=>[(0,t.Wm)(X,null,{default:(0,t.w5)((()=>[(0,t.Wm)(K,{class:"searchSpan"},{default:(0,t.w5)((()=>[(0,t._)("div",u,[(0,t._)("div",r,[(0,t._)("div",o,[n,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入店铺名称",modelValue:A.queryInfo.paramData.name,"onUpdate:modelValue":a[0]||(a[0]=e=>A.queryInfo.paramData.name=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",d,[m,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入许可证号",modelValue:A.queryInfo.paramData.retailLicenseNumber,"onUpdate:modelValue":a[1]||(a[1]=e=>A.queryInfo.paramData.retailLicenseNumber=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",p,[c,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入客户姓名",modelValue:A.queryInfo.paramData.customerName,"onUpdate:modelValue":a[2]||(a[2]=e=>A.queryInfo.paramData.customerName=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",y,[h,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入客户电话",modelValue:A.queryInfo.paramData.customerPhone,"onUpdate:modelValue":a[3]||(a[3]=e=>A.queryInfo.paramData.customerPhone=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",b,[f,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入地址",modelValue:A.queryInfo.paramData.businessAddress,"onUpdate:modelValue":a[4]||(a[4]=e=>A.queryInfo.paramData.businessAddress=e),clearable:""},null,8,["modelValue"])]),(0,t._)("div",g,[_,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入所属营销部",modelValue:A.queryInfo.paramData.marketingDepartmentName,"onUpdate:modelValue":a[5]||(a[5]=e=>A.queryInfo.paramData.marketingDepartmentName=e),clearable:""},null,8,["modelValue"])]),A.open?((0,t.wg)(),(0,t.iD)("div",v,[q,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入所属市场部",modelValue:A.queryInfo.paramData.organizationName,"onUpdate:modelValue":a[6]||(a[6]=e=>A.queryInfo.paramData.organizationName=e),clearable:""},null,8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",w,[k,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入客户经理名称",modelValue:A.queryInfo.paramData.accountManagerName,"onUpdate:modelValue":a[7]||(a[7]=e=>A.queryInfo.paramData.accountManagerName=e),clearable:""},null,8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",D,[W,(0,t.Wm)(M,{class:"query_input",modelValue:A.queryInfo.paramData.marketType,"onUpdate:modelValue":a[8]||(a[8]=e=>A.queryInfo.paramData.marketType=e),filterable:"",placeholder:"请选择市场类型",clearable:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(A.marketList,(e=>((0,t.wg)(),(0,t.j4)(R,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",V,[I,(0,t.Wm)(M,{class:"query_input",modelValue:A.queryInfo.paramData.businessType,"onUpdate:modelValue":a[9]||(a[9]=e=>A.queryInfo.paramData.businessType=e),filterable:"",placeholder:"请选择业态类型",clearable:""},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(A.businessList,(e=>((0,t.wg)(),(0,t.j4)(R,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",$,[U,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入所属路线",modelValue:A.queryInfo.paramData.deliveryRoute,"onUpdate:modelValue":a[10]||(a[10]=e=>A.queryInfo.paramData.deliveryRoute=e),clearable:""},null,8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",N,[C,(0,t.Wm)(j,{class:"query_input",placeholder:"请输入所属档位",modelValue:A.queryInfo.paramData.gear,"onUpdate:modelValue":a[11]||(a[11]=e=>A.queryInfo.paramData.gear=e),clearable:""},null,8,["modelValue"])])):(0,t.kq)("",!0),A.open?((0,t.wg)(),(0,t.iD)("div",L,[S,(0,t.Wm)(Y,{modelValue:A.queryInfo.paramData.status,"onUpdate:modelValue":a[12]||(a[12]=e=>A.queryInfo.paramData.status=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{label:""},{default:(0,t.w5)((()=>[(0,t.Uk)("全部")])),_:1}),(0,t.Wm)(H,{label:1},{default:(0,t.w5)((()=>[(0,t.Uk)("启用")])),_:1}),(0,t.Wm)(H,{label:0},{default:(0,t.w5)((()=>[(0,t.Uk)("禁用")])),_:1})])),_:1},8,["modelValue"])])):(0,t.kq)("",!0)])]),(0,t._)("div",T,[(0,t._)("div",z,[(0,t.Wm)(F,{type:"default",onClick:a[13]||(a[13]=e=>E.upsearch(!0))},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1}),(0,t.Wm)(F,{type:"primary",onClick:a[14]||(a[14]=e=>E.upsearch(!1))},{default:(0,t.w5)((()=>[(0,t.Uk)("查询")])),_:1}),(0,t._)("div",{class:"openBtn",onClick:a[15]||(a[15]=e=>A.open=!A.open)},(0,s.zw)(A.open?"收起":"展开"),1)])])])),_:1}),(0,t.wy)(((0,t.wg)(),(0,t.j4)(K,{style:{height:"auto"}},{default:(0,t.w5)((()=>[(0,t._)("div",x,[(0,t.Wm)(F,{type:"primary",size:"default",onClick:E.add},{default:(0,t.w5)((()=>[(0,t.Uk)("新建店铺")])),_:1},8,["onClick"]),(0,t.Wm)(F,{type:"primary",size:"default",onClick:E.uploadImport},{default:(0,t.w5)((()=>[(0,t.Uk)("批量导入")])),_:1},8,["onClick"]),(0,t.Wm)(F,{type:"primary",size:"default",onClick:E.manyEdit},{default:(0,t.w5)((()=>[(0,t.Uk)("批量修改")])),_:1},8,["onClick"])]),P])),_:1})),[[te,["1","2"]]]),(0,t.Wm)(J,{class:"nopadding"},{default:(0,t.w5)((()=>[(0,t.Wm)(Q,{ref:"table",data:A.tableData,staticTotal:A.total,"row-key":"id",hideRefresh:"",onSelectionChange:E.selectionChange},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,{label:"店铺名称",prop:"name",width:"200"}),(0,t.Wm)(Z,{label:"零售许可证号",prop:"retailLicenseNumber",width:"120"}),(0,t.Wm)(Z,{label:"客户姓名",prop:"customerName",width:"100"}),(0,t.Wm)(Z,{label:"客户电话",prop:"customerPhone",width:"120"}),(0,t.Wm)(Z,{label:"地址",prop:"businessAddress",width:"300"}),(0,t.Wm)(Z,{label:"所属营销部",prop:"marketingDepartmentName",width:"180"}),(0,t.Wm)(Z,{label:"所属市场部",prop:"organizationName",width:"180"}),(0,t.Wm)(Z,{label:"客户经理",prop:"accountManagerName",width:"100"}),(0,t.Wm)(Z,{label:"市场类型",prop:"marketType",width:"100"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,s.zw)(E.filterType(e.row.marketType,A.marketList)),1)])),_:1}),(0,t.Wm)(Z,{label:"业态",prop:"businessType",width:"100"},{default:(0,t.w5)((e=>[(0,t.Uk)((0,s.zw)(E.filterType(e.row.businessType,A.businessList)),1)])),_:1}),(0,t.Wm)(Z,{label:"线路",prop:"deliveryRoute",width:"180"}),(0,t.Wm)(Z,{label:"档位",prop:"gear",width:"150"}),(0,t.Wm)(Z,{label:"状态",prop:"status",width:"100"},{default:(0,t.w5)((e=>[(0,t.Wm)(B,{"inline-prompt":"",modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用",onChange:a=>E.disableShop(a,e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,t.wy)(((0,t.wg)(),(0,t.j4)(Z,{label:"操作",fixed:"right",align:"right",width:"120"},{default:(0,t.w5)((e=>[(0,t.Wm)(O,null,{default:(0,t.w5)((()=>[(0,t.Wm)(F,{text:"",type:"primary",size:"small",onClick:a=>E.table_edit(e.row,e.$index)},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"]),(0,t.Wm)(G,{title:"确定删除吗？",onConfirm:a=>E.table_del(e.row,e.$index)},{reference:(0,t.w5)((()=>[(0,t.Wm)(F,{text:"",type:"primary",size:"small"},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:1})])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:1})),[[te,["1","2"]]])])),_:1},8,["data","staticTotal","onSelectionChange"])])),_:1})])),_:1})])),_:1}),A.dialog.save?((0,t.wg)(),(0,t.j4)(ee,{key:0,ref:"saveDialog",onSuccess:E.handleSaveSuccess,marketList:A.marketList,businessList:A.businessList,onClosed:a[16]||(a[16]=e=>A.dialog.save=!1)},null,8,["onSuccess","marketList","businessList"])):(0,t.kq)("",!0),A.dialog.upload?((0,t.wg)(),(0,t.j4)(ae,{key:1,ref:"uploadDialog",onSuccess:E.handleSaveSuccess,onClosed:a[17]||(a[17]=e=>A.dialog.upload=!1)},null,8,["onSuccess"])):(0,t.kq)("",!0),A.dialog.manyEdit?((0,t.wg)(),(0,t.j4)(le,{key:2,ref:"editDialog",onSuccess:E.handleSaveSuccess,onClosed:a[18]||(a[18]=e=>A.dialog.manyEdit=!1)},null,8,["onSuccess"])):(0,t.kq)("",!0)],64)}var E=l(40401),j=l(72337),R=l(59353),M=l(24239),H={name:"shop",components:{saveDialog:E["default"],uploadDialog:j["default"],editDialog:R["default"]},computed:{user:()=>M.Z.state.user.USER_INFO},data(){return{open:!1,dialog:{save:!1,upload:!1,manyEdit:!1},tableData:[],total:0,selection:[],search:{keyword:null},queryInfo:{current:1,paramData:{accountManagerName:"",businessAddress:"",businessType:"",customerName:"",customerPhone:"",deliveryRoute:"",gear:"",marketType:"",marketingDepartmentName:"",name:"",organizationName:"",retailLicenseNumber:""},size:10},breadcrumb:[],marketList:[{value:1,label:"城市"},{value:2,label:"乡村"},{value:3,label:"乡镇"}],businessList:[{value:1,label:"便利店"},{value:2,label:"超市"},{value:3,label:"商场"},{value:4,label:"烟酒店"},{value:5,label:"食杂店"},{value:6,label:"娱乐服务"},{value:7,label:"其他"}]}},watch:{groupFilterText(e){this.$refs.group.filter(e)}},mounted(){this.getDataList(!0)},methods:{manyEdit(){this.dialog.manyEdit=!0,this.$nextTick((()=>{this.$refs.editDialog.open()}))},filterType(e,a){return a.find((a=>a.value===e))?.label||"-"},async getDataList(){this.$refs.table.loading=!0;let e=await this.$API.business.GetShopList.post(this.queryInfo);200===e.code?(this.tableData=e.data.list,this.total=e.data.total,this.$refs.table.loading=!1):this.$refs.table.loading=!1},uploadImport(){this.dialog.upload=!0,this.$nextTick((()=>{this.$refs.uploadDialog.open()}))},uploadSuccess(){},add(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open()}))},table_edit(e){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(e)}))},table_del(e){this.$confirm("是否删除当前店铺，删除后相关未归档的问卷、终端打分也会删除；","删除提示",{type:"warning"}).then((async()=>{let a=await this.$API.business.DeleteShop.delete(e.id);200==a.code?(this.getDataList(),this.$message.success("删除成功")):this.$alert(a.message,"提示",{type:"error"})})).catch((()=>{}))},async disableShop(e,a){this.$confirm(`确定${e?"启用":"禁用"}${a.name}吗？`,"提示",{type:"warning"}).then((async()=>{const l=this.$loading();let t=await this.$API.business.DisableShop.put(a.id,{status:e?1:0});200===t.code?(this.$message.success("操作成功"),this.getDataList()):this.$message.error(t.message),l.close()})).catch((()=>{this.$message.info("用户取消禁用"),a.status=0===a.status?1:0}))},selectionChange(e){this.selection=e},upsearch(e){e&&(this.queryInfo.paramData={accountManagerName:"",businessAddress:"",businessType:"",customerName:"",customerPhone:"",deliveryRoute:"",gear:"",marketType:"",marketingDepartmentName:"",name:"",organizationName:"",retailLicenseNumber:""}),this.queryInfo.current=1,this.$refs.table.currentPage=1,this.getDataList()},filterTree(e){var a=null;function l(t){t.forEach((t=>{t.id==e&&(a=t),t.children&&l(t.children)}))}return l(this.$refs.table.tableData),a},handleSaveSuccess(e,a){("add"==a||"edit"==a||"import"==a)&&this.getDataList()}}},Y=l(83744);const F=(0,Y.Z)(H,[["render",A],["__scopeId","data-v-4b4cdc07"]]);var K=F}}]);