"use strict";(self["webpackChunkscui"]=self["webpackChunkscui"]||[]).push([[7194,4389],{66059:function(e,a,t){t.r(a),t.d(a,{default:function(){return f}});var l=t(66252),s=t(3577);const i={class:"left-panel"},n={class:"title"},u={class:"right-panel"},d={class:"sheetBox"},r={class:"appraiseSheetName"};function o(e,a,t,o,m,c){const b=(0,l.up)("el-icon-list"),p=(0,l.up)("el-icon"),w=(0,l.up)("el-button"),f=(0,l.up)("el-header"),h=(0,l.up)("el-form-item"),g=(0,l.up)("el-col"),k=(0,l.up)("el-row"),_=(0,l.up)("el-table-column"),W=(0,l.up)("el-button-group"),v=(0,l.up)("scTable"),x=(0,l.up)("el-main"),S=(0,l.up)("el-container"),z=(0,l.up)("save-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{class:"info"},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(p,{size:20,color:"var(--el-color-primary)"},{default:(0,l.w5)((()=>[(0,l.Wm)(b)])),_:1}),(0,l._)("div",n,(0,s.zw)(m.detail.business.businessShopName),1)]),(0,l._)("div",u,[(0,l.Wm)(w,{size:"default",onClick:c.back},{default:(0,l.w5)((()=>[(0,l.Uk)("返回")])),_:1},8,["onClick"]),(0,l.Wm)(w,{type:"primary",size:"default",onClick:c.editData},{default:(0,l.w5)((()=>[(0,l.Uk)("基础照片")])),_:1},8,["onClick"])])])),_:1}),(0,l.Wm)(x,{style:{background:"#fff"}},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{class:"infoHead"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{xs:12,sm:12,md:4,lg:4,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户经理:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.marketingDepartmentName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:12,sm:12,md:4,lg:4,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"区营销部:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.marketingDepartmentName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:12,sm:12,md:16,lg:16,xl:16},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"区市场部:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.organizationName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:12,sm:12,md:4,lg:4,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户名称:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.customerName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:12,sm:12,md:4,lg:4,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"零售许可证号:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.retailLicenseNumber||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:12,sm:12,md:16,lg:16,xl:16},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"客户电话:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.customerPhone||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:24,sm:24,md:4,lg:4,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"市场类型:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(c.filterType(m.detail.business.marketType,m.marketList)),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:24,sm:24,md:4,lg:4,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"业态:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(c.filterType(m.detail.business.businessType,m.businessList)),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:12,sm:12,md:16,lg:16,xl:16},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"线路:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.deliveryRoute||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:24,sm:24,md:4,lg:4,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"档位:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.gear||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:24,sm:24,md:20,lg:20,xl:20},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"店面经营地址:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.businessAddress||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:24,sm:24,md:4,lg:4,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"调查人:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.surveyUserName||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{xs:24,sm:24,md:20,lg:20,xl:20},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"调查时间:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.completionTime||"-"),1)])),_:1})])),_:1}),(0,l.Wm)(g,{span:24},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"备注:"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(m.detail.business.remark||"-"),1)])),_:1})])),_:1})])),_:1}),(0,l._)("div",d,[(0,l._)("div",r,(0,s.zw)(m.detail.result.appraiseSheetName||"-"),1),(0,l.Wm)(v,{ref:"table",data:m.detail.topicListList,"span-method":c.objectSpanMethod,"table-layout":"auto",border:"",hiddenMin:"","highlight-current-row":!1,"row-key":"id",hideRefresh:"",hidePagination:"",hideDo:"","cell-style":{background:"revert"}},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"检查项目",prop:"className","min-width":"150",align:"center"}),(0,l.Wm)(_,{label:"基本分",prop:"classBaseScore","min-width":"150",align:"center"}),(0,l.Wm)(_,{label:"检查要点",prop:"name","min-width":"500",align:"center"}),(0,l.Wm)(_,{label:"分值",prop:"score","min-width":"100",align:"center"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,s.zw)(1===e.row.combineStatus?e.row.combineScore:e.row.score),1)])),_:1}),(0,l.Wm)(_,{label:"得分",prop:"hitScore","min-width":"150",align:"center"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,s.zw)(1===e.row.combineStatus?e.row.combineHitScore:e.row.hitScore),1)])),_:1}),(0,l.Wm)(_,{label:"操作","min-width":"100",fixed:"right",align:"center"},{default:(0,l.w5)((e=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Wm)(w,{text:"",type:"primary",size:"small",onClick:a=>c.getData(e.row)},{default:(0,l.w5)((()=>[(0,l.Uk)("查看")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","span-method"])])])),_:1})])),_:1}),m.dialog.save?((0,l.wg)(),(0,l.j4)(z,{key:0,ref:"saveDialog",onSuccess:c.handleSaveSuccess,onClosed:a[0]||(a[0]=e=>m.dialog.save=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}t(57658);var m=t(2828),c=t(80907),b={name:"plan-detail",components:{saveDialog:m["default"]},data(){return{id:this.$route.query.id,input:"",dialog:{save:!1},detail:{business:{},images:[],result:{},topicClass:[],topicListList:[]},marketList:[{value:1,label:"城市"},{value:2,label:"乡村"},{value:3,label:"乡镇"}],businessList:[{value:1,label:"便利店"},{value:2,label:"超市"},{value:3,label:"商场"},{value:4,label:"烟酒店"},{value:5,label:"食杂店"},{value:6,label:"娱乐服务"},{value:7,label:"其他"}],spanArr:[]}},created(){},mounted(){this.getDetail(this.$route.query.id)},methods:{getSpanArr(e){for(var a=0;a<e.length;a++)0===a?(this.spanArr.push(1),this.pos=0):e[a].classNo===e[a-1].classNo?(this.spanArr[this.pos]+=1,this.spanArr.push(0)):(this.spanArr.push(1),this.pos=a)},objectSpanMethod({rowIndex:e,columnIndex:a}){if(0===a||1===a){const a=this.spanArr[e],t=a>0?1:0;return{rowspan:a,colspan:t}}if([3,4,5].includes(a)){const a=this.detail.topicListList[e-1],t=this.detail.topicListList[e],l=this.detail.topicListList[e+1];if(!l||t.classNo!==l.classNo)return[1,1];if(1===t.combineStatus&&t.combineNo===a.combineNo)return[0,1];if(1===t.combineStatus&&t.combineNo===l.combineNo)return[2,1]}},getData(e){let a=[];const{combineStatus:t,combineNo:l}=e;switch(t){case 1:a=this.detail.topicListList.filter((e=>e.combineNo===l));break;case 2:a.push(e);break}this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open().setData(a)}))},filterType(e,a=[]){return a.find((a=>a.value===e))?.label||"-"},async getDetail(e){let a=await this.$API.researchInfo.GetPlanSheetDetail.get(e);200===a.code?(this.detail=a.data||{},this.getSpanArr(a.data.topicListList)):c.Z.closeNext((()=>{this.$router.back()}))},back(){c.Z.closeNext((()=>{this.$router.back()}))},editData(){this.dialog.save=!0,this.$nextTick((()=>{this.$refs.saveDialog.open("edit").setData(this.detail)}))},handleClick(e){switch(e.props.name){case"1":this.$refs.RecycleDetail.initData();break;case"2":this.$refs.PlanUserList.initData();break;case"3":this.$refs.StoreList.initData();break}},handleSaveSuccess(e,a){"edit"==a&&this.getDetail(e.id)}}},p=t(83744);const w=(0,p.Z)(b,[["render",o],["__scopeId","data-v-55785395"]]);var f=w}}]);